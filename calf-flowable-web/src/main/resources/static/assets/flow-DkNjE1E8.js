import{r as ni,s as Op,a as kp,o as wh,g as qe,b as Wr,j as Sh,w as wt,e as gt,f as Ch,d as ii,t as wp,k as _h,u as Sp,h as Cp,c as _p,F as Ap}from"./index-B-OkF-Vi.js";import{_ as Ah,E as Ph,D as Pp,F as Ep,G as Tp}from"./_plugin-vue_export-helper--f4TL7q-.js";import{r as Rp,h as Mp,d as Eh,q as $p,E as Dp,M as Bp}from"./el-card-C16-ePu9.js";import{a as Lp}from"./_commonjsHelpers-C4iS2aBk.js";import{a as Ip,E as Fp}from"./el-form-item-DkIAkhZe.js";import{E as Np}from"./el-input-kTMZ2gCf.js";var Zs,B,Th,zt,ql,Rh,jr,Mh,fi={},$h=[],qp=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Js=Array.isArray;function Pt(i,e){for(var t in e)i[t]=e[t];return i}function Dh(i){var e=i.parentNode;e&&e.removeChild(i)}function di(i,e,t){var n,s,r,o={};for(r in e)r=="key"?n=e[r]:r=="ref"?s=e[r]:o[r]=e[r];if(arguments.length>2&&(o.children=arguments.length>3?Zs.call(arguments,2):t),typeof i=="function"&&i.defaultProps!=null)for(r in i.defaultProps)o[r]===void 0&&(o[r]=i.defaultProps[r]);return fs(i,o,n,s,null)}function fs(i,e,t,n,s){var r={type:i,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:s??++Th,__i:-1,__u:0};return s==null&&B.vnode!=null&&B.vnode(r),r}function Kt(i){return i.children}function bt(i,e){this.props=i,this.context=e}function kn(i,e){if(e==null)return i.__?kn(i.__,i.__i+1):null;for(var t;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null)return t.__e;return typeof i.type=="function"?kn(i):null}function Bh(i){var e,t;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,e=0;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null){i.__e=i.__c.base=t.__e;break}return Bh(i)}}function Yr(i){(!i.__d&&(i.__d=!0)&&zt.push(i)&&!Cs.__r++||ql!==B.debounceRendering)&&((ql=B.debounceRendering)||Rh)(Cs)}function Cs(){var i,e,t,n,s,r,o,l,a;for(zt.sort(jr);i=zt.shift();)i.__d&&(e=zt.length,n=void 0,r=(s=(t=i).__v).__e,l=[],a=[],(o=t.__P)&&((n=Pt({},s)).__v=s.__v+1,B.vnode&&B.vnode(n),jo(o,n,s,t.__n,o.ownerSVGElement!==void 0,32&s.__u?[r]:null,l,r??kn(s),!!(32&s.__u),a),n.__.__k[n.__i]=n,Fh(l,n,a),n.__e!=r&&Bh(n)),zt.length>e&&zt.sort(jr));Cs.__r=0}function Lh(i,e,t,n,s,r,o,l,a,c,h){var u,f,d,p,m,b=n&&n.__k||$h,y=e.length;for(t.__d=a,Qp(t,e,b),a=t.__d,u=0;u<y;u++)(d=t.__k[u])!=null&&typeof d!="boolean"&&typeof d!="function"&&(f=d.__i===-1?fi:b[d.__i]||fi,d.__i=u,jo(i,d,f,s,r,o,l,a,c,h),p=d.__e,d.ref&&f.ref!=d.ref&&(f.ref&&Yo(f.ref,null,d),h.push(d.ref,d.__c||p,d)),m==null&&p!=null&&(m=p),65536&d.__u||f.__k===d.__k?a=Ih(d,a,i):typeof d.type=="function"&&d.__d!==void 0?a=d.__d:p&&(a=p.nextSibling),d.__d=void 0,d.__u&=-196609);t.__d=a,t.__e=m}function Qp(i,e,t){var n,s,r,o,l,a=e.length,c=t.length,h=c,u=0;for(i.__k=[],n=0;n<a;n++)(s=i.__k[n]=(s=e[n])==null||typeof s=="boolean"||typeof s=="function"?null:typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?fs(null,s,null,null,s):Js(s)?fs(Kt,{children:s},null,null,null):s.constructor===void 0&&s.__b>0?fs(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s)!=null?(s.__=i,s.__b=i.__b+1,l=Hp(s,t,o=n+u,h),s.__i=l,r=null,l!==-1&&(h--,(r=t[l])&&(r.__u|=131072)),r==null||r.__v===null?(l==-1&&u--,typeof s.type!="function"&&(s.__u|=65536)):l!==o&&(l===o+1?u++:l>o?h>a-o?u+=l-o:u--:u=l<o&&l==o-1?l-o:0,l!==n+u&&(s.__u|=65536))):(r=t[n])&&r.key==null&&r.__e&&(r.__e==i.__d&&(i.__d=kn(r)),Ur(r,r,!1),t[n]=null,h--);if(h)for(n=0;n<c;n++)(r=t[n])!=null&&!(131072&r.__u)&&(r.__e==i.__d&&(i.__d=kn(r)),Ur(r,r))}function Ih(i,e,t){var n,s;if(typeof i.type=="function"){for(n=i.__k,s=0;n&&s<n.length;s++)n[s]&&(n[s].__=i,e=Ih(n[s],e,t));return e}return i.__e!=e&&(t.insertBefore(i.__e,e||null),e=i.__e),e&&e.nextSibling}function _s(i,e){return e=e||[],i==null||typeof i=="boolean"||(Js(i)?i.some(function(t){_s(t,e)}):e.push(i)),e}function Hp(i,e,t,n){var s=i.key,r=i.type,o=t-1,l=t+1,a=e[t];if(a===null||a&&s==a.key&&r===a.type)return t;if(n>(a!=null&&!(131072&a.__u)?1:0))for(;o>=0||l<e.length;){if(o>=0){if((a=e[o])&&!(131072&a.__u)&&s==a.key&&r===a.type)return o;o--}if(l<e.length){if((a=e[l])&&!(131072&a.__u)&&s==a.key&&r===a.type)return l;l++}}return-1}function Ql(i,e,t){e[0]==="-"?i.setProperty(e,t??""):i[e]=t==null?"":typeof t!="number"||qp.test(e)?t:t+"px"}function Ni(i,e,t,n,s){var r;e:if(e==="style")if(typeof t=="string")i.style.cssText=t;else{if(typeof n=="string"&&(i.style.cssText=n=""),n)for(e in n)t&&e in t||Ql(i.style,e,"");if(t)for(e in t)n&&t[e]===n[e]||Ql(i.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")r=e!==(e=e.replace(/(PointerCapture)$|Capture$/,"$1")),e=e.toLowerCase()in i?e.toLowerCase().slice(2):e.slice(2),i.l||(i.l={}),i.l[e+r]=t,t?n?t.u=n.u:(t.u=Date.now(),i.addEventListener(e,r?Vl:Hl,r)):i.removeEventListener(e,r?Vl:Hl,r);else{if(s)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="width"&&e!=="height"&&e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e!=="rowSpan"&&e!=="colSpan"&&e!=="role"&&e in i)try{i[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!=="-"?i.removeAttribute(e):i.setAttribute(e,t))}}function Hl(i){var e=this.l[i.type+!1];if(i.t){if(i.t<=e.u)return}else i.t=Date.now();return e(B.event?B.event(i):i)}function Vl(i){return this.l[i.type+!0](B.event?B.event(i):i)}function jo(i,e,t,n,s,r,o,l,a,c){var h,u,f,d,p,m,b,y,v,x,w,k,_,E,F,I=e.type;if(e.constructor!==void 0)return null;128&t.__u&&(a=!!(32&t.__u),r=[l=e.__e=t.__e]),(h=B.__b)&&h(e);e:if(typeof I=="function")try{if(y=e.props,v=(h=I.contextType)&&n[h.__c],x=h?v?v.props.value:h.__:n,t.__c?b=(u=e.__c=t.__c).__=u.__E:("prototype"in I&&I.prototype.render?e.__c=u=new I(y,x):(e.__c=u=new bt(y,x),u.constructor=I,u.render=zp),v&&v.sub(u),u.props=y,u.state||(u.state={}),u.context=x,u.__n=n,f=u.__d=!0,u.__h=[],u._sb=[]),u.__s==null&&(u.__s=u.state),I.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Pt({},u.__s)),Pt(u.__s,I.getDerivedStateFromProps(y,u.__s))),d=u.props,p=u.state,u.__v=e,f)I.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(I.getDerivedStateFromProps==null&&y!==d&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(y,x),!u.__e&&(u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(y,u.__s,x)===!1||e.__v===t.__v)){for(e.__v!==t.__v&&(u.props=y,u.state=u.__s,u.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(U){U&&(U.__=e)}),w=0;w<u._sb.length;w++)u.__h.push(u._sb[w]);u._sb=[],u.__h.length&&o.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(y,u.__s,x),u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(d,p,m)})}if(u.context=x,u.props=y,u.__P=i,u.__e=!1,k=B.__r,_=0,"prototype"in I&&I.prototype.render){for(u.state=u.__s,u.__d=!1,k&&k(e),h=u.render(u.props,u.state,u.context),E=0;E<u._sb.length;E++)u.__h.push(u._sb[E]);u._sb=[]}else do u.__d=!1,k&&k(e),h=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++_<25);u.state=u.__s,u.getChildContext!=null&&(n=Pt(Pt({},n),u.getChildContext())),f||u.getSnapshotBeforeUpdate==null||(m=u.getSnapshotBeforeUpdate(d,p)),Lh(i,Js(F=h!=null&&h.type===Kt&&h.key==null?h.props.children:h)?F:[F],e,t,n,s,r,o,l,a,c),u.base=e.__e,e.__u&=-161,u.__h.length&&o.push(u),b&&(u.__E=u.__=null)}catch(U){e.__v=null,a||r!=null?(e.__e=l,e.__u|=a?160:32,r[r.indexOf(l)]=null):(e.__e=t.__e,e.__k=t.__k),B.__e(U,e,t)}else r==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=Vp(t.__e,e,t,n,s,r,o,a,c);(h=B.diffed)&&h(e)}function Fh(i,e,t){e.__d=void 0;for(var n=0;n<t.length;n++)Yo(t[n],t[++n],t[++n]);B.__c&&B.__c(e,i),i.some(function(s){try{i=s.__h,s.__h=[],i.some(function(r){r.call(s)})}catch(r){B.__e(r,s.__v)}})}function Vp(i,e,t,n,s,r,o,l,a){var c,h,u,f,d,p,m,b=t.props,y=e.props,v=e.type;if(v==="svg"&&(s=!0),r!=null){for(c=0;c<r.length;c++)if((d=r[c])&&"setAttribute"in d==!!v&&(v?d.localName===v:d.nodeType===3)){i=d,r[c]=null;break}}if(i==null){if(v===null)return document.createTextNode(y);i=s?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,y.is&&y),r=null,l=!1}if(v===null)b===y||l&&i.data===y||(i.data=y);else{if(r=r&&Zs.call(i.childNodes),b=t.props||fi,!l&&r!=null)for(b={},c=0;c<i.attributes.length;c++)b[(d=i.attributes[c]).name]=d.value;for(c in b)d=b[c],c=="children"||(c=="dangerouslySetInnerHTML"?u=d:c==="key"||c in y||Ni(i,c,null,d,s));for(c in y)d=y[c],c=="children"?f=d:c=="dangerouslySetInnerHTML"?h=d:c=="value"?p=d:c=="checked"?m=d:c==="key"||l&&typeof d!="function"||b[c]===d||Ni(i,c,d,b[c],s);if(h)l||u&&(h.__html===u.__html||h.__html===i.innerHTML)||(i.innerHTML=h.__html),e.__k=[];else if(u&&(i.innerHTML=""),Lh(i,Js(f)?f:[f],e,t,n,s&&v!=="foreignObject",r,o,r?r[0]:t.__k&&kn(t,0),l,a),r!=null)for(c=r.length;c--;)r[c]!=null&&Dh(r[c]);l||(c="value",p!==void 0&&(p!==i[c]||v==="progress"&&!p||v==="option"&&p!==b[c])&&Ni(i,c,p,b[c],!1),c="checked",m!==void 0&&m!==i[c]&&Ni(i,c,m,b[c],!1))}return i}function Yo(i,e,t){try{typeof i=="function"?i(e):i.current=e}catch(n){B.__e(n,t)}}function Ur(i,e,t){var n,s;if(B.unmount&&B.unmount(i),(n=i.ref)&&(n.current&&n.current!==i.__e||Yo(n,null,e)),(n=i.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(r){B.__e(r,e)}n.base=n.__P=null,i.__c=void 0}if(n=i.__k)for(s=0;s<n.length;s++)n[s]&&Ur(n[s],e,t||typeof i.type!="function");t||i.__e==null||Dh(i.__e),i.__=i.__e=i.__d=void 0}function zp(i,e,t){return this.constructor(i,t)}function zl(i,e,t){var n,s,r,o;B.__&&B.__(i,e),s=(n=typeof t=="function")?null:e.__k,r=[],o=[],jo(e,i=(!n&&t||e).__k=di(Kt,null,[i]),s||fi,fi,e.ownerSVGElement!==void 0,!n&&t?[t]:s?null:e.firstChild?Zs.call(e.childNodes):null,r,!n&&t?t:s?s.__e:e.firstChild,n,o),Fh(r,i,o)}function rn(i,e){var t={__c:e="__cC"+Mh++,__:i,Consumer:function(n,s){return n.children(s)},Provider:function(n){var s,r;return this.getChildContext||(s=[],(r={})[e]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&s.some(function(l){l.__e=!0,Yr(l)})},this.sub=function(o){s.push(o);var l=o.componentWillUnmount;o.componentWillUnmount=function(){s.splice(s.indexOf(o),1),l&&l.call(o)}}),n.children}};return t.Provider.__=t.Consumer.contextType=t}Zs=$h.slice,B={__e:function(i,e,t,n){for(var s,r,o;e=e.__;)if((s=e.__c)&&!s.__)try{if((r=s.constructor)&&r.getDerivedStateFromError!=null&&(s.setState(r.getDerivedStateFromError(i)),o=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(i,n||{}),o=s.__d),o)return s.__E=s}catch(l){i=l}throw i}},Th=0,bt.prototype.setState=function(i,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Pt({},this.state),typeof i=="function"&&(i=i(Pt({},t),this.props)),i&&Pt(t,i),i!=null&&this.__v&&(e&&this._sb.push(e),Yr(this))},bt.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),Yr(this))},bt.prototype.render=Kt,zt=[],Rh=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,jr=function(i,e){return i.__v.__b-e.__v.__b},Cs.__r=0,Mh=0;var wn,re,gr,Xl,pi=0,Nh=[],ds=[],Wl=B.__b,jl=B.__r,Yl=B.diffed,Ul=B.__c,Gl=B.unmount;function er(i,e){B.__h&&B.__h(re,i,pi||e),pi=0;var t=re.__H||(re.__H={__:[],__h:[]});return i>=t.__.length&&t.__.push({__V:ds}),t.__[i]}function ut(i){return pi=1,Xp(Hh,i)}function Xp(i,e,t){var n=er(wn++,2);if(n.t=i,!n.__c&&(n.__=[t?t(e):Hh(void 0,e),function(l){var a=n.__N?n.__N[0]:n.__[0],c=n.t(a,l);a!==c&&(n.__N=[c,n.__[1]],n.__c.setState({}))}],n.__c=re,!re.u)){var s=function(l,a,c){if(!n.__c.__H)return!0;var h=n.__c.__H.__.filter(function(f){return f.__c});if(h.every(function(f){return!f.__N}))return!r||r.call(this,l,a,c);var u=!1;return h.forEach(function(f){if(f.__N){var d=f.__[0];f.__=f.__N,f.__N=void 0,d!==f.__[0]&&(u=!0)}}),!(!u&&n.__c.props===l)&&(!r||r.call(this,l,a,c))};re.u=!0;var r=re.shouldComponentUpdate,o=re.componentWillUpdate;re.componentWillUpdate=function(l,a,c){if(this.__e){var h=r;r=void 0,s(l,a,c),r=h}o&&o.call(this,l,a,c)},re.shouldComponentUpdate=s}return n.__N||n.__}function Re(i,e){var t=er(wn++,3);!B.__s&&Qh(t.__H,e)&&(t.__=i,t.i=e,re.__H.__h.push(t))}function Se(i){return pi=5,Bn(function(){return{current:i}},[])}function Bn(i,e){var t=er(wn++,7);return Qh(t.__H,e)?(t.__V=i(),t.i=e,t.__h=i,t.__V):t.__}function Wp(i,e){return pi=8,Bn(function(){return i},e)}function qh(i){var e=re.context[i.__c],t=er(wn++,9);return t.c=i,e?(t.__==null&&(t.__=!0,e.sub(re)),e.props.value):i.__}function jp(){for(var i;i=Nh.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(ps),i.__H.__h.forEach(Gr),i.__H.__h=[]}catch(e){i.__H.__h=[],B.__e(e,i.__v)}}B.__b=function(i){re=null,Wl&&Wl(i)},B.__r=function(i){jl&&jl(i),wn=0;var e=(re=i.__c).__H;e&&(gr===re?(e.__h=[],re.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=ds,t.__N=t.i=void 0})):(e.__h.forEach(ps),e.__h.forEach(Gr),e.__h=[],wn=0)),gr=re},B.diffed=function(i){Yl&&Yl(i);var e=i.__c;e&&e.__H&&(e.__H.__h.length&&(Nh.push(e)!==1&&Xl===B.requestAnimationFrame||((Xl=B.requestAnimationFrame)||Yp)(jp)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==ds&&(t.__=t.__V),t.i=void 0,t.__V=ds})),gr=re=null},B.__c=function(i,e){e.some(function(t){try{t.__h.forEach(ps),t.__h=t.__h.filter(function(n){return!n.__||Gr(n)})}catch(n){e.some(function(s){s.__h&&(s.__h=[])}),e=[],B.__e(n,t.__v)}}),Ul&&Ul(i,e)},B.unmount=function(i){Gl&&Gl(i);var e,t=i.__c;t&&t.__H&&(t.__H.__.forEach(function(n){try{ps(n)}catch(s){e=s}}),t.__H=void 0,e&&B.__e(e,t.__v))};var Kl=typeof requestAnimationFrame=="function";function Yp(i){var e,t=function(){clearTimeout(n),Kl&&cancelAnimationFrame(e),setTimeout(i)},n=setTimeout(t,100);Kl&&(e=requestAnimationFrame(t))}function ps(i){var e=re,t=i.__c;typeof t=="function"&&(i.__c=void 0,t()),re=e}function Gr(i){var e=re;i.__c=i.__(),re=e}function Qh(i,e){return!i||i.length!==e.length||e.some(function(t,n){return t!==i[n]})}function Hh(i,e){return typeof e=="function"?e(i):e}function Vh(i,e){for(var t in e)i[t]=e[t];return i}function Zl(i,e){for(var t in i)if(t!=="__source"&&!(t in e))return!0;for(var n in e)if(n!=="__source"&&i[n]!==e[n])return!0;return!1}function Jl(i){this.props=i}(Jl.prototype=new bt).isPureReactComponent=!0,Jl.prototype.shouldComponentUpdate=function(i,e){return Zl(this.props,i)||Zl(this.state,e)};var ea=B.__b;B.__b=function(i){i.type&&i.type.__f&&i.ref&&(i.props.ref=i.ref,i.ref=null),ea&&ea(i)};var Up=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function It(i){function e(t){var n=Vh({},t);return delete n.ref,i(n,t.ref||null)}return e.$$typeof=Up,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(i.displayName||i.name)+")",e}var Gp=B.__e;B.__e=function(i,e,t,n){if(i.then){for(var s,r=e;r=r.__;)if((s=r.__c)&&s.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),s.__c(i,e)}Gp(i,e,t,n)};var ta=B.unmount;function zh(i,e,t){return i&&(i.__c&&i.__c.__H&&(i.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),i.__c.__H=null),(i=Vh({},i)).__c!=null&&(i.__c.__P===t&&(i.__c.__P=e),i.__c=null),i.__k=i.__k&&i.__k.map(function(n){return zh(n,e,t)})),i}function Xh(i,e,t){return i&&t&&(i.__v=null,i.__k=i.__k&&i.__k.map(function(n){return Xh(n,e,t)}),i.__c&&i.__c.__P===e&&(i.__e&&t.appendChild(i.__e),i.__c.__e=!0,i.__c.__P=t)),i}function mr(){this.__u=0,this.t=null,this.__b=null}function Wh(i){var e=i.__.__c;return e&&e.__a&&e.__a(i)}function qi(){this.u=null,this.o=null}B.unmount=function(i){var e=i.__c;e&&e.__R&&e.__R(),e&&32&i.__u&&(i.type=null),ta&&ta(i)},(mr.prototype=new bt).__c=function(i,e){var t=e.__c,n=this;n.t==null&&(n.t=[]),n.t.push(t);var s=Wh(n.__v),r=!1,o=function(){r||(r=!0,t.__R=null,s?s(l):l())};t.__R=o;var l=function(){if(!--n.__u){if(n.state.__a){var a=n.state.__a;n.__v.__k[0]=Xh(a,a.__c.__P,a.__c.__O)}var c;for(n.setState({__a:n.__b=null});c=n.t.pop();)c.forceUpdate()}};n.__u++||32&e.__u||n.setState({__a:n.__b=n.__v.__k[0]}),i.then(o,o)},mr.prototype.componentWillUnmount=function(){this.t=[]},mr.prototype.render=function(i,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=zh(this.__b,t,n.__O=n.__P)}this.__b=null}var s=e.__a&&di(Kt,null,i.fallback);return s&&(s.__u&=-33),[di(Kt,null,e.__a?null:i.children),s]};var na=function(i,e,t){if(++t[1]===t[0]&&i.o.delete(e),i.props.revealOrder&&(i.props.revealOrder[0]!=="t"||!i.o.size))for(t=i.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;i.u=t=t[2]}};function Kp(i){return this.getChildContext=function(){return i.context},i.children}function Zp(i){var e=this,t=i.i;e.componentWillUnmount=function(){zl(null,e.l),e.l=null,e.i=null},e.i&&e.i!==t&&e.componentWillUnmount(),e.l||(e.i=t,e.l={nodeType:1,parentNode:t,childNodes:[],appendChild:function(n){this.childNodes.push(n),e.i.appendChild(n)},insertBefore:function(n,s){this.childNodes.push(n),e.i.appendChild(n)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),e.i.removeChild(n)}}),zl(di(Kp,{context:e.context},i.__v),e.l)}function jh(i,e){var t=di(Zp,{__v:i,i:e});return t.containerInfo=e,t}(qi.prototype=new bt).__a=function(i){var e=this,t=Wh(e.__v),n=e.o.get(i);return n[0]++,function(s){var r=function(){e.props.revealOrder?(n.push(s),na(e,i,n)):s()};t?t(r):r()}},qi.prototype.render=function(i){this.u=null,this.o=new Map;var e=_s(i.children);i.revealOrder&&i.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return i.children},qi.prototype.componentDidUpdate=qi.prototype.componentDidMount=function(){var i=this;this.o.forEach(function(e,t){na(i,t,e)})};var Jp=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,eg=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,tg=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,ng=/[A-Z0-9]/g,ig=typeof document<"u",sg=function(i){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(i)};bt.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(i){Object.defineProperty(bt.prototype,i,{configurable:!0,get:function(){return this["UNSAFE_"+i]},set:function(e){Object.defineProperty(this,i,{configurable:!0,writable:!0,value:e})}})});var ia=B.event;function rg(){}function og(){return this.cancelBubble}function lg(){return this.defaultPrevented}B.event=function(i){return ia&&(i=ia(i)),i.persist=rg,i.isPropagationStopped=og,i.isDefaultPrevented=lg,i.nativeEvent=i};var ag={enumerable:!1,configurable:!0,get:function(){return this.class}},sa=B.vnode;B.vnode=function(i){typeof i.type=="string"&&function(e){var t=e.props,n=e.type,s={};for(var r in t){var o=t[r];if(!(r==="value"&&"defaultValue"in t&&o==null||ig&&r==="children"&&n==="noscript"||r==="class"||r==="className")){var l=r.toLowerCase();r==="defaultValue"&&"value"in t&&t.value==null?r="value":r==="download"&&o===!0?o="":l==="ondoubleclick"?r="ondblclick":l!=="onchange"||n!=="input"&&n!=="textarea"||sg(t.type)?l==="onfocus"?r="onfocusin":l==="onblur"?r="onfocusout":tg.test(r)?r=l:n.indexOf("-")===-1&&eg.test(r)?r=r.replace(ng,"-$&").toLowerCase():o===null&&(o=void 0):l=r="oninput",l==="oninput"&&s[r=l]&&(r="oninputCapture"),s[r]=o}}n=="select"&&s.multiple&&Array.isArray(s.value)&&(s.value=_s(t.children).forEach(function(a){a.props.selected=s.value.indexOf(a.props.value)!=-1})),n=="select"&&s.defaultValue!=null&&(s.value=_s(t.children).forEach(function(a){a.props.selected=s.multiple?s.defaultValue.indexOf(a.props.value)!=-1:s.defaultValue==a.props.value})),t.class&&!t.className?(s.class=t.class,Object.defineProperty(s,"className",ag)):(t.className&&!t.class||t.class&&t.className)&&(s.class=s.className=t.className),e.props=s}(i),i.$$typeof=Jp,sa&&sa(i)};var ra=B.__r;B.__r=function(i){ra&&ra(i),i.__c};var oa=B.diffed;B.diffed=function(i){oa&&oa(i);var e=i.props,t=i.__e;t!=null&&i.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value)};var cg=0;function L(i,e,t,n,s,r){var o,l,a={};for(l in e)l=="ref"?o=e[l]:a[l]=e[l];var c={type:i,props:a,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--cg,__i:-1,__u:0,__source:s,__self:r};if(typeof i=="function"&&(o=i.defaultProps))for(l in o)a[l]===void 0&&(a[l]=o[l]);return B.vnode&&B.vnode(c),c}var Yh={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(i){(function(){var e={}.hasOwnProperty;function t(){for(var r="",o=0;o<arguments.length;o++){var l=arguments[o];l&&(r=s(r,n(l)))}return r}function n(r){if(typeof r=="string"||typeof r=="number")return r;if(typeof r!="object")return"";if(Array.isArray(r))return t.apply(null,r);if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]"))return r.toString();var o="";for(var l in r)e.call(r,l)&&r[l]&&(o=s(o,l));return o}function s(r,o){return o?r?r+" "+o:r+o:r}i.exports?(t.default=t,i.exports=t):window.classNames=t})()})(Yh);var hg=Yh.exports;const Ot=Lp(hg),Uh=1024;let ug=0,He=class{constructor(e,t){this.from=e,this.to=t}};class N{constructor(e={}){this.id=ug++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=fe.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}}N.closedBy=new N({deserialize:i=>i.split(" ")});N.openedBy=new N({deserialize:i=>i.split(" ")});N.group=new N({deserialize:i=>i.split(" ")});N.isolate=new N({deserialize:i=>{if(i&&i!="rtl"&&i!="ltr"&&i!="auto")throw new RangeError("Invalid value for isolate: "+i);return i||"auto"}});N.contextHash=new N({perNode:!0});N.lookAhead=new N({perNode:!0});N.mounted=new N({perNode:!0});class gi{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[N.mounted.id]}}const fg=Object.create(null);class fe{constructor(e,t,n,s=0){this.name=e,this.props=t,this.id=n,this.flags=s}static define(e){let t=e.props&&e.props.length?Object.create(null):fg,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),s=new fe(e.name||"",t,e.id,n);if(e.props){for(let r of e.props)if(Array.isArray(r)||(r=r(s)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[r[0].id]=r[1]}}return s}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(N.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let s of n.split(" "))t[s]=e[n];return n=>{for(let s=n.prop(N.group),r=-1;r<(s?s.length:0);r++){let o=t[r<0?n.name:s[r]];if(o)return o}}}}fe.none=new fe("",Object.create(null),0,8);class Ti{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let s=null;for(let r of e){let o=r(n);o&&(s||(s=Object.assign({},n.props)),s[o[0].id]=o[1])}t.push(s?new fe(n.name,s,n.id,n.flags):n)}return new Ti(t)}}const Qi=new WeakMap,la=new WeakMap;var se;(function(i){i[i.ExcludeBuffers=1]="ExcludeBuffers",i[i.IncludeAnonymous=2]="IncludeAnonymous",i[i.IgnoreMounts=4]="IgnoreMounts",i[i.IgnoreOverlays=8]="IgnoreOverlays"})(se||(se={}));class Z{constructor(e,t,n,s,r){if(this.type=e,this.children=t,this.positions=n,this.length=s,this.props=null,r&&r.length){this.props=Object.create(null);for(let[o,l]of r)this.props[typeof o=="number"?o:o.id]=l}}toString(){let e=gi.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let s=n.toString();s&&(t&&(t+=","),t+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new As(this.topNode,e)}cursorAt(e,t=0,n=0){let s=Qi.get(this)||this.topNode,r=new As(s);return r.moveTo(e,t),Qi.set(this,r._tree),r}get topNode(){return new Me(this,0,0,null)}resolve(e,t=0){let n=mi(Qi.get(this)||this.topNode,e,t,!1);return Qi.set(this,n),n}resolveInner(e,t=0){let n=mi(la.get(this)||this.topNode,e,t,!0);return la.set(this,n),n}resolveStack(e,t=0){return gg(this,e,t)}iterate(e){let{enter:t,leave:n,from:s=0,to:r=this.length}=e,o=e.mode||0,l=(o&se.IncludeAnonymous)>0;for(let a=this.cursor(o|se.IncludeAnonymous);;){let c=!1;if(a.from<=r&&a.to>=s&&(!l&&a.type.isAnonymous||t(a)!==!1)){if(a.firstChild())continue;c=!0}for(;c&&n&&(l||!a.type.isAnonymous)&&n(a),!a.nextSibling();){if(!a.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Ko(fe.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,s)=>new Z(this.type,t,n,s,this.propValues),e.makeTree||((t,n,s)=>new Z(fe.none,t,n,s)))}static build(e){return mg(e)}}Z.empty=new Z(fe.none,[],[],0);class Uo{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Uo(this.buffer,this.index)}}class $t{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return fe.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],s=this.set.types[t],r=s.name;if(/\W/.test(r)&&!s.isError&&(r=JSON.stringify(r)),e+=4,n==e)return r;let o=[];for(;e<n;)o.push(this.childString(e)),e=this.buffer[e+3];return r+"("+o.join(",")+")"}findChild(e,t,n,s,r){let{buffer:o}=this,l=-1;for(let a=e;a!=t&&!(Gh(r,s,o[a+1],o[a+2])&&(l=a,n>0));a=o[a+3]);return l}slice(e,t,n){let s=this.buffer,r=new Uint16Array(t-e),o=0;for(let l=e,a=0;l<t;){r[a++]=s[l++],r[a++]=s[l++]-n;let c=r[a++]=s[l++]-n;r[a++]=s[l++]-e,o=Math.max(o,c)}return new $t(r,o,this.set)}}function Gh(i,e,t,n){switch(i){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function mi(i,e,t,n){for(var s;i.from==i.to||(t<1?i.from>=e:i.from>e)||(t>-1?i.to<=e:i.to<e);){let o=!n&&i instanceof Me&&i.index<0?null:i.parent;if(!o)return i;i=o}let r=n?0:se.IgnoreOverlays;if(n)for(let o=i,l=o.parent;l;o=l,l=o.parent)o instanceof Me&&o.index<0&&((s=l.enter(e,t,r))===null||s===void 0?void 0:s.from)!=o.from&&(i=l);for(;;){let o=i.enter(e,t,r);if(!o)return i;i=o}}class Kh{cursor(e=0){return new As(this,e)}getChild(e,t=null,n=null){let s=aa(this,e,t,n);return s.length?s[0]:null}getChildren(e,t=null,n=null){return aa(this,e,t,n)}resolve(e,t=0){return mi(this,e,t,!1)}resolveInner(e,t=0){return mi(this,e,t,!0)}matchContext(e){return Kr(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let s=t.lastChild;if(!s||s.to!=t.to)break;s.type.isError&&s.from==s.to?(n=t,t=s.prevSibling):t=s}return n}get node(){return this}get next(){return this.parent}}class Me extends Kh{constructor(e,t,n,s){super(),this._tree=e,this.from=t,this.index=n,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,s,r=0){for(let o=this;;){for(let{children:l,positions:a}=o._tree,c=t>0?l.length:-1;e!=c;e+=t){let h=l[e],u=a[e]+o.from;if(Gh(s,n,u,u+h.length)){if(h instanceof $t){if(r&se.ExcludeBuffers)continue;let f=h.findChild(0,h.buffer.length,t,n-u,s);if(f>-1)return new Et(new dg(o,h,e,u),null,f)}else if(r&se.IncludeAnonymous||!h.type.isAnonymous||Go(h)){let f;if(!(r&se.IgnoreMounts)&&(f=gi.get(h))&&!f.overlay)return new Me(f.tree,u,e,o);let d=new Me(h,u,e,o);return r&se.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?h.children.length-1:0,t,n,s)}}}if(r&se.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let s;if(!(n&se.IgnoreOverlays)&&(s=gi.get(this._tree))&&s.overlay){let r=e-this.from;for(let{from:o,to:l}of s.overlay)if((t>0?o<=r:o<r)&&(t<0?l>=r:l>r))return new Me(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function aa(i,e,t,n){let s=i.cursor(),r=[];if(!s.firstChild())return r;if(t!=null){for(let o=!1;!o;)if(o=s.type.is(t),!s.nextSibling())return r}for(;;){if(n!=null&&s.type.is(n))return r;if(s.type.is(e)&&r.push(s.node),!s.nextSibling())return n==null?r:[]}}function Kr(i,e,t=e.length-1){for(let n=i;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}class dg{constructor(e,t,n,s){this.parent=e,this.buffer=t,this.index=n,this.start=s}}class Et extends Kh{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:s}=this.context,r=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.context.start,n);return r<0?null:new Et(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&se.ExcludeBuffers)return null;let{buffer:s}=this.context,r=s.findChild(this.index+4,s.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return r<0?null:new Et(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Et(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Et(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,s=this.index+4,r=n.buffer[this.index+3];if(r>s){let o=n.buffer[this.index+1];e.push(n.slice(s,r,o)),t.push(0)}return new Z(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Zh(i){if(!i.length)return null;let e=0,t=i[0];for(let r=1;r<i.length;r++){let o=i[r];(o.from>t.from||o.to<t.to)&&(t=o,e=r)}let n=t instanceof Me&&t.index<0?null:t.parent,s=i.slice();return n?s[e]=n:s.splice(e,1),new pg(s,t)}class pg{constructor(e,t){this.heads=e,this.node=t}get next(){return Zh(this.heads)}}function gg(i,e,t){let n=i.resolveInner(e,t),s=null;for(let r=n instanceof Me?n:n.context.parent;r;r=r.parent)if(r.index<0){let o=r.parent;(s||(s=[n])).push(o.resolve(e,t)),r=o}else{let o=gi.get(r.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let l=new Me(o.tree,o.overlay[0].from+r.from,-1,r);(s||(s=[n])).push(mi(l,e,t,!1))}}return s?Zh(s):n}class As{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Me)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:s}=this.buffer;return this.type=t||s.set.types[s.buffer[e]],this.from=n+s.buffer[e+1],this.to=n+s.buffer[e+2],!0}yield(e){return e?e instanceof Me?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:s}=this.buffer,r=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.buffer.start,n);return r<0?!1:(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&se.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&se.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&se.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let s=n<0?0:this.stack[n]+4;if(this.index!=s)return this.yieldBuf(t.findChild(s,this.index,-1,0,4))}else{let s=t.buffer[this.index+3];if(s<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(s)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let r=0;r<this.index;r++)if(s.buffer.buffer[r+3]<this.index)return!1;({index:t,parent:n}=s)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let r=t+e,o=e<0?-1:n._tree.children.length;r!=o;r+=e){let l=n._tree.children[r];if(this.mode&se.IncludeAnonymous||l instanceof $t||!l.type.isAnonymous||Go(l))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let s=this.index,r=this.stack.length;r>=0;){for(let o=e;o;o=o._parent)if(o.index==s){if(s==this.index)return o;t=o,n=r+1;break e}s=this.stack[--r]}for(let s=n;s<this.stack.length;s++)t=new Et(this.buffer,t,this.stack[s]);return this.bufferNode=new Et(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let s=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(s=!0)}for(;;){if(s&&t&&t(this),s=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,s=!0}}}matchContext(e){if(!this.buffer)return Kr(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let s=e.length-1,r=this.stack.length-1;s>=0;r--){if(r<0)return Kr(this._tree,e,s);let o=n[t.buffer[this.stack[r]]];if(!o.isAnonymous){if(e[s]&&e[s]!=o.name)return!1;s--}}return!0}}function Go(i){return i.children.some(e=>e instanceof $t||!e.type.isAnonymous||Go(e))}function mg(i){var e;let{buffer:t,nodeSet:n,maxBufferLength:s=Uh,reused:r=[],minRepeatType:o=n.types.length}=i,l=Array.isArray(t)?new Uo(t,t.length):t,a=n.types,c=0,h=0;function u(k,_,E,F,I,U){let{id:Q,start:M,end:O,size:S}=l,R=h,z=c;for(;S<0;)if(l.next(),S==-1){let J=r[Q];E.push(J),F.push(M-k);return}else if(S==-3){c=Q;return}else if(S==-4){h=Q;return}else throw new RangeError(`Unrecognized record size: ${S}`);let G=a[Q],ne,H,oe=M-k;if(O-M<=s&&(H=b(l.pos-_,I))){let J=new Uint16Array(H.size-H.skip),ce=l.pos-H.size,xe=J.length;for(;l.pos>ce;)xe=y(H.start,J,xe);ne=new $t(J,O-H.start,n),oe=H.start-k}else{let J=l.pos-S;l.next();let ce=[],xe=[],Oe=Q>=o?Q:-1,Ne=0,qt=O;for(;l.pos>J;)Oe>=0&&l.id==Oe&&l.size>=0?(l.end<=qt-s&&(p(ce,xe,M,Ne,l.end,qt,Oe,R,z),Ne=ce.length,qt=l.end),l.next()):U>2500?f(M,J,ce,xe):u(M,J,ce,xe,Oe,U+1);if(Oe>=0&&Ne>0&&Ne<ce.length&&p(ce,xe,M,Ne,M,qt,Oe,R,z),ce.reverse(),xe.reverse(),Oe>-1&&Ne>0){let ln=d(G,z);ne=Ko(G,ce,xe,0,ce.length,0,O-M,ln,ln)}else ne=m(G,ce,xe,O-M,R-O,z)}E.push(ne),F.push(oe)}function f(k,_,E,F){let I=[],U=0,Q=-1;for(;l.pos>_;){let{id:M,start:O,end:S,size:R}=l;if(R>4)l.next();else{if(Q>-1&&O<Q)break;Q<0&&(Q=S-s),I.push(M,O,S),U++,l.next()}}if(U){let M=new Uint16Array(U*4),O=I[I.length-2];for(let S=I.length-3,R=0;S>=0;S-=3)M[R++]=I[S],M[R++]=I[S+1]-O,M[R++]=I[S+2]-O,M[R++]=R;E.push(new $t(M,I[2]-O,n)),F.push(O-k)}}function d(k,_){return(E,F,I)=>{let U=0,Q=E.length-1,M,O;if(Q>=0&&(M=E[Q])instanceof Z){if(!Q&&M.type==k&&M.length==I)return M;(O=M.prop(N.lookAhead))&&(U=F[Q]+M.length+O)}return m(k,E,F,I,U,_)}}function p(k,_,E,F,I,U,Q,M,O){let S=[],R=[];for(;k.length>F;)S.push(k.pop()),R.push(_.pop()+E-I);k.push(m(n.types[Q],S,R,U-I,M-U,O)),_.push(I-E)}function m(k,_,E,F,I,U,Q){if(U){let M=[N.contextHash,U];Q=Q?[M].concat(Q):[M]}if(I>25){let M=[N.lookAhead,I];Q=Q?[M].concat(Q):[M]}return new Z(k,_,E,F,Q)}function b(k,_){let E=l.fork(),F=0,I=0,U=0,Q=E.end-s,M={size:0,start:0,skip:0};e:for(let O=E.pos-k;E.pos>O;){let S=E.size;if(E.id==_&&S>=0){M.size=F,M.start=I,M.skip=U,U+=4,F+=4,E.next();continue}let R=E.pos-S;if(S<0||R<O||E.start<Q)break;let z=E.id>=o?4:0,G=E.start;for(E.next();E.pos>R;){if(E.size<0)if(E.size==-3)z+=4;else break e;else E.id>=o&&(z+=4);E.next()}I=G,F+=S,U+=z}return(_<0||F==k)&&(M.size=F,M.start=I,M.skip=U),M.size>4?M:void 0}function y(k,_,E){let{id:F,start:I,end:U,size:Q}=l;if(l.next(),Q>=0&&F<o){let M=E;if(Q>4){let O=l.pos-(Q-4);for(;l.pos>O;)E=y(k,_,E)}_[--E]=M,_[--E]=U-k,_[--E]=I-k,_[--E]=F}else Q==-3?c=F:Q==-4&&(h=F);return E}let v=[],x=[];for(;l.pos>0;)u(i.start||0,i.bufferStart||0,v,x,-1,0);let w=(e=i.length)!==null&&e!==void 0?e:v.length?x[0]+v[0].length:0;return new Z(a[i.topID],v.reverse(),x.reverse(),w)}const ca=new WeakMap;function gs(i,e){if(!i.isAnonymous||e instanceof $t||e.type!=i)return 1;let t=ca.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=i||!(n instanceof Z)){t=1;break}t+=gs(i,n)}ca.set(e,t)}return t}function Ko(i,e,t,n,s,r,o,l,a){let c=0;for(let p=n;p<s;p++)c+=gs(i,e[p]);let h=Math.ceil(c*1.5/8),u=[],f=[];function d(p,m,b,y,v){for(let x=b;x<y;){let w=x,k=m[x],_=gs(i,p[x]);for(x++;x<y;x++){let E=gs(i,p[x]);if(_+E>=h)break;_+=E}if(x==w+1){if(_>h){let E=p[w];d(E.children,E.positions,0,E.children.length,m[w]+v);continue}u.push(p[w])}else{let E=m[x-1]+p[x-1].length-k;u.push(Ko(i,p,m,w,x,k,E,null,a))}f.push(k+v-r)}}return d(e,t,n,s,0),(l||a)(u,f,o)}class yt{constructor(e,t,n,s,r=!1,o=!1){this.from=e,this.to=t,this.tree=n,this.offset=s,this.open=(r?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let s=[new yt(0,e.length,e,0,!1,n)];for(let r of t)r.to>e.length&&s.push(r);return s}static applyChanges(e,t,n=128){if(!t.length)return e;let s=[],r=1,o=e.length?e[0]:null;for(let l=0,a=0,c=0;;l++){let h=l<t.length?t[l]:null,u=h?h.fromA:1e9;if(u-a>=n)for(;o&&o.from<u;){let f=o;if(a>=f.from||u<=f.to||c){let d=Math.max(f.from,a)-c,p=Math.min(f.to,u)-c;f=d>=p?null:new yt(d,p,f.tree,f.offset+c,l>0,!!h)}if(f&&s.push(f),o.to>u)break;o=r<e.length?e[r++]:null}if(!h)break;a=h.toA,c=h.toA-h.toB}return s}}class Zo{startParse(e,t,n){return typeof e=="string"&&(e=new bg(e)),n=n?n.length?n.map(s=>new He(s.from,s.to)):[new He(0,0)]:[new He(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let s=this.startParse(e,t,n);for(;;){let r=s.advance();if(r)return r}}}class bg{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}function yg(i){return(e,t,n,s)=>new xg(e,i,t,n,s)}class ha{constructor(e,t,n,s,r){this.parser=e,this.parse=t,this.overlay=n,this.target=s,this.from=r}}function ua(i){if(!i.length||i.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(i))}class vg{constructor(e,t,n,s,r,o,l){this.parser=e,this.predicate=t,this.mounts=n,this.index=s,this.start=r,this.target=o,this.prev=l,this.depth=0,this.ranges=[]}}const Zr=new N({perNode:!0});class xg{constructor(e,t,n,s,r){this.nest=t,this.input=n,this.fragments=s,this.ranges=r,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let n=this.baseParse.advance();if(!n)return null;if(this.baseParse=null,this.baseTree=n,this.startInner(),this.stoppedAt!=null)for(let s of this.inner)s.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let n=this.baseTree;return this.stoppedAt!=null&&(n=new Z(n.type,n.children,n.positions,n.length,n.propValues.concat([[Zr,this.stoppedAt]]))),n}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let n=Object.assign(Object.create(null),e.target.props);n[N.mounted.id]=new gi(t,e.overlay,e.parser),e.target.props=n}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new wg(this.fragments),t=null,n=null,s=new As(new Me(this.baseTree,this.ranges[0].from,0,null),se.IncludeAnonymous|se.IgnoreMounts);e:for(let r,o;;){let l=!0,a;if(this.stoppedAt!=null&&s.from>=this.stoppedAt)l=!1;else if(e.hasNode(s)){if(t){let c=t.mounts.find(h=>h.frag.from<=s.from&&h.frag.to>=s.to&&h.mount.overlay);if(c)for(let h of c.mount.overlay){let u=h.from+c.pos,f=h.to+c.pos;u>=s.from&&f<=s.to&&!t.ranges.some(d=>d.from<f&&d.to>u)&&t.ranges.push({from:u,to:f})}}l=!1}else if(n&&(o=Og(n.ranges,s.from,s.to)))l=o!=2;else if(!s.type.isAnonymous&&(r=this.nest(s,this.input))&&(s.from<s.to||!r.overlay)){s.tree||kg(s);let c=e.findMounts(s.from,r.parser);if(typeof r.overlay=="function")t=new vg(r.parser,r.overlay,c,this.inner.length,s.from,s.tree,t);else{let h=pa(this.ranges,r.overlay||(s.from<s.to?[new He(s.from,s.to)]:[]));h.length&&ua(h),(h.length||!r.overlay)&&this.inner.push(new ha(r.parser,h.length?r.parser.startParse(this.input,ga(c,h),h):r.parser.startParse(""),r.overlay?r.overlay.map(u=>new He(u.from-s.from,u.to-s.from)):null,s.tree,h.length?h[0].from:s.from)),r.overlay?h.length&&(n={ranges:h,depth:0,prev:n}):l=!1}}else if(t&&(a=t.predicate(s))&&(a===!0&&(a=new He(s.from,s.to)),a.from<a.to)){let c=t.ranges.length-1;c>=0&&t.ranges[c].to==a.from?t.ranges[c]={from:t.ranges[c].from,to:a.to}:t.ranges.push(a)}if(l&&s.firstChild())t&&t.depth++,n&&n.depth++;else for(;!s.nextSibling();){if(!s.parent())break e;if(t&&!--t.depth){let c=pa(this.ranges,t.ranges);c.length&&(ua(c),this.inner.splice(t.index,0,new ha(t.parser,t.parser.startParse(this.input,ga(t.mounts,c),c),t.ranges.map(h=>new He(h.from-t.start,h.to-t.start)),t.target,c[0].from))),t=t.prev}n&&!--n.depth&&(n=n.prev)}}}}function Og(i,e,t){for(let n of i){if(n.from>=t)break;if(n.to>e)return n.from<=e&&n.to>=t?2:1}return 0}function fa(i,e,t,n,s,r){if(e<t){let o=i.buffer[e+1];n.push(i.slice(e,t,o)),s.push(o-r)}}function kg(i){let{node:e}=i,t=[],n=e.context.buffer;do t.push(i.index),i.parent();while(!i.tree);let s=i.tree,r=s.children.indexOf(n),o=s.children[r],l=o.buffer,a=[r];function c(h,u,f,d,p,m){let b=t[m],y=[],v=[];fa(o,h,b,y,v,d);let x=l[b+1],w=l[b+2];a.push(y.length);let k=m?c(b+4,l[b+3],o.set.types[l[b]],x,w-x,m-1):e.toTree();return y.push(k),v.push(x-d),fa(o,l[b+3],u,y,v,d),new Z(f,y,v,p)}s.children[r]=c(0,l.length,fe.none,0,o.length,t.length-1);for(let h of a){let u=i.tree.children[h],f=i.tree.positions[h];i.yield(new Me(u,f+i.from,h,i._tree))}}class da{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(se.IncludeAnonymous|se.IgnoreMounts)}moveTo(e){let{cursor:t}=this,n=e-this.offset;for(;!this.done&&t.from<n;)t.to>=e&&t.enter(n,1,se.IgnoreOverlays|se.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(t.children.length&&t.positions[0]==0&&t.children[0]instanceof Z)t=t.children[0];else break}return!1}}let wg=class{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let n=this.curFrag=e[0];this.curTo=(t=n.tree.prop(Zr))!==null&&t!==void 0?t:n.to,this.inner=new da(n.tree,-n.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=(e=t.tree.prop(Zr))!==null&&e!==void 0?e:t.to,this.inner=new da(t.tree,-t.offset)}}findMounts(e,t){var n;let s=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let r=this.inner.cursor.node;r;r=r.parent){let o=(n=r.tree)===null||n===void 0?void 0:n.prop(N.mounted);if(o&&o.parser==t)for(let l=this.fragI;l<this.fragments.length;l++){let a=this.fragments[l];if(a.from>=r.to)break;a.tree==this.curFrag.tree&&s.push({frag:a,pos:r.from-a.offset,mount:o})}}}return s}};function pa(i,e){let t=null,n=e;for(let s=1,r=0;s<i.length;s++){let o=i[s-1].to,l=i[s].from;for(;r<n.length;r++){let a=n[r];if(a.from>=l)break;a.to<=o||(t||(n=t=e.slice()),a.from<o?(t[r]=new He(a.from,o),a.to>l&&t.splice(r+1,0,new He(l,a.to))):a.to>l?t[r--]=new He(l,a.to):t.splice(r--,1))}}return n}function Sg(i,e,t,n){let s=0,r=0,o=!1,l=!1,a=-1e9,c=[];for(;;){let h=s==i.length?1e9:o?i[s].to:i[s].from,u=r==e.length?1e9:l?e[r].to:e[r].from;if(o!=l){let f=Math.max(a,t),d=Math.min(h,u,n);f<d&&c.push(new He(f,d))}if(a=Math.min(h,u),a==1e9)break;h==a&&(o?(o=!1,s++):o=!0),u==a&&(l?(l=!1,r++):l=!0)}return c}function ga(i,e){let t=[];for(let{pos:n,mount:s,frag:r}of i){let o=n+(s.overlay?s.overlay[0].from:0),l=o+s.tree.length,a=Math.max(r.from,o),c=Math.min(r.to,l);if(s.overlay){let h=s.overlay.map(f=>new He(f.from+n,f.to+n)),u=Sg(e,h,a,c);for(let f=0,d=a;;f++){let p=f==u.length,m=p?c:u[f].from;if(m>d&&t.push(new yt(d,m,s.tree,-o,r.from>=d||r.openStart,r.to<=m||r.openEnd)),p)break;d=u[f].to}}else t.push(new yt(a,c,s.tree,-o,r.from>=o||r.openStart,r.to<=l||r.openEnd))}return t}var ma={};class Ps{constructor(e,t,n,s,r,o,l,a,c,h=0,u){this.p=e,this.stack=t,this.state=n,this.reducePos=s,this.pos=r,this.score=o,this.buffer=l,this.bufferBase=a,this.curContext=c,this.lookAhead=h,this.parent=u}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,n=0){let s=e.parser.context;return new Ps(e,[],t,n,n,0,[],0,s?new ba(s,s.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,s=e&65535,{parser:r}=this.p,o=this.reducePos<this.pos-25;o&&this.setLookAhead(this.pos);let l=r.dynamicPrecedence(s);if(l&&(this.score+=l),n==0){this.pushState(r.getGoto(this.state,s,!0),this.reducePos),s<r.minRepeatTerm&&this.storeNode(s,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(s,this.reducePos);return}let a=this.stack.length-(n-1)*3-(e&262144?6:0),c=a?this.stack[a-2]:this.p.ranges[0].from,h=this.reducePos-c;h>=2e3&&!(!((t=this.p.parser.nodeSet.types[s])===null||t===void 0)&&t.isAnonymous)&&(c==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=h):this.p.lastBigReductionSize<h&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=c,this.p.lastBigReductionSize=h));let u=a?this.stack[a-1]:0,f=this.bufferBase+this.buffer.length-u;if(s<r.minRepeatTerm||e&131072){let d=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(s,c,d,f+4,!0)}if(e&262144)this.state=this.stack[a];else{let d=this.stack[a-3];this.state=r.getGoto(d,s,!0)}for(;this.stack.length>a;)this.stack.pop();this.reduceContext(s,c)}storeNode(e,t,n,s=4,r=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,l=this.buffer.length;if(l==0&&o.parent&&(l=o.bufferBase-o.parent.bufferBase,o=o.parent),l>0&&o.buffer[l-4]==0&&o.buffer[l-1]>-1){if(t==n)return;if(o.buffer[l-2]>=t){o.buffer[l-2]=n;return}}}if(!r||this.pos==n)this.buffer.push(e,t,n,s);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0){let l=!1;for(let a=o;a>0&&this.buffer[a-2]>n;a-=4)if(this.buffer[a-1]>=0){l=!0;break}if(l)for(;o>0&&this.buffer[o-2]>n;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,s>4&&(s-=4)}this.buffer[o]=e,this.buffer[o+1]=t,this.buffer[o+2]=n,this.buffer[o+3]=s}}shift(e,t,n,s){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=s,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,s,4);else{let r=e,{parser:o}=this.p;(s>this.pos||t<=o.maxNode)&&(this.pos=s,o.stateFlag(r,1)||(this.reducePos=s)),this.pushState(r,n),this.shiftContext(t,n),t<=o.maxNode&&this.buffer.push(t,n,s,4)}}apply(e,t,n,s){e&65536?this.reduce(e):this.shift(e,t,n,s)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let s=this.pos;this.reducePos=this.pos=s+e.length,this.pushState(t,s),this.buffer.push(n,s,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),s=e.bufferBase+t;for(;e&&s==e.bufferBase;)e=e.parent;return new Ps(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,s,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new Cg(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(n==0)return!1;if(!(n&65536))return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let s=[];for(let r=0,o;r<t.length;r+=2)(o=t[r+1])!=this.state&&this.p.parser.hasAction(o,e)&&s.push(t[r],o);if(this.stack.length<120)for(let r=0;s.length<8&&r<t.length;r+=2){let o=t[r+1];s.some((l,a)=>a&1&&l==o)||s.push(t[r],o)}t=s}let n=[];for(let s=0;s<t.length&&n.length<4;s+=2){let r=t[s+1];if(r==this.state)continue;let o=this.split();o.pushState(r,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(t[s],this.pos),o.reducePos=this.pos,o.score-=200,n.push(o)}return n}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(!(t&65536))return!1;if(!e.validAction(this.state,t)){let n=t>>19,s=t&65535,r=this.stack.length-n*3;if(r<0||e.getGoto(this.stack[r],s,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;t=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],n=(s,r)=>{if(!t.includes(s))return t.push(s),e.allActions(s,o=>{if(!(o&393216))if(o&65536){let l=(o>>19)-r;if(l>1){let a=o&65535,c=this.stack.length-l*3;if(c>=0&&e.getGoto(this.stack[c],a,!1)>=0)return l<<19|65536|a}}else{let l=n(o,r+1);if(l!=null)return l}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new ba(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class ba{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class Cg{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,n=e>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let s=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=s}}class Es{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Es(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Es(this.stack,this.pos,this.index)}}function Hi(i,e=Uint16Array){if(typeof i!="string")return i;let t=null;for(let n=0,s=0;n<i.length;){let r=0;for(;;){let o=i.charCodeAt(n++),l=!1;if(o==126){r=65535;break}o>=92&&o--,o>=34&&o--;let a=o-32;if(a>=46&&(a-=46,l=!0),r+=a,l)break;r*=46}t?t[s++]=r:t=new e(r)}return t}class ms{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const ya=new ms;class _g{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=ya,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,s=this.rangeIndex,r=this.pos+e;for(;r<n.from;){if(!s)return null;let o=this.ranges[--s];r-=n.from-o.to,n=o}for(;t<0?r>n.to:r>=n.to;){if(s==this.ranges.length-1)return null;let o=this.ranges[++s];r+=o.from-n.to,n=o}return r}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,n,s;if(t>=0&&t<this.chunk.length)n=this.pos+e,s=this.chunk.charCodeAt(t);else{let r=this.resolveOffset(e,1);if(r==null)return-1;if(n=r,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)s=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let o=this.rangeIndex,l=this.range;for(;l.to<=n;)l=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>l.to&&(this.chunk2=this.chunk2.slice(0,l.to-n)),s=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),s}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=ya,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let s of this.ranges){if(s.from>=t)break;s.to>e&&(n+=this.input.read(Math.max(s.from,e),Math.min(s.to,t)))}return n}}class mn{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;Ag(this.data,e,t,this.id,n.data,n.tokenPrecTable)}}mn.prototype.contextual=mn.prototype.fallback=mn.prototype.extend=!1;mn.prototype.fallback=mn.prototype.extend=!1;class Ln{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function Ag(i,e,t,n,s,r){let o=0,l=1<<n,{dialect:a}=t.p.parser;e:for(;l&i[o];){let c=i[o+1];for(let d=o+3;d<c;d+=2)if((i[d+1]&l)>0){let p=i[d];if(a.allows(p)&&(e.token.value==-1||e.token.value==p||Pg(p,e.token.value,s,r))){e.acceptToken(p);break}}let h=e.next,u=0,f=i[o+2];if(e.next<0&&f>u&&i[c+f*3-3]==65535){o=i[c+f*3-1];continue e}for(;u<f;){let d=u+f>>1,p=c+d+(d<<1),m=i[p],b=i[p+1]||65536;if(h<m)f=d;else if(h>=b)u=d+1;else{o=i[p+2],e.advance();continue e}}break}}function va(i,e,t){for(let n=e,s;(s=i[n])!=65535;n++)if(s==t)return n-e;return-1}function Pg(i,e,t,n){let s=va(t,n,e);return s<0||va(t,n,i)<s}const De=typeof process<"u"&&ma&&/\bparse\b/.test(ma.LOG);let br=null;function xa(i,e,t){let n=i.cursor(se.IncludeAnonymous);for(n.moveTo(e);;)if(!(t<0?n.childBefore(e):n.childAfter(e)))for(;;){if((t<0?n.to<e:n.from>e)&&!n.type.isError)return t<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(i.length,Math.max(n.from+1,e+25));if(t<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return t<0?0:i.length}}let Eg=class{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?xa(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?xa(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],s=this.index[t];if(s==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=n.children[s],o=this.start[t]+n.positions[s];if(o>e)return this.nextStart=o,null;if(r instanceof Z){if(o==e){if(o<this.safeFrom)return null;let l=o+r.length;if(l<=this.safeTo){let a=r.prop(N.lookAhead);if(!a||l+a<this.fragment.to)return r}}this.index[t]++,o+r.length>=Math.max(this.safeFrom,e)&&(this.trees.push(r),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+r.length}}};class Tg{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(n=>new ms)}getActions(e){let t=0,n=null,{parser:s}=e.p,{tokenizers:r}=s,o=s.stateSlot(e.state,3),l=e.curContext?e.curContext.hash:0,a=0;for(let c=0;c<r.length;c++){if(!(1<<c&o))continue;let h=r[c],u=this.tokens[c];if(!(n&&!h.fallback)&&((h.contextual||u.start!=e.pos||u.mask!=o||u.context!=l)&&(this.updateCachedToken(u,h,e),u.mask=o,u.context=l),u.lookAhead>u.end+25&&(a=Math.max(u.lookAhead,a)),u.value!=0)){let f=t;if(u.extended>-1&&(t=this.addActions(e,u.extended,u.end,t)),t=this.addActions(e,u.value,u.end,t),!h.extend&&(n=u,t>f))break}}for(;this.actions.length>t;)this.actions.pop();return a&&e.setLookAhead(a),!n&&e.pos==this.stream.end&&(n=new ms,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new ms,{pos:n,p:s}=e;return t.start=n,t.end=Math.min(n+1,s.stream.end),t.value=n==s.stream.end?s.parser.eofTerm:0,t}updateCachedToken(e,t,n){let s=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(s,e),n),e.value>-1){let{parser:r}=n.p;for(let o=0;o<r.specialized.length;o++)if(r.specialized[o]==e.value){let l=r.specializers[o](this.stream.read(e.start,e.end),n);if(l>=0&&n.p.parser.dialect.allows(l>>1)){l&1?e.extended=l>>1:e.value=l>>1;break}}}else e.value=0,e.end=this.stream.clipPos(s+1)}putAction(e,t,n,s){for(let r=0;r<s;r+=3)if(this.actions[r]==e)return s;return this.actions[s++]=e,this.actions[s++]=t,this.actions[s++]=n,s}addActions(e,t,n,s){let{state:r}=e,{parser:o}=e.p,{data:l}=o;for(let a=0;a<2;a++)for(let c=o.stateSlot(r,a?2:1);;c+=3){if(l[c]==65535)if(l[c+1]==1)c=mt(l,c+2);else{s==0&&l[c+1]==2&&(s=this.putAction(mt(l,c+2),t,n,s));break}l[c]==t&&(s=this.putAction(mt(l,c+1),t,n,s))}return s}}class Rg{constructor(e,t,n,s){this.parser=e,this.input=t,this.ranges=s,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new _g(t,s),this.tokens=new Tg(e,this.stream),this.topTerm=e.top[1];let{from:r}=s[0];this.stacks=[Ps.start(this,e.top[0],r)],this.fragments=n.length&&this.stream.end-r>e.bufferLength*4?new Eg(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,n=this.stacks=[],s,r;if(this.bigReductionCount>300&&e.length==1){let[o]=e;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<e.length;o++){let l=e[o];for(;;){if(this.tokens.mainToken=null,l.pos>t)n.push(l);else{if(this.advanceStack(l,n,e))continue;{s||(s=[],r=[]),s.push(l);let a=this.tokens.getMainToken(l);r.push(a.value,a.end)}}break}}if(!n.length){let o=s&&Dg(s);if(o)return De&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw De&&s&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&s){let o=this.stoppedAt!=null&&s[0].pos>this.stoppedAt?s[0]:this.runRecovery(s,r,n);if(o)return De&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(n.length>o)for(n.sort((l,a)=>a.score-l.score);n.length>o;)n.pop();n.some(l=>l.reducePos>t)&&this.recovering--}else if(n.length>1){e:for(let o=0;o<n.length-1;o++){let l=n[o];for(let a=o+1;a<n.length;a++){let c=n[a];if(l.sameState(c)||l.buffer.length>500&&c.buffer.length>500)if((l.score-c.score||l.buffer.length-c.buffer.length)>0)n.splice(a--,1);else{n.splice(o--,1);continue e}}}n.length>12&&n.splice(12,n.length-12)}this.minStackPos=n[0].pos;for(let o=1;o<n.length;o++)n[o].pos<this.minStackPos&&(this.minStackPos=n[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let s=e.pos,{parser:r}=this,o=De?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&s>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let c=e.curContext&&e.curContext.tracker.strict,h=c?e.curContext.hash:0;for(let u=this.fragments.nodeAt(s);u;){let f=this.parser.nodeSet.types[u.type.id]==u.type?r.getGoto(e.state,u.type.id):-1;if(f>-1&&u.length&&(!c||(u.prop(N.contextHash)||0)==h))return e.useNode(u,f),De&&console.log(o+this.stackID(e)+` (via reuse of ${r.getName(u.type.id)})`),!0;if(!(u instanceof Z)||u.children.length==0||u.positions[0]>0)break;let d=u.children[0];if(d instanceof Z&&u.positions[0]==0)u=d;else break}}let l=r.stateSlot(e.state,4);if(l>0)return e.reduce(l),De&&console.log(o+this.stackID(e)+` (via always-reduce ${r.getName(l&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let a=this.tokens.getActions(e);for(let c=0;c<a.length;){let h=a[c++],u=a[c++],f=a[c++],d=c==a.length||!n,p=d?e:e.split(),m=this.tokens.mainToken;if(p.apply(h,u,m?m.start:p.pos,f),De&&console.log(o+this.stackID(p)+` (via ${h&65536?`reduce of ${r.getName(h&65535)}`:"shift"} for ${r.getName(u)} @ ${s}${p==e?"":", split"})`),d)return!0;p.pos>s?t.push(p):n.push(p)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return Oa(e,t),!0}}runRecovery(e,t,n){let s=null,r=!1;for(let o=0;o<e.length;o++){let l=e[o],a=t[o<<1],c=t[(o<<1)+1],h=De?this.stackID(l)+" -> ":"";if(l.deadEnd&&(r||(r=!0,l.restart(),De&&console.log(h+this.stackID(l)+" (restarted)"),this.advanceFully(l,n))))continue;let u=l.split(),f=h;for(let d=0;u.forceReduce()&&d<10&&(De&&console.log(f+this.stackID(u)+" (via force-reduce)"),!this.advanceFully(u,n));d++)De&&(f=this.stackID(u)+" -> ");for(let d of l.recoverByInsert(a))De&&console.log(h+this.stackID(d)+" (via recover-insert)"),this.advanceFully(d,n);this.stream.end>l.pos?(c==l.pos&&(c++,a=0),l.recoverByDelete(a,c),De&&console.log(h+this.stackID(l)+` (via recover-delete ${this.parser.getName(a)})`),Oa(l,n)):(!s||s.score<l.score)&&(s=l)}return s}stackToTree(e){return e.close(),Z.build({buffer:Es.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(br||(br=new WeakMap)).get(e);return t||br.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function Oa(i,e){for(let t=0;t<e.length;t++){let n=e[t];if(n.pos==i.pos&&n.sameState(i)){e[t].score<i.score&&(e[t]=i);return}}e.push(i)}class Mg{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||this.disabled[e]==0}}const yr=i=>i;class $g{constructor(e){this.start=e.start,this.shift=e.shift||yr,this.reduce=e.reduce||yr,this.reuse=e.reuse||yr,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class bi extends Zo{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let l=0;l<e.repeatNodeCount;l++)t.push("");let n=Object.keys(e.topRules).map(l=>e.topRules[l][1]),s=[];for(let l=0;l<t.length;l++)s.push([]);function r(l,a,c){s[l].push([a,a.deserialize(String(c))])}if(e.nodeProps)for(let l of e.nodeProps){let a=l[0];typeof a=="string"&&(a=N[a]);for(let c=1;c<l.length;){let h=l[c++];if(h>=0)r(h,a,l[c++]);else{let u=l[c+-h];for(let f=-h;f>0;f--)r(l[c++],a,u);c++}}}this.nodeSet=new Ti(t.map((l,a)=>fe.define({name:a>=this.minRepeatTerm?void 0:l,id:a,props:s[a],top:n.indexOf(a)>-1,error:a==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(a)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=Uh;let o=Hi(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let l=0;l<this.specializerSpecs.length;l++)this.specialized[l]=this.specializerSpecs[l].term;this.specializers=this.specializerSpecs.map(ka),this.states=Hi(e.states,Uint32Array),this.data=Hi(e.stateData),this.goto=Hi(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(l=>typeof l=="number"?new mn(o,l):l),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let s=new Rg(this,e,t,n);for(let r of this.wrappers)s=r(s,e,t,n);return s}getGoto(e,t,n=!1){let s=this.goto;if(t>=s[0])return-1;for(let r=s[t+1];;){let o=s[r++],l=o&1,a=s[r++];if(l&&n)return a;for(let c=r+(o>>1);r<c;r++)if(s[r]==e)return a;if(l)return-1}}hasAction(e,t){let n=this.data;for(let s=0;s<2;s++)for(let r=this.stateSlot(e,s?2:1),o;;r+=3){if((o=n[r])==65535)if(n[r+1]==1)o=n[r=mt(n,r+2)];else{if(n[r+1]==2)return mt(n,r+2);break}if(o==t||o==0)return mt(n,r+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,n=>n==t?!0:null)}allActions(e,t){let n=this.stateSlot(e,4),s=n?t(n):void 0;for(let r=this.stateSlot(e,1);s==null;r+=3){if(this.data[r]==65535)if(this.data[r+1]==1)r=mt(this.data,r+2);else break;s=t(mt(this.data,r+1))}return s}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=mt(this.data,n+2);else break;if(!(this.data[n+2]&1)){let s=this.data[n+1];t.some((r,o)=>o&1&&r==s)||t.push(this.data[n],s)}}return t}configure(e){let t=Object.assign(Object.create(bi.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(n=>{let s=e.tokenizers.find(r=>r.from==n);return s?s.to:n})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((n,s)=>{let r=e.specializers.find(l=>l.from==n.external);if(!r)return n;let o=Object.assign(Object.assign({},n),{external:r.to});return t.specializers[s]=ka(o),o})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map(()=>!1);if(e)for(let r of e.split(" ")){let o=t.indexOf(r);o>=0&&(n[o]=!0)}let s=null;for(let r=0;r<t.length;r++)if(!n[r])for(let o=this.dialects[t[r]],l;(l=this.data[o++])!=65535;)(s||(s=new Uint8Array(this.maxTerm+1)))[l]=1;return new Mg(e,n,s)}static deserialize(e){return new bi(e)}}function mt(i,e){return i[e]|i[e+1]<<16}function Dg(i){let e=null;for(let t of i){let n=t.p.stoppedAt;(t.pos==t.p.stream.end||n!=null&&t.pos>n)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function ka(i){if(i.external){let e=i.extend?1:0;return(t,n)=>i.external(t,n)<<1|e}return i.get}let Bg=0;class Le{constructor(e,t,n,s){this.name=e,this.set=t,this.base=n,this.modified=s,this.id=Bg++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let n=typeof e=="string"?e:"?";if(e instanceof Le&&(t=e),t!=null&&t.base)throw new Error("Can not derive from a modified tag");let s=new Le(n,[],null,[]);if(s.set.push(s),t)for(let r of t.set)s.set.push(r);return s}static defineModifier(e){let t=new Ts(e);return n=>n.modified.indexOf(t)>-1?n:Ts.get(n.base||n,n.modified.concat(t).sort((s,r)=>s.id-r.id))}}let Lg=0;class Ts{constructor(e){this.name=e,this.instances=[],this.id=Lg++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find(l=>l.base==e&&Ig(t,l.modified));if(n)return n;let s=[],r=new Le(e.name,s,e,t);for(let l of t)l.instances.push(r);let o=Fg(t);for(let l of e.set)if(!l.modified.length)for(let a of o)s.push(Ts.get(l,a));return r}}function Ig(i,e){return i.length==e.length&&i.every((t,n)=>t==e[n])}function Fg(i){let e=[[]];for(let t=0;t<i.length;t++)for(let n=0,s=e.length;n<s;n++)e.push(e[n].concat(i[t]));return e.sort((t,n)=>n.length-t.length)}function Ri(i){let e=Object.create(null);for(let t in i){let n=i[t];Array.isArray(n)||(n=[n]);for(let s of t.split(" "))if(s){let r=[],o=2,l=s;for(let u=0;;){if(l=="..."&&u>0&&u+3==s.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!f)throw new RangeError("Invalid path: "+s);if(r.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),u+=f[0].length,u==s.length)break;let d=s[u++];if(u==s.length&&d=="!"){o=0;break}if(d!="/")throw new RangeError("Invalid path: "+s);l=s.slice(u)}let a=r.length-1,c=r[a];if(!c)throw new RangeError("Invalid path: "+s);let h=new Rs(n,o,a>0?r.slice(0,a):null);e[c]=h.sort(e[c])}}return Jh.add(e)}const Jh=new N;class Rs{constructor(e,t,n,s){this.tags=e,this.mode=t,this.context=n,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Rs.empty=new Rs([],2,null);function eu(i,e){let t=Object.create(null);for(let r of i)if(!Array.isArray(r.tag))t[r.tag.id]=r.class;else for(let o of r.tag)t[o.id]=r.class;let{scope:n,all:s=null}=e||{};return{style:r=>{let o=s;for(let l of r)for(let a of l.set){let c=t[a.id];if(c){o=o?o+" "+c:c;break}}return o},scope:n}}function Ng(i,e){let t=null;for(let n of i){let s=n.style(e);s&&(t=t?t+" "+s:s)}return t}function qg(i,e,t,n=0,s=i.length){let r=new Qg(n,Array.isArray(e)?e:[e],t);r.highlightRange(i.cursor(),n,s,"",r.highlighters),r.flush(s)}class Qg{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,s,r){let{type:o,from:l,to:a}=e;if(l>=n||a<=t)return;o.isTop&&(r=this.highlighters.filter(d=>!d.scope||d.scope(o)));let c=s,h=Hg(e)||Rs.empty,u=Ng(r,h.tags);if(u&&(c&&(c+=" "),c+=u,h.mode==1&&(s+=(s?" ":"")+u)),this.startSpan(Math.max(t,l),c),h.opaque)return;let f=e.tree&&e.tree.prop(N.mounted);if(f&&f.overlay){let d=e.node.enter(f.overlay[0].from+l,1),p=this.highlighters.filter(b=>!b.scope||b.scope(f.tree.type)),m=e.firstChild();for(let b=0,y=l;;b++){let v=b<f.overlay.length?f.overlay[b]:null,x=v?v.from+l:a,w=Math.max(t,y),k=Math.min(n,x);if(w<k&&m)for(;e.from<k&&(this.highlightRange(e,w,k,s,r),this.startSpan(Math.min(k,e.to),c),!(e.to>=x||!e.nextSibling())););if(!v||x>n)break;y=v.to+l,y>t&&(this.highlightRange(d.cursor(),Math.max(t,v.from+l),Math.min(n,y),"",p),this.startSpan(Math.min(n,y),c))}m&&e.parent()}else if(e.firstChild()){f&&(s="");do if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,s,r),this.startSpan(Math.min(n,e.to),c)}while(e.nextSibling());e.parent()}}}function Hg(i){let e=i.type.prop(Jh);for(;e&&e.context&&!i.matchContext(e.context);)e=e.next;return e||null}const P=Le.define,Vi=P(),St=P(),wa=P(St),Sa=P(St),Ct=P(),zi=P(Ct),vr=P(Ct),st=P(),Qt=P(st),tt=P(),nt=P(),Jr=P(),Vn=P(Jr),Xi=P(),g={comment:Vi,lineComment:P(Vi),blockComment:P(Vi),docComment:P(Vi),name:St,variableName:P(St),typeName:wa,tagName:P(wa),propertyName:Sa,attributeName:P(Sa),className:P(St),labelName:P(St),namespace:P(St),macroName:P(St),literal:Ct,string:zi,docString:P(zi),character:P(zi),attributeValue:P(zi),number:vr,integer:P(vr),float:P(vr),bool:P(Ct),regexp:P(Ct),escape:P(Ct),color:P(Ct),url:P(Ct),keyword:tt,self:P(tt),null:P(tt),atom:P(tt),unit:P(tt),modifier:P(tt),operatorKeyword:P(tt),controlKeyword:P(tt),definitionKeyword:P(tt),moduleKeyword:P(tt),operator:nt,derefOperator:P(nt),arithmeticOperator:P(nt),logicOperator:P(nt),bitwiseOperator:P(nt),compareOperator:P(nt),updateOperator:P(nt),definitionOperator:P(nt),typeOperator:P(nt),controlOperator:P(nt),punctuation:Jr,separator:P(Jr),bracket:Vn,angleBracket:P(Vn),squareBracket:P(Vn),paren:P(Vn),brace:P(Vn),content:st,heading:Qt,heading1:P(Qt),heading2:P(Qt),heading3:P(Qt),heading4:P(Qt),heading5:P(Qt),heading6:P(Qt),contentSeparator:P(st),list:P(st),quote:P(st),emphasis:P(st),strong:P(st),link:P(st),monospace:P(st),strikethrough:P(st),inserted:P(),deleted:P(),changed:P(),invalid:P(),meta:Xi,documentMeta:P(Xi),annotation:P(Xi),processingInstruction:P(Xi),definition:Le.defineModifier("definition"),constant:Le.defineModifier("constant"),function:Le.defineModifier("function"),standard:Le.defineModifier("standard"),local:Le.defineModifier("local"),special:Le.defineModifier("special")};for(let i in g){let e=g[i];e instanceof Le&&(e.name=i)}eu([{tag:g.link,class:"tok-link"},{tag:g.heading,class:"tok-heading"},{tag:g.emphasis,class:"tok-emphasis"},{tag:g.strong,class:"tok-strong"},{tag:g.keyword,class:"tok-keyword"},{tag:g.atom,class:"tok-atom"},{tag:g.bool,class:"tok-bool"},{tag:g.url,class:"tok-url"},{tag:g.labelName,class:"tok-labelName"},{tag:g.inserted,class:"tok-inserted"},{tag:g.deleted,class:"tok-deleted"},{tag:g.literal,class:"tok-literal"},{tag:g.string,class:"tok-string"},{tag:g.number,class:"tok-number"},{tag:[g.regexp,g.escape,g.special(g.string)],class:"tok-string2"},{tag:g.variableName,class:"tok-variableName"},{tag:g.local(g.variableName),class:"tok-variableName tok-local"},{tag:g.definition(g.variableName),class:"tok-variableName tok-definition"},{tag:g.special(g.variableName),class:"tok-variableName2"},{tag:g.definition(g.propertyName),class:"tok-propertyName tok-definition"},{tag:g.typeName,class:"tok-typeName"},{tag:g.namespace,class:"tok-namespace"},{tag:g.className,class:"tok-className"},{tag:g.macroName,class:"tok-macroName"},{tag:g.propertyName,class:"tok-propertyName"},{tag:g.operator,class:"tok-operator"},{tag:g.comment,class:"tok-comment"},{tag:g.meta,class:"tok-meta"},{tag:g.invalid,class:"tok-invalid"},{tag:g.punctuation,class:"tok-punctuation"}]);var Sn={};const Vg=121,Jo=122,tu=123,zg=124,Ca=128,Xg=4,Wg=131,jg=7,Yg=8,Ug=9,Gg=10,Kg=139,nu=19,Zg=140,Jg=23,em=141,tm=27,nm=37,im=41,sm=145,rm=146,om=147,lm=148,am=47,cm=68,iu=154,su=70,ru=155,ou=72,hm=156,um=76,fm=161,dm=79,pm=80,gm=81,mm=167,lu=89,bm=90,ym=169,vm=97,xm=171,Om=98,km=100,wm=101,el=typeof process<"u"&&Sn&&/\bfparse(:dbg)?\b/.test(Sn.LOG),tl=typeof process<"u"&&Sn&&/\bfparse:dbg\b/.test(Sn.LOG),pt=typeof process<"u"&&Sn&&/\bcontext\b/.test(Sn.LOG),au=[9,11,12,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],Sm=cu(`
\r`),_a=42,Cm=cu("'./-+*^");function cu(i){return Array.from(i).map(e=>e.charCodeAt(0))}function _m(i){return i===63||i>=65&&i<=90||i===95||i>=97&&i<=122||i>=192&&i<=214||i>=216&&i<=246||i>=248&&i<=767||i>=880&&i<=893||i>=895&&i<=8191||i>=8204&&i<=8205||i>=8304&&i<=8591||i>=11264&&i<=12271||i>=12289&&i<=55295||i>=63744&&i<=64975||i>=65008&&i<=65533||i>=55296&&i<=56319||i>=56320&&i<=57343}function Am(i){return Cm.includes(i)}function Pm(i){return i>=48&&i<=57||i===183||i>=768&&i<=879||i>=8255&&i<=8256}function Em(i){return au.includes(i)}function Aa(i,e){return e.concat(i.split(/\n/g).join(`
`+e))}function Tm(i,e=0){const t=i.peek(e);return t===_a&&i.peek(e+1)===_a?{offset:2,token:"**"}:Am(t)?{offset:1,token:String.fromCharCode(t)}:null}function tr(i,e=0,t=!1){for(let n=!1,s=[],r=0;;r++){const o=i.peek(e+r);if(_m(o)||(n||t)&&Pm(o))n||(n=!0),s.push(o);else return s.length?{token:String.fromCharCode(...s),offset:r}:null}}function hu(i,e){for(let t=!1,n=0;;n++){let s=i.peek(e+n);if(Em(s))t||(t=!0);else return t?{token:" ",offset:n}:null}}function Rm(i,e){const t=e.contextKeys(),n=e.tokens;for(let s=0,r=[],o=null;;){const l=n.length+r.length>0,a=r.length>0,c=tr(i,s,l)||l&&Tm(i,s)||a&&hu(i,s);if(!c)return o;const{token:h,offset:u}=c;if(s+=u,h===" ")continue;r=[...r,h];const f=[...n,...r].join(" ");if(t.some(d=>d===f)){const d=r[0];o={token:d,offset:d.length,term:tu}}if(!t.some(d=>d.startsWith(f))){if(Pa.some(d=>d===f)){const d=r[0];o={token:d,offset:d.length,term:Jo}}if(!Pa.some(d=>d.startsWith(f)))return o}}}const Mm={[Jo]:"identifier",[tu]:"nameIdentifier"},$m=new Ln((i,e)=>{tl&&console.log("%s: T <identifier | nameIdentifier>",i.pos);const t=Rm(i,e.context),n=e.context.tokens,s=t||tr(i,0,n.length>0);s&&(i.advance(s.offset),i.acceptToken(t?t.term:Jo),el&&console.log("%s: MATCH <%s> <%s>",i.pos,t?Mm[t.term]:"identifier",s.token))},{contextual:!0}),Dm=new Ln((i,e)=>{tl&&console.log("%s: T <propertyIdentifier>",i.pos);const t=e.context.tokens,n=tr(i,0,t.length>0);n&&(i.advance(n.offset),i.acceptToken(Vg),el&&console.log("%s: MATCH <propertyIdentifier> <%s>",i.pos,n.token))}),Bm=new Ln((i,e)=>{tl&&console.log("%s: T <insertSemi>",i.pos);let t,n=!1;for(t=0;;t++){const s=i.peek(t);if(!au.includes(s)){Sm.includes(s)&&(n=!0);break}}if(n){const s=tr(i,t+1);if(hu(i,t+1)||s&&/^(then|else|return|satisfies)$/.test(s.token))return;el&&console.log("%s: MATCH <insertSemi>",i.pos),i.acceptToken(zg)}}),Lm={[hm]:"FunctionInvocation",[ru]:"FilterExpression",[iu]:"PathExpression"},Im={[xm]:"Context",[ym]:"FunctionDefinition",[Wg]:"ForExpression",[mm]:"List",[Zg]:"IfExpression",[em]:"QuantifiedExpression"},Fm={[vm]:"Context",[bm]:"FunctionDefinition",[Xg]:"ForExpression",[lu]:"List",[nu]:"IfExpression",[Jg]:"QuantifiedExpression",[cm]:"PathExpression",[ou]:"FunctionInvocation",[su]:"FilterExpression",[im]:"ArithmeticExpression"};class Cn{constructor(e){this.fn=e}get(e){return this.fn(e)}static of(e){return new Cn(e)}}const Nm={"date and time":1,date:1,time:1,duration:1},Pa=Object.keys(Nm);class qm{constructor(e={}){this.value=e}getKeys(){return Object.keys(this.value)}get(e){const t=this.value[e],n=this.constructor;return n.isAtomic(t)?t:n.of(t)}set(e,t){return this.constructor.of({...this.value,[e]:t})}merge(e){const t=this.constructor;return new t(t.__merge(this.value,e))}static isAtomic(e){return!e||e instanceof this||e instanceof Cn||typeof e!="object"}static of(...e){return e.reduce((t,n)=>t.merge(n),new this({}))}static __unwrap(e){return e?e instanceof this?e.value:typeof e!="object"?{}:{...e}:{}}static __merge(e,t){return Rp(this.__unwrap(t),(n,s,r)=>s instanceof Cn?{...n,[r]:s}:(s=this.__unwrap(s),Mp(n,r)&&(s=this.__merge(this.__unwrap(n[r]),s)),{...n,[r]:s}),this.__unwrap(e))}}class si{constructor({name:e="Expressions",tokens:t=[],children:n=[],parent:s=null,context:r,value:o,raw:l}){this.name=e,this.tokens=t,this.children=n,this.parent=s,this.context=r,this.value=o,this.raw=l}enterScope(e){const t=this.of({name:e,parent:this});return pt&&console.log("[%s] enter",t.path,t.context),t}exitScope(e){return this.parent?(pt&&console.log(`[%s] exit %o
%s`,this.path,this.context,Aa(e,"  ")),this.parent.pushChild(this)):(pt&&console.log(`[%s] NO exit %o
%s`,this.path,this.context,Aa(e,"  ")),this)}token(e){return pt&&console.log("[%s] token <%s> + <%s>",this.path,this.tokens.join(" "),e),this.assign({tokens:[...this.tokens,e]})}literal(e){return pt&&console.log("[%s] literal %o",this.path,e),this.pushChild(this.of({name:"Literal",value:e}))}computedValue(){for(let e=this;;e=un(e.children)){if(!e)return null;if(e.value)return e.value}}contextKeys(){return this.context.getKeys().map(bs)}get path(){var e,t;return((t=(e=this.parent)==null?void 0:e.path)==null?void 0:t.concat(" > ",this.name))||this.name}get(e){const t=[e,e&&bs(e)],n=this.context.getKeys().find(r=>t.includes(bs(r)));if(typeof n>"u")return;const s=this.context.get(n);return s instanceof Cn?s.get(this):s}resolveName(){const e=this.tokens.join(" "),t=[],n=this.assign({tokens:t}),s=this.of({name:"VariableName",parent:n,value:this.get(e),raw:e});return pt&&console.log("[%s] resolve name <%s=%s>",s.path,e,this.get(e)),n.pushChild(s)}pushChild(e){if(!e)return this;const t=this.assign({children:[...this.children,e]});return e.parent=t,t}pushChildren(e){let t=this;for(const n of e)t=t.pushChild(n);return t}declareName(){if(this.tokens.length===0)throw Error("no tokens to declare name");const e=this.tokens.join(" ");return pt&&console.log("[%s] declareName <%s>",this.path,e),this.assign({tokens:[]}).pushChild(this.of({name:"Name",value:e}))}define(e,t){if(typeof e!="string")return pt&&console.log("[%s] no define <%s=%s>",this.path,e,t),this;pt&&console.log("[%s] define <%s=%s>",this.path,e,t);const n=this.context.set(e,t);return this.assign({context:n})}assign(e={}){return si.of({...this,...e})}of(e={}){const t={context:this.context,parent:this.parent};return si.of({...t,...e})}static of(e){const{name:t,tokens:n=[],children:s=[],parent:r=null,context:o,value:l,raw:a}=e;if(!o)throw new Error("must provide <context>");return new si({name:t,tokens:[...n],children:[...s],context:o,parent:r,value:l,raw:a})}}function bs(i){return i.replace(/\s*([./\-'+]|\*\*?)\s*/g," $1 ").replace(/\s{2,}/g," ").trim()}function Ea(i,e,t){const n=i.children.filter(c=>c.name!==e),s=i.children.filter(c=>c.name===e),r=n[0],o=n[Math.max(1,n.length-1)],l=r==null?void 0:r.computedValue(),a=(o==null?void 0:o.computedValue())||null;return i.assign({children:s}).enterScope(e).pushChildren(n).exitScope(t).define(l,a)}function uu(i={},e=qm){const t=si.of({context:e.of(i)});return new $g({start:t,reduce(n,s,r,o){if(s===nu){const[u,f]=n.children.slice(-2);n=n.assign({value:e.of(u==null?void 0:u.computedValue(),f==null?void 0:f.computedValue())})}if(s===lu&&(n=n.assign({value:e.of(...n.children.map(u=>u==null?void 0:u.computedValue()))})),s===su){const[u,f]=n.children.slice(-2);n=n.assign({value:u==null?void 0:u.computedValue()})}if(s===ou){const[u,...f]=n.children;(u==null?void 0:u.raw)==="get value"&&(n=Hm(n,f))}const l=Im[s];if(l)return n.enterScope(l);const a=Lm[s];if(a){const{children:u,context:f}=n,d=u.slice(0,-1),p=un(u);let m=null;return s===iu&&(m=e.of(p==null?void 0:p.computedValue())),s===ru&&(m=e.of(f,p==null?void 0:p.computedValue()).set("item",p==null?void 0:p.computedValue())),n.assign({children:d}).enterScope(a).pushChild(p).assign({context:m||f})}const c=o.read(o.pos,r.pos);if(Fm[s])return n.exitScope(c);if(s===Om){const u=n.children.filter(p=>p.name!=="ContextEntry"),f=u[0],d=un(u);return Ea(n,"ContextEntry",c).assign({value:e.of(n.value).set(f==null?void 0:f.computedValue(),d==null?void 0:d.computedValue())})}if(s===jg||s===tm)return Ea(n,"InExpression",c);if(s===Kg)return n.define("partial",Cn.of(u=>{var f;return(f=un(u.children))==null?void 0:f.computedValue()}));if(s===um){const u=un(n.children).computedValue();return n.define(u,1)}if(s===sm||s===rm||s===om){const u=n.children.slice(0,-1),f=un(n.children);return n.assign({children:u}).enterScope("ArithmeticExpression").pushChild(f)}if(s===lm)return n.enterScope("ArithmeticExpression");if(s===Ug||s===Gg||s===wm)return n.token(c);if(s===pm)return n.literal(c.replace(/^"|"$/g,""));if(s===gm)return n.literal(c==="true");if(s===dm)return n.literal(parseFloat(c));if(s===fm)return n.literal(null);if(s===am)return n.resolveName();if(s===Yg||s===km)return n.declareName();if((s===Ca||s===nm)&&n.tokens.length>0)throw new Error("uncleared name");if(s===Ca){let u=n;for(;u.parent;)u=u.exitScope(c);return u}return n}})}const Qm=uu({});function Hm(i,e){if(!e.length)return i.assign({value:null});if(e[0].name==="Name"&&(e=Vm(e,["m","key"])),e.length!==2)return i.assign({value:null});const[t,n]=e,s=n==null?void 0:n.computedValue(),r=t==null?void 0:t.computedValue();return!r||typeof r!="object"||typeof s!="string"?i.assign({value:null}):i.assign({value:[bs(s),s].reduce((o,l)=>r.get(l)||o,null)})}function Vm(i,e){const t={};for(let n=0;n<i.length;n+=2){const[s,r]=i.slice(n,n+2);t[s.value]=r}return e.map(n=>t[n])}function un(i){return i[i.length-1]}const zm=Ri({StringLiteral:g.string,NumericLiteral:g.number,BooleanLiteral:g.bool,"AtLiteral!":g.special(g.string),CompareOp:g.compareOperator,ArithOp:g.arithmeticOperator,"for if then else some every satisfies between return":g.controlKeyword,"in instance of and or":g.operatorKeyword,function:g.definitionKeyword,as:g.keyword,"Type/...":g.typeName,Wildcard:g.special(g.variableName),null:g.null,LineComment:g.lineComment,BlockComment:g.blockComment,'VariableName! "?"':g.variableName,"DateTimeConstructor! SpecialFunctionName!":g.function(g.special(g.variableName)),"List Interval":g.list,Context:g.definition(g.literal),"Name!":g.definition(g.variableName),"Key/Name! ContextEntryType/Name!":g.definition(g.propertyName),"PathExpression/VariableName!":g.function(g.propertyName),"FormalParameter/ParameterName!":g.function(g.definition(g.variableName)),"( )":g.paren,"[ ]":g.squareBracket,"{ }":g.brace,".":g.derefOperator,", ;":g.separator,"..":g.punctuation}),Xm={__proto__:null,for:10,in:32,return:36,if:40,then:42,else:44,some:48,every:50,satisfies:56,or:60,and:64,between:72,instance:86,of:89,days:101,time:103,duration:105,years:107,months:109,date:111,list:117,context:123,function:130,null:156,true:330,false:330,"?":170,external:186,not:211},fu=bi.deserialize({version:14,states:"C|O`QYOOO`QYOOO$mQYOOOOQU'#Ce'#CeO$wQYO'#C`O&QQYO'#FQOOQQ'#Ff'#FfO&[QYO'#FfO`QYO'#DVOOQU'#En'#EnO'{Q^O'#D]OOQU'#D^'#D^OOQU'#D]'#D]OOQO'#Fn'#FnO)xQWO'#DvOOQQ'#D}'#D}OOQQ'#EO'#EOOOQQ'#EP'#EPO)}OWO'#ESO)xQWO'#EQOOQQ'#EQ'#EQOOQQ'#Ft'#FtOOQQ'#Fr'#FrOOQQ'#Fy'#FyOOQQ'#EU'#EUO`QYO'#EWOOQQ'#FS'#FSO*SQ^O'#FSO+yQYO'#EXO,QQWO'#EYOOQP'#F}'#F}O,VQXO'#EaOOQQ'#Fz'#FzOOQQ'#FR'#FRQOQWOOOOQQ'#FT'#FTOOQQ'#F^'#F^O`QYO'#CoOOQQ'#F_'#F_O$wQYO'#CsO,bQYO'#DwOOQQ'#Fs'#FsO,gQYO'#EROOQO'#ER'#ERO`QYO'#EVO`QYO'#EUOOQO'#F{'#F{Q,oQWOOO,tQYO'#DRO-kQWO'#FbOOQO'#DT'#DTO-vQYO'#FfO-}QWOOO.tQYO'#CdO/RQYO'#FVOOQQ'#Cc'#CcO/WQYO'#FUOOQQ'#Cb'#CbO/`QYO,58zO`QYO,59iOOQQ'#Fc'#FcOOQQ'#Fd'#FdOOQQ'#Fe'#FeO`QYO,59qO`QYO,59qO`QYO,59qOOQQ'#Fl'#FlO/eQYO,5:^OOQQ'#Fm'#FmO`QYO,5:`O`QYO,59eO`QYO,59gO`QYO,59iO1^QYO,59iO1eQYO,59rOOQQ,5:i,5:iO1jQYO,59qOOQU-E8l-E8lO3^QYO'#FoOOQQ,5:b,5:bOOQQ,5:n,5:nOOQQ,5:l,5:lO3eQYO,5:rOOQQ,5;n,5;nO3oQYO,5:qO3|QWO,5:sO4RQYO,5:tOOQP'#Ee'#EeO4xQXO'#EdOOQO'#Ec'#EcO5PQWO'#EbO5UQWO'#GOO5^QWO,5:{O5cQYO,59ZO/RQYO'#FaOOQQ'#Cw'#CwO5jQYO'#F`OOQQ'#Cv'#CvO5rQYO,59_O5wQYO,5:cO5|QYO,5:mO3hQYO,5:qO6RQYO,5:pO`QYO'#EwQ,oQWOOO`QYO'#EmO6xQWO,5;|O`QYOOOOQR'#Cf'#CfOOQQ'#Ej'#EjO7rQYO,59OO`QYO,5;qOOQQ'#FY'#FYO$wQYO'#EkO8SQYO,5;pO`QYO1G.fOOQQ'#F]'#F]O8yQYO1G/TO;pQYO1G/]O;zQYO1G/]O<UQYO1G/]OOQQ1G/x1G/xO=xQYO1G/zO>PQYO1G/PO?YQYO1G/RO@cQYO1G/TO`QYO1G/TOOQQ1G/T1G/TO@yQYO1G/^OAhQ^O'#CdOBzQYO'#FqOOQO'#Dz'#DzOCUQWO'#DyOCZQWO'#FpOOQO'#Dx'#DxOOQO'#D{'#D{OCcQWO,5<ZOOQQ1G0^1G0^O`QYO1G0]O`QYO'#EsOChQWO,5<]OOQQ1G0_1G0_OCsQWO'#E[ODOQWO'#F|OOQO'#EZ'#EZODWQWO1G0`OOQP'#Eu'#EuOD]QXO,5;OO`QYO,5:|ODdQXO'#EvODlQWO,5<jOOQQ1G0g1G0gO`QYO1G.uO`QYO,5;{O$wQYO'#ElODtQYO,5;zO`QYO1G.yOD|QYO1G/}OOQO1G0X1G0XOOQO,5;c,5;cOOQO-E8u-E8uOOQO,5;X,5;XOOQO-E8k-E8kOERQWOOOOQQ-E8h-E8hOEWQYO'#CmOOQQ1G1]1G1]OOQQ,5;V,5;VOOQQ-E8i-E8iOEeQYO7+$QOOQQ7+%f7+%fO`QYO7+$oOF[QYO,5:rOFiQWO7+$oOFnQYO'#D[OOQQ'#DZ'#DZOHbQYO'#D_OHgQYO'#D_OHlQYO'#D_OHqQ`O'#DgOHvQ`O'#DjOH{Q`O'#DnOOQQ7+$x7+$xO`QYO,5:eO$wQYO'#ErOIQQWO,5<[OOQQ1G1u1G1uOJWQYO7+%wOJeQYO,5;_OOQO-E8q-E8qO@yQYO,5:vO$wQYO'#EtOJrQWO,5<hOJzQYO7+%zOOQP-E8s-E8sOKRQYO1G0hOOQO,5;b,5;bOOQO-E8t-E8tOK]QYO7+$aOKdQYO1G1gOOQQ,5;W,5;WOOQQ-E8j-E8jOKnQYO7+$eOOQO7+%i7+%iO`QYO,59XOLeQYO<<HZOOQQ<<HZ<<HZO/eQYO'#EoOMnQYO,59vO! bQYO,59yO! gQYO,59yO! lQYO,59yO! qQYO,5:RO$wQYO,5:UO!!`QbO,5:YO!!gQYO1G0POOQO,5;^,5;^OOQO-E8p-E8pO!!qQYO<<IcOOQQ<<Ic<<IcOOQO1G0b1G0bOOQO,5;`,5;`OOQO-E8r-E8rO!%pQYO'#E^OOQQ<<If<<IfO`QYO<<IfO`QYO<<G{O!&gQYO1G.sOOQQ,5;Z,5;ZOOQQ-E8m-E8mO!&qQYO1G/eOOQQ1G/e1G/eO!&vQbO'#D]O!'XQ`O'#D[O!'dQ`O1G/mO!'iQWO'#DmO!'nQ`O'#FhOOQO'#Dl'#DlO!'vQ`O1G/pOOQO'#Dq'#DqO!'{Q`O'#FjOOQO'#Dp'#DpO!(TQ`O1G/tOOQQAN?QAN?QO!(YQYOAN=gOOQQ7+%P7+%PO!)PQ`O,59vOOQQ7+%X7+%XO! qQYO,5:XO$wQYO'#EpO!)[Q`O,5<SOOQQ7+%[7+%[O! qQYO'#EqO!)dQ`O,5<UO!)lQ`O7+%`OOQO1G/s1G/sOOQO,5;[,5;[OOQO-E8n-E8nOOQO,5;],5;]OOQO-E8o-E8oO@yQYO<<HzOOQQAN>fAN>fO/eQYO'#EoO! qQYO<<HzO!)qQ`O7+%`O!)vQ`O1G/tO!!`QbO,5:YO!){Q`O'#Dn",stateData:"!*[~O#rOS#sOSPOSQOS~OTsOZVO[UOdtOhvOivOs}OviO!T{O!U{O!VxO!XzO!c!OO!g|O!igO!pyO!wjO#SnO#nRO#oRO$ZZO$i_O$j`O$kaO$lbO~OTsO[UOdtOhvOivOs}OviO!T{O!U{O!VxO!XzO!c!OO!g|O!igO!pyO!wjO#SnO#nRO#oRO$ZZO$i_O$j`O$kaO$lbO~OZ!TO#]!UO~P#PO#nRO#oRO~OZ!^O[!^O]!_O^!_O_!`O`!kOn!hOp!iOr!]Os!]Ot!jO{!lO!i!fO#z!dOv$bX~O#l#tX$s#tX~P%PO$i!mOT$YXZ$YX[$YXd$YXh$YXi$YXs$YXv$YX!T$YX!U$YX!V$YX!X$YX!c$YX!g$YX!i$YX!p$YX!w$YX#S$YX#n$YX#o$YX$Z$YX$j$YX$k$YX$l$YX~O#nRO#oROZ!PX[!PX]!PX^!PX_!PX`!PXn!PXp!PXr!PXs!PXt!PXv!PX{!PX!i!PX#l!PX#p!PX#z!PX$s!PX$O!PXx!PX#}!PX!g!PXe!PXb!PX#R!PXf!PXl!PX~Ov!pO~O$j`O~O#p!uOZ#vX[#vX]#vX^#vX_#vX`#vXn#vXp#vXr#vXs#vXt#vXv#vX{#vX!i#vX#l#vX#z#vX$s#vX$O#vXx#vX#}#vX!g#vXe#vXb#vX#R#vXf#vXl#vX~O!g$eP~P`Ov!xO~O#m!yO$j`O#R$rP~Op#VO~Op#WOv!uX~O$s#ZO~O#luX$OuX$suXxuX#}uX!guXeuXbuX#RuXfuXluX~P%PO$O#]O#l$UXx$UX~O#l#[X~P&[Ov#_O~OZ#`O[#`O]#`O^#`O_#`O#nRO#oRO#z#`O#{#`O$]WX~O`WXxWX$OWX~P.SO`#dO~O$O#eOb#xX~Ob#hO~O#nRO#oRO$ZZO~OTsOZVO[UOdtOhvOivOs}O!T{O!U{O!VxO!XzO!c!OO!g|O!igO!pyO!wjO#SnO#nRO#oRO$ZZO$i_O$j`O$kaO$lbO~Ov#rO~P/pO|#tO~O{!lO!i!fO#z!dOZya[ya]ya^ya_ya`yanyapyaryasyatyav$bX#lya$sya$Oyaxya#}ya!gyaeyabya#Ryafyalya~Ox$eP~P`Ox#}O#}$OO~P%PO#}$OO$O$PO!g$eX~P%PO!g$RO~O#nRO#oROx$pP~OZ#`O[#`O]#`O^#`O_#`O#m!yO#z#`O#{#`O~O$]#WX~P4^O$]$YO~O$O$ZO#R$rX~O#R$]O~Oe$^O~P%PO$O$`Ol$SX~Ol$bO~O!W$cO~O!T$dO~O#l!xa$s!xa$O!xax!xa#}!xa!g!xae!xab!xa#R!xaf!xal!xa~P%PO$O#]O#l$Uax$Ua~OZ#`O[#`O]#`O^#`O_#`O#nRO#oRO#z#`O#{#`O~O`Wa$]WaxWa$OWa~P7TO$O#eOb#xa~OZ!^O[!^O]!_O^!_O_!`O{!lO!i!fO#z!dOv$bX~O`qinqipqirqisqitqi#lqi$sqi$Oqixqi#}qi!gqieqibqi#Rqifqilqi~P8[O_!`O{!lO!i!fO#z!dOZyi[yi`yinyipyiryisyityiv$bX#lyi$syi$Oyixyi#}yi!gyieyibyi#Ryifyilyi~O]!_O^!_O~P:SO]yi^yi~P:SO{!lO!i!fO#z!dOZyi[yi]yi^yi_yi`yinyipyiryisyityiv$bX#lyi$syi$Oyixyi#}yi!gyieyibyi#Ryifyilyi~O!g$pO~P%PO`!kOp!iOr!]Os!]Ot!jOnmi#lmi$smi$Omixmi#}mi!gmiemibmi#Rmifmilmi~P8[O`!kOr!]Os!]Ot!jOnoipoi#loi$soi$Ooixoi#}oi!goieoiboi#Roifoiloi~P8[O`!kOn!hOp$qOr!]Os!]Ot!jO~P8[O!S$vO!V$wO!X$xO![$yO!_$zO!c${O#nRO#oRO$ZZO~OZ#bX[#bX]#bX^#bX_#bX`#bXn#bXp#bXr#bXs#bXt#bXv#bXx#bX{#bX!i#bX#n#bX#o#bX#p#bX#z#bX$O#bX~P.SO$O$POx$eX~P%PO$]$}O~O$O%OOx$dX~Ox%QO~O$O$PO!g$eax$ea~O$]%UOx#OX$O#OX~O$O%VOx$pX~Ox%XO~O$]#Wa~P4^O#m!yO$j`O~O$O$ZO#R$ra~O$O$`Ol$Sa~O!U%cO~OxrO~O#}%dObaX$OaX~P%PO#lSq$sSq$OSqxSq#}Sq!gSqeSqbSq#RSqfSqlSq~P%POx#}O#}$OO$OuX~P%POx%fO~O#z%gOZ!OX[!OX]!OX^!OX_!OX`!OXn!OXp!OXr!OXs!OXt!OXv!OX{!OX!i!OX#l!OX$s!OX$O!OXx!OX#}!OX!g!OXe!OXb!OX#R!OXf!OXl!OX~Op%iO~Op%jO~Op%kO~O!]%lO~O!]%mO~O!]%nO~O$O%OOx$da~OZ!^O[!^O]!_O^!_O_!`O`!kOn!hOp!iOr!]Os!]Ot!jO{!lO#z!dOv$bX~Ox%sO!g%sO!i%rO~PIYO!g#ga$O#gax#ga~P%PO$O%VOx$pa~O#P%yO~P`O#R#Ui$O#Ui~P%POf%zO~P%POl$Ti$O$Ti~P%PO#lgq$sgq$Ogqxgq#}gq!ggqegqbgq#Rgqfgqlgq~P%PO`qynqypqyrqysqytqy#lqy$sqy$Oqyxqy#}qy!gqyeqybqy#Rqyfqylqy~P8[O#z%gOZ!Oa[!Oa]!Oa^!Oa_!Oa`!Oan!Oap!Oar!Oas!Oat!Oav!Oa{!Oa!i!Oa#l!Oa$s!Oa$O!Oax!Oa#}!Oa!g!Oae!Oab!Oa#R!Oaf!Oal!Oa~O!T&OO~O!W&OO~O!T&PO~O!S$vO!V$wO!X$xO![$yO!_$zO!c&uO#nRO#oRO$ZZO~O!Y$^P~P! qOx!mi$O!mi~P%POT$aXZ$aX[$aX]!yy^!yy_!yy`!yyd$aXh$aXi$aXn!yyp!yyr!yys$aXt!yyv$aX{!yy!T$aX!U$aX!V$aX!X$aX!c$aX!g$aX!i$aX!p$aX!w$aX#S$aX#l!yy#n$aX#o$aX#z!yy$Z$aX$i$aX$j$aX$k$aX$l$aX$s!yy$O!yyx!yy#}!yye!yyb!yy#R!yyf!yyl!yy~O#l#QX$s#QX$O#QXx#QX#}#QX!g#QXe#QXb#QX#R#QXf#QXl#QX~P%PObai$Oai~P%PO!U&_O~O#nRO#oRO!Y!PX#z!PX$O!PX~O#z&pO!Y!OX$O!OX~O!Y&aO~O$]&bO~O$O&cO!Y$[X~O!Y&eO~O$O&fO!Y$^X~O!Y&hO~O#lc!R$sc!R$Oc!Rxc!R#}c!R!gc!Rec!Rbc!R#Rc!Rfc!Rlc!R~P%PO#z&pO!Y!Oa$O!Oa~O$O&cO!Y$[a~O$O&fO!Y$^a~O$_&nO~O$_&qO~O!Y&rO~O!]&tO~O$Z~QP_^$i]#z~",goto:"E|$sPPPP$tP%m%p%v&Y'sPPPPPP'|P$tPPP$tPP(P(SP$tP$tP$tPPP(YP(eP$t$tPP(n)T)`*m)TPPPPPPP)TPP)TP+r+u)TP+{,R$tP$tP$t,Y-R-U-[-RP-d.]-d-d/]0UP$t0}$t1v1v2o2rP2xPP1v3O3U/X3YPP3bP3e3l3r3x4O5Z5e5k5q5w6O6U6[6bPPPPPPPP6h6q8x9q:j:mPP:qPP:w:z;s<l<o<s<x=g>V>vP?oP?rP?v@iA[BTBZB^$tBdBdPPPPC]8xDUD}EQEy!mjOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%zR![SQ!YSR$m#eS!WS#eS#Qw$`W#w!p!x%O%VT&T%m&c#WXOPQWYilu|}!]!a!b!c!e!g!h!i!j!k#Z#]#_#c#g#r#t$O$P$Y$^$_$b$q$}%U%X%d%g%l%n%y%z&Q&b&f&n&p&q&tb!VSw!x#e$`%O%V%m&cU#a!V#b#uR#u!pU#a!V#b#uT$W!z$XR$l#cR#UwQ#SwR%`$`U!RQ#_#rQ#s!kR$g#]QrQQ$i#_R$s#rQ$|#tQ%t%UQ&S%lU&X%n&f&tQ&i&bT&o&n&qc$u#t%U%l%n&b&f&n&q&t!lkOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%zQ#m!eU$t#t%U&nS%|%g&p]&R%l%n&b&f&q&t#V[OPQWilu|}!]!a!b!c!e!g!h!i!j!k!p#Z#]#_#c#g#r#t$O$P$Y$^$_$b$q$}%U%X%d%g%l%n%y%z&b&f&n&p&q&tR&W%mQ&U%mR&j&cQ&[%nR&s&tS&Y%n&tR&l&f!m]OPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%zR#|!pQ#y!pR%p%OS#x!p%OT$S!x%V!meOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%z!leOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%zQ!rbT!{o$Z!mcOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%z!mdOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%z!mhOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%z!mpOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%zR$V!xQ$T!xR%u%VQ%x%XR&]%yQ!}oR%[$ZT!|o$ZS!zo$ZT$W!z$XRrQS#b!V#uR$j#bQ#f!YR$n#fQ$a#SR%a$aQ#^!RR$h#^!vYOPQWilu|}!]!a!b!c!e!g!h!i!j!k!p#Z#]#_#c#g#r#t$O$P$Y$^$_$b$q$}%U%X%d%g%y%z&nS!oY&Q_&Q%l%n&b&f&p&q&tQ%h$tS%}%h&`R&`&RQ&d&UR&k&dQ&g&YR&m&gQ%P#yR%q%PS$Q!v#vR%T$QQ%W$TR%v%WQ$X!zR%Y$XQ$[!}R%]$[Q#[!PR$f#[QrOQ!PPR$e#ZUTOP#ZW!QQ!k#]#_Q!nWQ!tiQ!vlQ#PuQ#X|Q#Y}Q#i!]Q#j!aQ#k!bQ#l!cQ#n!gQ#o!hQ#p!iQ#q!jQ#v!pQ$k#cQ$o#gQ$r#rQ%R$OQ%S$PQ%Z$YQ%^$^Q%_$_Q%b$bQ%e$qQ%o$}S%w%X%yQ%{%dR&^%z!mqOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%z!mSOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%zR!ZST!XS#eQ#c!WR$_#QR#g![!muOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%z!mwOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%zR#TwT#Rw$`V!SQ#_#r!X!aT!Q!t!v#P#X#Y#i#n#o#p#q#v$k$o$r%R%S%Z%^%_%b%e%o%w%{&^!Z!bT!Q!t!v#P#X#Y#i#j#n#o#p#q#v$k$o$r%R%S%Z%^%_%b%e%o%w%{&^!]!cT!Q!t!v#P#X#Y#i#j#k#n#o#p#q#v$k$o$r%R%S%Z%^%_%b%e%o%w%{&^!mWOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%zR&V%mT&Z%n&t!a!eT!Q!n!t!v#P#X#Y#i#j#k#l#n#o#p#q#v$k$o$r%R%S%Z%^%_%b%e%o%w%{&^!a!gT!Q!n!t!v#P#X#Y#i#j#k#l#n#o#p#q#v$k$o$r%R%S%Z%^%_%b%e%o%w%{&^!m^OPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%zQ!q^R!scR#z!pQ!wlR#{!p!mfOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%z!mlOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%z!mmOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%zR$U!x!moOPQWilu|}!]!a!b!c!g!h!i!j!k!p#Z#]#_#c#g#r$O$P$Y$^$_$b$q$}%X%d%y%zR#Oo",nodeNames:" LineComment BlockComment Expression ForExpression for InExpressions InExpression Name Identifier Identifier ArithOp ArithOp ArithOp ArithOp ArithOp in IterationContext return IfExpression if then else QuantifiedExpression some every InExpressions InExpression satisfies Disjunction or Conjunction and Comparison CompareOp CompareOp between PositiveUnaryTest ( PositiveUnaryTests ) ArithmeticExpression InstanceOfExpression instance of Type QualifiedName VariableName BacktickIdentifier SpecialType days time duration years months date > ListType list < ContextType context ContextEntryTypes ContextEntryType FunctionType function ArgumentTypes ArgumentType PathExpression ] FilterExpression [ FunctionInvocation SpecialFunctionName NamedParameters NamedParameter ParameterName PositionalParameters null NumericLiteral StringLiteral BooleanLiteral DateTimeLiteral DateTimeConstructor AtLiteral ? SimplePositiveUnaryTest Interval ParenthesizedExpression List FunctionDefinition FormalParameters FormalParameter external FunctionBody } { Context ContextEntry Key Name Identifier Expressions UnaryTests Wildcard not",maxTerm:173,context:Qm,nodeProps:[["closedBy",38,")",71,"]",96,"}"],["openedBy",40,"(",69,"[",95,"{"],["group",-5,78,79,80,81,82,"Literal"]],propSources:[zm],skippedNodes:[0,1,2],repeatNodeCount:14,tokenData:"-c~RvXY#iYZ$^Z[#i]^$^pq#iqr$crs$nwx&fxy&kyz&pz{&u{|'S|}'X}!O'^!O!P'k!P!Q(T!Q![*O![!]*a!]!^*f!^!_*k!_!`$i!`!a*z!b!c+U!}#O+Z#P#Q+`#Q#R&}#S#T+e#o#p-X#q#r-^$f$g#i#BY#BZ#i$IS$I_#i$I|$I}$^$I}$JO$^$JT$JU#i$KV$KW#i&FU&FV#i?HT?HU#i~#nY#r~XY#iZ[#ipq#i$f$g#i#BY#BZ#i$IS$I_#i$JT$JU#i$KV$KW#i&FU&FV#i?HT?HU#i~$cO#s~~$fP!_!`$i~$nOr~~$sW$j~OY$nZr$nrs%]s#O$n#O#P%b#P;'S$n;'S;=`&`<%lO$n~%bO$j~~%eRO;'S$n;'S;=`%n;=`O$n~%sX$j~OY$nZr$nrs%]s#O$n#O#P%b#P;'S$n;'S;=`&`;=`<%l$n<%lO$n~&cP;=`<%l$n~&kO#{~~&pOv~~&uOx~~&zP^~z{&}~'SO_~~'XO[~~'^O$O~R'cPZP!`!a'fQ'kO$_Q~'pQ#z~!O!P'v!Q!['{~'{O#}~~(QP$i~!Q!['{~(YQ]~z{(`!P!Q)g~(cTOz(`z{(r{;'S(`;'S;=`)a<%lO(`~(uVOz(`z{(r{!P(`!P!Q)[!Q;'S(`;'S;=`)a<%lO(`~)aOQ~~)dP;=`<%l(`~)lSP~OY)gZ;'S)g;'S;=`)x<%lO)g~){P;=`<%l)g~*TQ$i~!O!P*Z!Q![*O~*^P!Q!['{~*fO$]~~*kO$s~R*rP!]QsP!_!`*uP*zOsPR+RP!YQsP!_!`*u~+ZO$l~~+`O!i~~+eO!g~~+hWOY+eZ#O+e#O#P,Q#P#S+e#S#T,|#T;'S+e;'S;=`-R<%lO+e~,TRO;'S+e;'S;=`,^;=`O+e~,aXOY+eZ#O+e#O#P,Q#P#S+e#S#T,|#T;'S+e;'S;=`-R;=`<%l+e<%lO+e~-RO$Z~~-UP;=`<%l+e~-^O#S~~-cO#R~",tokenizers:[Dm,$m,Bm,0,1],topRules:{Expression:[0,3],Expressions:[1,102],UnaryTests:[2,103]},dialects:{camunda:2532},dynamicPrecedences:{31:-1,68:1,72:-1,74:-1},specialized:[{term:122,get:i=>Xm[i]||-1}],tokenPrec:2534});class j{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){[e,t]=_n(this,e,t);let s=[];return this.decompose(0,e,s,2),n.length&&n.decompose(0,n.length,s,3),this.decompose(t,this.length,s,1),rt.from(s,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=_n(this,e,t);let n=[];return this.decompose(e,t,n,0),rt.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),s=new ri(this),r=new ri(e);for(let o=t,l=t;;){if(s.next(o),r.next(o),o=0,s.lineBreak!=r.lineBreak||s.done!=r.done||s.value!=r.value)return!1;if(l+=s.value.length,s.done||l>=n)return!0}}iter(e=1){return new ri(this,e)}iterRange(e,t=this.length){return new du(this,e,t)}iterLines(e,t){let n;if(e==null)n=this.iter();else{t==null&&(t=this.lines+1);let s=this.line(e).from;n=this.iterRange(s,Math.max(s,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new pu(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?j.empty:e.length<=32?new ae(e):rt.from(ae.split(e,[]))}}class ae extends j{constructor(e,t=Wm(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,s){for(let r=0;;r++){let o=this.text[r],l=s+o.length;if((t?n:l)>=e)return new jm(s,l,n,o);s=l+1,n++}}decompose(e,t,n,s){let r=e<=0&&t>=this.length?this:new ae(Ta(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(s&1){let o=n.pop(),l=ys(r.text,o.text.slice(),0,r.length);if(l.length<=32)n.push(new ae(l,o.length+r.length));else{let a=l.length>>1;n.push(new ae(l.slice(0,a)),new ae(l.slice(a)))}}else n.push(r)}replace(e,t,n){if(!(n instanceof ae))return super.replace(e,t,n);[e,t]=_n(this,e,t);let s=ys(this.text,ys(n.text,Ta(this.text,0,e)),t),r=this.length+n.length-(t-e);return s.length<=32?new ae(s,r):rt.from(ae.split(s,[]),r)}sliceString(e,t=this.length,n=`
`){[e,t]=_n(this,e,t);let s="";for(let r=0,o=0;r<=t&&o<this.text.length;o++){let l=this.text[o],a=r+l.length;r>e&&o&&(s+=n),e<a&&t>r&&(s+=l.slice(Math.max(0,e-r),t-r)),r=a+1}return s}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],s=-1;for(let r of e)n.push(r),s+=r.length+1,n.length==32&&(t.push(new ae(n,s)),n=[],s=-1);return s>-1&&t.push(new ae(n,s)),t}}class rt extends j{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,t,n,s){for(let r=0;;r++){let o=this.children[r],l=s+o.length,a=n+o.lines-1;if((t?a:l)>=e)return o.lineInner(e,t,n,s);s=l+1,n=a+1}}decompose(e,t,n,s){for(let r=0,o=0;o<=t&&r<this.children.length;r++){let l=this.children[r],a=o+l.length;if(e<=a&&t>=o){let c=s&((o<=e?1:0)|(a>=t?2:0));o>=e&&a<=t&&!c?n.push(l):l.decompose(e-o,t-o,n,c)}o=a+1}}replace(e,t,n){if([e,t]=_n(this,e,t),n.lines<this.lines)for(let s=0,r=0;s<this.children.length;s++){let o=this.children[s],l=r+o.length;if(e>=r&&t<=l){let a=o.replace(e-r,t-r,n),c=this.lines-o.lines+a.lines;if(a.lines<c>>4&&a.lines>c>>6){let h=this.children.slice();return h[s]=a,new rt(h,this.length-(t-e)+n.length)}return super.replace(r,l,a)}r=l+1}return super.replace(e,t,n)}sliceString(e,t=this.length,n=`
`){[e,t]=_n(this,e,t);let s="";for(let r=0,o=0;r<this.children.length&&o<=t;r++){let l=this.children[r],a=o+l.length;o>e&&r&&(s+=n),e<a&&t>o&&(s+=l.sliceString(e-o,t-o,n)),o=a+1}return s}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof rt))return 0;let n=0,[s,r,o,l]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;s+=t,r+=t){if(s==o||r==l)return n;let a=this.children[s],c=e.children[r];if(a!=c)return n+a.scanIdentical(c,t);n+=a.length+1}}static from(e,t=e.reduce((n,s)=>n+s.length+1,-1)){let n=0;for(let d of e)n+=d.lines;if(n<32){let d=[];for(let p of e)p.flatten(d);return new ae(d,t)}let s=Math.max(32,n>>5),r=s<<1,o=s>>1,l=[],a=0,c=-1,h=[];function u(d){let p;if(d.lines>r&&d instanceof rt)for(let m of d.children)u(m);else d.lines>o&&(a>o||!a)?(f(),l.push(d)):d instanceof ae&&a&&(p=h[h.length-1])instanceof ae&&d.lines+p.lines<=32?(a+=d.lines,c+=d.length+1,h[h.length-1]=new ae(p.text.concat(d.text),p.length+1+d.length)):(a+d.lines>s&&f(),a+=d.lines,c+=d.length+1,h.push(d))}function f(){a!=0&&(l.push(h.length==1?h[0]:rt.from(h,c)),c=-1,a=h.length=0)}for(let d of e)u(d);return f(),l.length==1?l[0]:new rt(l,t)}}j.empty=new ae([""],0);function Wm(i){let e=-1;for(let t of i)e+=t.length+1;return e}function ys(i,e,t=0,n=1e9){for(let s=0,r=0,o=!0;r<i.length&&s<=n;r++){let l=i[r],a=s+l.length;a>=t&&(a>n&&(l=l.slice(0,n-s)),s<t&&(l=l.slice(t-s)),o?(e[e.length-1]+=l,o=!1):e.push(l)),s=a+1}return e}function Ta(i,e,t){return ys(i,[""],e,t)}class ri{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof ae?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,s=this.nodes[n],r=this.offsets[n],o=r>>1,l=s instanceof ae?s.text.length:s.children.length;if(o==(t>0?l:0)){if(n==0)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((r&1)==(t>0?0:1)){if(this.offsets[n]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(s instanceof ae){let a=s.text[o+(t<0?-1:0)];if(this.offsets[n]+=t,a.length>Math.max(0,e))return this.value=e==0?a:t>0?a.slice(e):a.slice(0,a.length-e),this;e-=a.length}else{let a=s.children[o+(t<0?-1:0)];e>a.length?(e-=a.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(a),this.offsets.push(t>0?1:(a instanceof ae?a.text.length:a.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class du{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new ri(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:s}=this.cursor.next(e);return this.pos+=(s.length+e)*t,this.value=s.length<=n?s:t<0?s.slice(s.length-n):s.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class pu{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:s}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(j.prototype[Symbol.iterator]=function(){return this.iter()},ri.prototype[Symbol.iterator]=du.prototype[Symbol.iterator]=pu.prototype[Symbol.iterator]=function(){return this});let jm=class{constructor(e,t,n,s){this.from=e,this.to=t,this.number=n,this.text=s}get length(){return this.to-this.from}};function _n(i,e,t){return e=Math.max(0,Math.min(i.length,e)),[e,Math.max(e,Math.min(i.length,t))]}let bn="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(i=>i?parseInt(i,36):1);for(let i=1;i<bn.length;i++)bn[i]+=bn[i-1];function Ym(i){for(let e=1;e<bn.length;e+=2)if(bn[e]>i)return bn[e-1]<=i;return!1}function Ra(i){return i>=127462&&i<=127487}const Ma=8205;function _e(i,e,t=!0,n=!0){return(t?gu:Um)(i,e,n)}function gu(i,e,t){if(e==i.length)return e;e&&mu(i.charCodeAt(e))&&bu(i.charCodeAt(e-1))&&e--;let n=Ie(i,e);for(e+=ot(n);e<i.length;){let s=Ie(i,e);if(n==Ma||s==Ma||t&&Ym(s))e+=ot(s),n=s;else if(Ra(s)){let r=0,o=e-2;for(;o>=0&&Ra(Ie(i,o));)r++,o-=2;if(r%2==0)break;e+=2}else break}return e}function Um(i,e,t){for(;e>0;){let n=gu(i,e-2,t);if(n<e)return n;e--}return 0}function mu(i){return i>=56320&&i<57344}function bu(i){return i>=55296&&i<56320}function Ie(i,e){let t=i.charCodeAt(e);if(!bu(t)||e+1==i.length)return t;let n=i.charCodeAt(e+1);return mu(n)?(t-55296<<10)+(n-56320)+65536:t}function yu(i){return i<=65535?String.fromCharCode(i):(i-=65536,String.fromCharCode((i>>10)+55296,(i&1023)+56320))}function ot(i){return i<65536?1:2}const eo=/\r\n?|\n/;var ye=function(i){return i[i.Simple=0]="Simple",i[i.TrackDel=1]="TrackDel",i[i.TrackBefore=2]="TrackBefore",i[i.TrackAfter=3]="TrackAfter",i}(ye||(ye={}));class vt{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,s=0;t<this.sections.length;){let r=this.sections[t++],o=this.sections[t++];o<0?(e(n,s,r),s+=r):s+=o,n+=r}}iterChangedRanges(e,t=!1){to(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],s=this.sections[t++];s<0?e.push(n,s):e.push(s,n)}return new vt(e)}composeDesc(e){return this.empty?e:e.empty?this:vu(this,e)}mapDesc(e,t=!1){return e.empty?this:no(this,e,t)}mapPos(e,t=-1,n=ye.Simple){let s=0,r=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],a=this.sections[o++],c=s+l;if(a<0){if(c>e)return r+(e-s);r+=l}else{if(n!=ye.Simple&&c>=e&&(n==ye.TrackDel&&s<e&&c>e||n==ye.TrackBefore&&s<e||n==ye.TrackAfter&&c>e))return null;if(c>e||c==e&&t<0&&!l)return e==s||t<0?r:r+a;r+=a}s=c}if(e>s)throw new RangeError(`Position ${e} is out of range for changeset of length ${s}`);return r}touchesRange(e,t=e){for(let n=0,s=0;n<this.sections.length&&s<=t;){let r=this.sections[n++],o=this.sections[n++],l=s+r;if(o>=0&&s<=t&&l>=e)return s<e&&l>t?"cover":!0;s=l}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],s=this.sections[t++];e+=(e?" ":"")+n+(s>=0?":"+s:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new vt(e)}static create(e){return new vt(e)}}class pe extends vt{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return to(this,(t,n,s,r,o)=>e=e.replace(s,s+(n-t),o),!1),e}mapDesc(e,t=!1){return no(this,e,t,!0)}invert(e){let t=this.sections.slice(),n=[];for(let s=0,r=0;s<t.length;s+=2){let o=t[s],l=t[s+1];if(l>=0){t[s]=l,t[s+1]=o;let a=s>>1;for(;n.length<a;)n.push(j.empty);n.push(o?e.slice(r,r+o):j.empty)}r+=o}return new pe(t,n)}compose(e){return this.empty?e:e.empty?this:vu(this,e,!0)}map(e,t=!1){return e.empty?this:no(this,e,t,!0)}iterChanges(e,t=!1){to(this,e,t)}get desc(){return vt.create(this.sections)}filter(e){let t=[],n=[],s=[],r=new yi(this);e:for(let o=0,l=0;;){let a=o==e.length?1e9:e[o++];for(;l<a||l==a&&r.len==0;){if(r.done)break e;let h=Math.min(r.len,a-l);ke(s,h,-1);let u=r.ins==-1?-1:r.off==0?r.ins:0;ke(t,h,u),u>0&&Tt(n,t,r.text),r.forward(h),l+=h}let c=e[o++];for(;l<c;){if(r.done)break e;let h=Math.min(r.len,c-l);ke(t,h,-1),ke(s,h,r.ins==-1?-1:r.off==0?r.ins:0),r.forward(h),l+=h}}return{changes:new pe(t,n),filtered:vt.create(s)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],s=this.sections[t+1];s<0?e.push(n):s==0?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let s=[],r=[],o=0,l=null;function a(h=!1){if(!h&&!s.length)return;o<t&&ke(s,t-o,-1);let u=new pe(s,r);l=l?l.compose(u.map(l)):u,s=[],r=[],o=0}function c(h){if(Array.isArray(h))for(let u of h)c(u);else if(h instanceof pe){if(h.length!=t)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${t})`);a(),l=l?l.compose(h.map(l)):h}else{let{from:u,to:f=u,insert:d}=h;if(u>f||u<0||f>t)throw new RangeError(`Invalid change range ${u} to ${f} (in doc of length ${t})`);let p=d?typeof d=="string"?j.of(d.split(n||eo)):d:j.empty,m=p.length;if(u==f&&m==0)return;u<o&&a(),u>o&&ke(s,u-o,-1),ke(s,f-u,m),Tt(r,s,p),o=f}}return c(e),a(!l),l}static empty(e){return new pe(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let s=0;s<e.length;s++){let r=e[s];if(typeof r=="number")t.push(r,-1);else{if(!Array.isArray(r)||typeof r[0]!="number"||r.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(r.length==1)t.push(r[0],0);else{for(;n.length<s;)n.push(j.empty);n[s]=j.of(r.slice(1)),t.push(r[0],n[s].length)}}}return new pe(t,n)}static createSet(e,t){return new pe(e,t)}}function ke(i,e,t,n=!1){if(e==0&&t<=0)return;let s=i.length-2;s>=0&&t<=0&&t==i[s+1]?i[s]+=e:e==0&&i[s]==0?i[s+1]+=t:n?(i[s]+=e,i[s+1]+=t):i.push(e,t)}function Tt(i,e,t){if(t.length==0)return;let n=e.length-2>>1;if(n<i.length)i[i.length-1]=i[i.length-1].append(t);else{for(;i.length<n;)i.push(j.empty);i.push(t)}}function to(i,e,t){let n=i.inserted;for(let s=0,r=0,o=0;o<i.sections.length;){let l=i.sections[o++],a=i.sections[o++];if(a<0)s+=l,r+=l;else{let c=s,h=r,u=j.empty;for(;c+=l,h+=a,a&&n&&(u=u.append(n[o-2>>1])),!(t||o==i.sections.length||i.sections[o+1]<0);)l=i.sections[o++],a=i.sections[o++];e(s,c,r,h,u),s=c,r=h}}}function no(i,e,t,n=!1){let s=[],r=n?[]:null,o=new yi(i),l=new yi(e);for(let a=-1;;)if(o.ins==-1&&l.ins==-1){let c=Math.min(o.len,l.len);ke(s,c,-1),o.forward(c),l.forward(c)}else if(l.ins>=0&&(o.ins<0||a==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!t))){let c=l.len;for(ke(s,l.ins,-1);c;){let h=Math.min(o.len,c);o.ins>=0&&a<o.i&&o.len<=h&&(ke(s,0,o.ins),r&&Tt(r,s,o.text),a=o.i),o.forward(h),c-=h}l.next()}else if(o.ins>=0){let c=0,h=o.len;for(;h;)if(l.ins==-1){let u=Math.min(h,l.len);c+=u,h-=u,l.forward(u)}else if(l.ins==0&&l.len<h)h-=l.len,l.next();else break;ke(s,c,a<o.i?o.ins:0),r&&a<o.i&&Tt(r,s,o.text),a=o.i,o.forward(o.len-h)}else{if(o.done&&l.done)return r?pe.createSet(s,r):vt.create(s);throw new Error("Mismatched change set lengths")}}function vu(i,e,t=!1){let n=[],s=t?[]:null,r=new yi(i),o=new yi(e);for(let l=!1;;){if(r.done&&o.done)return s?pe.createSet(n,s):vt.create(n);if(r.ins==0)ke(n,r.len,0,l),r.next();else if(o.len==0&&!o.done)ke(n,0,o.ins,l),s&&Tt(s,n,o.text),o.next();else{if(r.done||o.done)throw new Error("Mismatched change set lengths");{let a=Math.min(r.len2,o.len),c=n.length;if(r.ins==-1){let h=o.ins==-1?-1:o.off?0:o.ins;ke(n,a,h,l),s&&h&&Tt(s,n,o.text)}else o.ins==-1?(ke(n,r.off?0:r.len,a,l),s&&Tt(s,n,r.textBit(a))):(ke(n,r.off?0:r.len,o.off?0:o.ins,l),s&&!o.off&&Tt(s,n,o.text));l=(r.ins>a||o.ins>=0&&o.len>a)&&(l||n.length>c),r.forward2(a),o.forward(a)}}}}class yi{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?j.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?j.empty:t[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Yt{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let n,s;return this.empty?n=s=e.mapPos(this.from,t):(n=e.mapPos(this.from,1),s=e.mapPos(this.to,-1)),n==this.from&&s==this.to?this:new Yt(n,s,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return C.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return C.range(this.anchor,n)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return C.range(e.anchor,e.head)}static create(e,t,n){return new Yt(e,t,n)}}class C{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:C.create(this.ranges.map(n=>n.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new C([this.main],0)}addRange(e,t=!0){return C.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let n=this.ranges.slice();return n[t]=e,C.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new C(e.ranges.map(t=>Yt.fromJSON(t)),e.main)}static single(e,t=e){return new C([C.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,s=0;s<e.length;s++){let r=e[s];if(r.empty?r.from<=n:r.from<n)return C.normalized(e.slice(),t);n=r.to}return new C(e,t)}static cursor(e,t=0,n,s){return Yt.create(e,e,(t==0?0:t<0?8:16)|(n==null?7:Math.min(6,n))|(s??16777215)<<6)}static range(e,t,n,s){let r=(n??16777215)<<6|(s==null?7:Math.min(6,s));return t<e?Yt.create(t,e,48|r):Yt.create(e,t,(t>e?8:0)|r)}static normalized(e,t=0){let n=e[t];e.sort((s,r)=>s.from-r.from),t=e.indexOf(n);for(let s=1;s<e.length;s++){let r=e[s],o=e[s-1];if(r.empty?r.from<=o.to:r.from<o.to){let l=o.from,a=Math.max(r.to,o.to);s<=t&&t--,e.splice(--s,2,r.anchor>r.head?C.range(a,l):C.range(l,a))}}return new C(e,t)}}function xu(i,e){for(let t of i.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let nl=0;class D{constructor(e,t,n,s,r){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=s,this.id=nl++,this.default=e([]),this.extensions=typeof r=="function"?r(this):r}get reader(){return this}static define(e={}){return new D(e.combine||(t=>t),e.compareInput||((t,n)=>t===n),e.compare||(e.combine?(t,n)=>t===n:il),!!e.static,e.enables)}of(e){return new vs([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new vs(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new vs(e,this,2,t)}from(e,t){return t||(t=n=>n),this.compute([e],n=>t(n.field(e)))}}function il(i,e){return i==e||i.length==e.length&&i.every((t,n)=>t===e[n])}class vs{constructor(e,t,n,s){this.dependencies=e,this.facet=t,this.type=n,this.value=s,this.id=nl++}dynamicSlot(e){var t;let n=this.value,s=this.facet.compareInput,r=this.id,o=e[r]>>1,l=this.type==2,a=!1,c=!1,h=[];for(let u of this.dependencies)u=="doc"?a=!0:u=="selection"?c=!0:((t=e[u.id])!==null&&t!==void 0?t:1)&1||h.push(e[u.id]);return{create(u){return u.values[o]=n(u),1},update(u,f){if(a&&f.docChanged||c&&(f.docChanged||f.selection)||io(u,h)){let d=n(u);if(l?!$a(d,u.values[o],s):!s(d,u.values[o]))return u.values[o]=d,1}return 0},reconfigure:(u,f)=>{let d,p=f.config.address[r];if(p!=null){let m=$s(f,p);if(this.dependencies.every(b=>b instanceof D?f.facet(b)===u.facet(b):b instanceof Fe?f.field(b,!1)==u.field(b,!1):!0)||(l?$a(d=n(u),m,s):s(d=n(u),m)))return u.values[o]=m,0}else d=n(u);return u.values[o]=d,1}}}}function $a(i,e,t){if(i.length!=e.length)return!1;for(let n=0;n<i.length;n++)if(!t(i[n],e[n]))return!1;return!0}function io(i,e){let t=!1;for(let n of e)oi(i,n)&1&&(t=!0);return t}function Gm(i,e,t){let n=t.map(a=>i[a.id]),s=t.map(a=>a.type),r=n.filter(a=>!(a&1)),o=i[e.id]>>1;function l(a){let c=[];for(let h=0;h<n.length;h++){let u=$s(a,n[h]);if(s[h]==2)for(let f of u)c.push(f);else c.push(u)}return e.combine(c)}return{create(a){for(let c of n)oi(a,c);return a.values[o]=l(a),1},update(a,c){if(!io(a,r))return 0;let h=l(a);return e.compare(h,a.values[o])?0:(a.values[o]=h,1)},reconfigure(a,c){let h=io(a,n),u=c.config.facets[e.id],f=c.facet(e);if(u&&!h&&il(t,u))return a.values[o]=f,0;let d=l(a);return e.compare(d,f)?(a.values[o]=f,0):(a.values[o]=d,1)}}}const Da=D.define({static:!0});class Fe{constructor(e,t,n,s,r){this.id=e,this.createF=t,this.updateF=n,this.compareF=s,this.spec=r,this.provides=void 0}static define(e){let t=new Fe(nl++,e.create,e.update,e.compare||((n,s)=>n===s),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(Da).find(n=>n.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:n=>(n.values[t]=this.create(n),1),update:(n,s)=>{let r=n.values[t],o=this.updateF(r,s);return this.compareF(r,o)?0:(n.values[t]=o,1)},reconfigure:(n,s)=>s.config.address[this.id]!=null?(n.values[t]=s.field(this),0):(n.values[t]=this.create(n),1)}}init(e){return[this,Da.of({field:this,create:e})]}get extension(){return this}}const Xt={lowest:4,low:3,default:2,high:1,highest:0};function zn(i){return e=>new Ou(e,i)}const In={highest:zn(Xt.highest),high:zn(Xt.high),default:zn(Xt.default),low:zn(Xt.low),lowest:zn(Xt.lowest)};class Ou{constructor(e,t){this.inner=e,this.prec=t}}class Fn{of(e){return new so(this,e)}reconfigure(e){return Fn.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class so{constructor(e,t){this.compartment=e,this.inner=t}}class Ms{constructor(e,t,n,s,r,o){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=s,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,n){let s=[],r=Object.create(null),o=new Map;for(let f of Km(e,t,o))f instanceof Fe?s.push(f):(r[f.facet.id]||(r[f.facet.id]=[])).push(f);let l=Object.create(null),a=[],c=[];for(let f of s)l[f.id]=c.length<<1,c.push(d=>f.slot(d));let h=n==null?void 0:n.config.facets;for(let f in r){let d=r[f],p=d[0].facet,m=h&&h[f]||[];if(d.every(b=>b.type==0))if(l[p.id]=a.length<<1|1,il(m,d))a.push(n.facet(p));else{let b=p.combine(d.map(y=>y.value));a.push(n&&p.compare(b,n.facet(p))?n.facet(p):b)}else{for(let b of d)b.type==0?(l[b.id]=a.length<<1|1,a.push(b.value)):(l[b.id]=c.length<<1,c.push(y=>b.dynamicSlot(y)));l[p.id]=c.length<<1,c.push(b=>Gm(b,p,d))}}let u=c.map(f=>f(l));return new Ms(e,o,u,l,a,r)}}function Km(i,e,t){let n=[[],[],[],[],[]],s=new Map;function r(o,l){let a=s.get(o);if(a!=null){if(a<=l)return;let c=n[a].indexOf(o);c>-1&&n[a].splice(c,1),o instanceof so&&t.delete(o.compartment)}if(s.set(o,l),Array.isArray(o))for(let c of o)r(c,l);else if(o instanceof so){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(o.compartment)||o.inner;t.set(o.compartment,c),r(c,l)}else if(o instanceof Ou)r(o.inner,o.prec);else if(o instanceof Fe)n[l].push(o),o.provides&&r(o.provides,l);else if(o instanceof vs)n[l].push(o),o.facet.extensions&&r(o.facet.extensions,Xt.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(c,l)}}return r(i,Xt.default),n.reduce((o,l)=>o.concat(l))}function oi(i,e){if(e&1)return 2;let t=e>>1,n=i.status[t];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;i.status[t]=4;let s=i.computeSlot(i,i.config.dynamicSlots[t]);return i.status[t]=2|s}function $s(i,e){return e&1?i.config.staticValues[e>>1]:i.values[e>>1]}const ku=D.define(),ro=D.define({combine:i=>i.some(e=>e),static:!0}),wu=D.define({combine:i=>i.length?i[0]:void 0,static:!0}),Su=D.define(),Cu=D.define(),_u=D.define(),Au=D.define({combine:i=>i.length?i[0]:!1});class on{constructor(e,t){this.type=e,this.value=t}static define(){return new Zm}}class Zm{of(e){return new on(this,e)}}class Jm{constructor(e){this.map=e}of(e){return new Y(this,e)}}class Y{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new Y(this.type,t)}is(e){return this.type==e}static define(e={}){return new Jm(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let s of e){let r=s.map(t);r&&n.push(r)}return n}}Y.reconfigure=Y.define();Y.appendConfig=Y.define();class ve{constructor(e,t,n,s,r,o){this.startState=e,this.changes=t,this.selection=n,this.effects=s,this.annotations=r,this.scrollIntoView=o,this._doc=null,this._state=null,n&&xu(n,t.newLength),r.some(l=>l.type==ve.time)||(this.annotations=r.concat(ve.time.of(Date.now())))}static create(e,t,n,s,r,o){return new ve(e,t,n,s,r,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(ve.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}ve.time=on.define();ve.userEvent=on.define();ve.addToHistory=on.define();ve.remote=on.define();function e0(i,e){let t=[];for(let n=0,s=0;;){let r,o;if(n<i.length&&(s==e.length||e[s]>=i[n]))r=i[n++],o=i[n++];else if(s<e.length)r=e[s++],o=e[s++];else return t;!t.length||t[t.length-1]<r?t.push(r,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function Pu(i,e,t){var n;let s,r,o;return t?(s=e.changes,r=pe.empty(e.changes.length),o=i.changes.compose(e.changes)):(s=e.changes.map(i.changes),r=i.changes.mapDesc(e.changes,!0),o=i.changes.compose(s)),{changes:o,selection:e.selection?e.selection.map(r):(n=i.selection)===null||n===void 0?void 0:n.map(s),effects:Y.mapEffects(i.effects,s).concat(Y.mapEffects(e.effects,r)),annotations:i.annotations.length?i.annotations.concat(e.annotations):e.annotations,scrollIntoView:i.scrollIntoView||e.scrollIntoView}}function oo(i,e,t){let n=e.selection,s=yn(e.annotations);return e.userEvent&&(s=s.concat(ve.userEvent.of(e.userEvent))),{changes:e.changes instanceof pe?e.changes:pe.of(e.changes||[],t,i.facet(wu)),selection:n&&(n instanceof C?n:C.single(n.anchor,n.head)),effects:yn(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function Eu(i,e,t){let n=oo(i,e.length?e[0]:{},i.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let r=1;r<e.length;r++){e[r].filter===!1&&(t=!1);let o=!!e[r].sequential;n=Pu(n,oo(i,e[r],o?n.changes.newLength:i.doc.length),o)}let s=ve.create(i,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return n0(t?t0(s):s)}function t0(i){let e=i.startState,t=!0;for(let s of e.facet(Su)){let r=s(i);if(r===!1){t=!1;break}Array.isArray(r)&&(t=t===!0?r:e0(t,r))}if(t!==!0){let s,r;if(t===!1)r=i.changes.invertedDesc,s=pe.empty(e.doc.length);else{let o=i.changes.filter(t);s=o.changes,r=o.filtered.mapDesc(o.changes).invertedDesc}i=ve.create(e,s,i.selection&&i.selection.map(r),Y.mapEffects(i.effects,r),i.annotations,i.scrollIntoView)}let n=e.facet(Cu);for(let s=n.length-1;s>=0;s--){let r=n[s](i);r instanceof ve?i=r:Array.isArray(r)&&r.length==1&&r[0]instanceof ve?i=r[0]:i=Eu(e,yn(r),!1)}return i}function n0(i){let e=i.startState,t=e.facet(_u),n=i;for(let s=t.length-1;s>=0;s--){let r=t[s](i);r&&Object.keys(r).length&&(n=Pu(n,oo(e,r,i.changes.newLength),!0))}return n==i?i:ve.create(e,i.changes,i.selection,n.effects,n.annotations,n.scrollIntoView)}const i0=[];function yn(i){return i==null?i0:Array.isArray(i)?i:[i]}var Ve=function(i){return i[i.Word=0]="Word",i[i.Space=1]="Space",i[i.Other=2]="Other",i}(Ve||(Ve={}));const s0=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let lo;try{lo=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function r0(i){if(lo)return lo.test(i);for(let e=0;e<i.length;e++){let t=i[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||s0.test(t)))return!0}return!1}function o0(i){return e=>{if(!/\S/.test(e))return Ve.Space;if(r0(e))return Ve.Word;for(let t=0;t<i.length;t++)if(e.indexOf(i[t])>-1)return Ve.Word;return Ve.Other}}class W{constructor(e,t,n,s,r,o){this.config=e,this.doc=t,this.selection=n,this.values=s,this.status=e.statusTemplate.slice(),this.computeSlot=r,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)oi(this,l<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(n==null){if(t)throw new RangeError("Field is not present in this state");return}return oi(this,n),$s(this,n)}update(...e){return Eu(this,e,!0)}applyTransaction(e){let t=this.config,{base:n,compartments:s}=t;for(let l of e.effects)l.is(Fn.reconfigure)?(t&&(s=new Map,t.compartments.forEach((a,c)=>s.set(c,a)),t=null),s.set(l.value.compartment,l.value.extension)):l.is(Y.reconfigure)?(t=null,n=l.value):l.is(Y.appendConfig)&&(t=null,n=yn(n).concat(l.value));let r;t?r=e.startState.values.slice():(t=Ms.resolve(n,s,this),r=new W(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(a,c)=>c.reconfigure(a,this),null).values);let o=e.startState.facet(ro)?e.newSelection:e.newSelection.asSingle();new W(t,e.newDoc,o,r,(l,a)=>a.update(l,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:C.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),s=this.changes(n.changes),r=[n.range],o=yn(n.effects);for(let l=1;l<t.ranges.length;l++){let a=e(t.ranges[l]),c=this.changes(a.changes),h=c.map(s);for(let f=0;f<l;f++)r[f]=r[f].map(h);let u=s.mapDesc(c,!0);r.push(a.range.map(u)),s=s.compose(h),o=Y.mapEffects(o,h).concat(Y.mapEffects(yn(a.effects),u))}return{changes:s,selection:C.create(r,t.mainIndex),effects:o}}changes(e=[]){return e instanceof pe?e:pe.of(e,this.doc.length,this.facet(W.lineSeparator))}toText(e){return j.of(e.split(this.facet(W.lineSeparator)||eo))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(oi(this,t),$s(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let s=e[n];s instanceof Fe&&this.config.address[s.id]!=null&&(t[n]=s.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(e,t={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(n){for(let r in n)if(Object.prototype.hasOwnProperty.call(e,r)){let o=n[r],l=e[r];s.push(o.init(a=>o.spec.fromJSON(l,a)))}}return W.create({doc:e.doc,selection:C.fromJSON(e.selection),extensions:t.extensions?s.concat([t.extensions]):s})}static create(e={}){let t=Ms.resolve(e.extensions||[],new Map),n=e.doc instanceof j?e.doc:j.of((e.doc||"").split(t.staticFacet(W.lineSeparator)||eo)),s=e.selection?e.selection instanceof C?e.selection:C.single(e.selection.anchor,e.selection.head):C.single(0);return xu(s,n.length),t.staticFacet(ro)||(s=s.asSingle()),new W(t,n,s,t.dynamicSlots.map(()=>null),(r,o)=>o.create(r),null)}get tabSize(){return this.facet(W.tabSize)}get lineBreak(){return this.facet(W.lineSeparator)||`
`}get readOnly(){return this.facet(Au)}phrase(e,...t){for(let n of this.facet(W.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(n,s)=>{if(s=="$")return"$";let r=+(s||1);return!r||r>t.length?n:t[r-1]})),e}languageDataAt(e,t,n=-1){let s=[];for(let r of this.facet(ku))for(let o of r(this,t,n))Object.prototype.hasOwnProperty.call(o,e)&&s.push(o[e]);return s}charCategorizer(e){return o0(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:n,length:s}=this.doc.lineAt(e),r=this.charCategorizer(e),o=e-n,l=e-n;for(;o>0;){let a=_e(t,o,!1);if(r(t.slice(a,o))!=Ve.Word)break;o=a}for(;l<s;){let a=_e(t,l);if(r(t.slice(l,a))!=Ve.Word)break;l=a}return o==l?null:C.range(o+n,l+n)}}W.allowMultipleSelections=ro;W.tabSize=D.define({combine:i=>i.length?i[0]:4});W.lineSeparator=wu;W.readOnly=Au;W.phrases=D.define({compare(i,e){let t=Object.keys(i),n=Object.keys(e);return t.length==n.length&&t.every(s=>i[s]==e[s])}});W.languageData=ku;W.changeFilter=Su;W.transactionFilter=Cu;W.transactionExtender=_u;Fn.reconfigure=Y.define();function nr(i,e,t={}){let n={};for(let s of i)for(let r of Object.keys(s)){let o=s[r],l=n[r];if(l===void 0)n[r]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(t,r))n[r]=t[r](l,o);else throw new Error("Config merge conflict for field "+r)}for(let s in e)n[s]===void 0&&(n[s]=e[s]);return n}class Zt{eq(e){return this==e}range(e,t=e){return vi.create(e,t,this)}}Zt.prototype.startSide=Zt.prototype.endSide=0;Zt.prototype.point=!1;Zt.prototype.mapMode=ye.TrackDel;class vi{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(e,t,n){return new vi(e,t,n)}}function ao(i,e){return i.from-e.from||i.value.startSide-e.value.startSide}class sl{constructor(e,t,n,s){this.from=e,this.to=t,this.value=n,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,s=0){let r=n?this.to:this.from;for(let o=s,l=r.length;;){if(o==l)return o;let a=o+l>>1,c=r[a]-e||(n?this.value[a].endSide:this.value[a].startSide)-t;if(a==o)return c>=0?o:l;c>=0?l=a:o=a+1}}between(e,t,n,s){for(let r=this.findIndex(t,-1e9,!0),o=this.findIndex(n,1e9,!1,r);r<o;r++)if(s(this.from[r]+e,this.to[r]+e,this.value[r])===!1)return!1}map(e,t){let n=[],s=[],r=[],o=-1,l=-1;for(let a=0;a<this.value.length;a++){let c=this.value[a],h=this.from[a]+e,u=this.to[a]+e,f,d;if(h==u){let p=t.mapPos(h,c.startSide,c.mapMode);if(p==null||(f=d=p,c.startSide!=c.endSide&&(d=t.mapPos(h,c.endSide),d<f)))continue}else if(f=t.mapPos(h,c.startSide),d=t.mapPos(u,c.endSide),f>d||f==d&&c.startSide>0&&c.endSide<=0)continue;(d-f||c.endSide-c.startSide)<0||(o<0&&(o=f),c.point&&(l=Math.max(l,d-f)),n.push(c),s.push(f-o),r.push(d-o))}return{mapped:n.length?new sl(s,r,n,l):null,pos:o}}}class K{constructor(e,t,n,s){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=s}static create(e,t,n,s){return new K(e,t,n,s)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:s=0,filterTo:r=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(n&&(t=t.slice().sort(ao)),this.isEmpty)return t.length?K.of(t):this;let l=new Tu(this,null,-1).goto(0),a=0,c=[],h=new xi;for(;l.value||a<t.length;)if(a<t.length&&(l.from-t[a].from||l.startSide-t[a].value.startSide)>=0){let u=t[a++];h.addInner(u.from,u.to,u.value)||c.push(u)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(l.chunkIndex)<t[a].from)&&(!o||s>this.chunkEnd(l.chunkIndex)||r<this.chunkPos[l.chunkIndex])&&h.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||s>l.to||r<l.from||o(l.from,l.to,l.value))&&(h.addInner(l.from,l.to,l.value)||c.push(vi.create(l.from,l.to,l.value))),l.next());return h.finishInner(this.nextLayer.isEmpty&&!c.length?K.empty:this.nextLayer.update({add:c,filter:o,filterFrom:s,filterTo:r}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],s=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],a=this.chunk[o],c=e.touchesRange(l,l+a.length);if(c===!1)s=Math.max(s,a.maxPoint),t.push(a),n.push(e.mapPos(l));else if(c===!0){let{mapped:h,pos:u}=a.map(l,e);h&&(s=Math.max(s,h.maxPoint),t.push(h),n.push(u))}}let r=this.nextLayer.map(e);return t.length==0?r:new K(n,t,r||K.empty,s)}between(e,t,n){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let r=this.chunkPos[s],o=this.chunk[s];if(t>=r&&e<=r+o.length&&o.between(r,e-r,t-r,n)===!1)return}this.nextLayer.between(e,t,n)}}iter(e=0){return Oi.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Oi.from(e).goto(t)}static compare(e,t,n,s,r=-1){let o=e.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=r),l=t.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=r),a=Ba(o,l,n),c=new Xn(o,a,r),h=new Xn(l,a,r);n.iterGaps((u,f,d)=>La(c,u,h,f,d,s)),n.empty&&n.length==0&&La(c,0,h,0,0,s)}static eq(e,t,n=0,s){s==null&&(s=999999999);let r=e.filter(h=>!h.isEmpty&&t.indexOf(h)<0),o=t.filter(h=>!h.isEmpty&&e.indexOf(h)<0);if(r.length!=o.length)return!1;if(!r.length)return!0;let l=Ba(r,o),a=new Xn(r,l,0).goto(n),c=new Xn(o,l,0).goto(n);for(;;){if(a.to!=c.to||!co(a.active,c.active)||a.point&&(!c.point||!a.point.eq(c.point)))return!1;if(a.to>s)return!0;a.next(),c.next()}}static spans(e,t,n,s,r=-1){let o=new Xn(e,null,r).goto(t),l=t,a=o.openStart;for(;;){let c=Math.min(o.to,n);if(o.point){let h=o.activeForPoint(o.to),u=o.pointFrom<t?h.length+1:o.point.startSide<0?h.length:Math.min(h.length,a);s.point(l,c,o.point,h,u,o.pointRank),a=Math.min(o.openEnd(c),h.length)}else c>l&&(s.span(l,c,o.active,a),a=o.openEnd(c));if(o.to>n)return a+(o.point&&o.to>n?1:0);l=o.to,o.next()}}static of(e,t=!1){let n=new xi;for(let s of e instanceof vi?[e]:t?l0(e):e)n.add(s.from,s.to,s.value);return n.finish()}static join(e){if(!e.length)return K.empty;let t=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let s=e[n];s!=K.empty;s=s.nextLayer)t=new K(s.chunkPos,s.chunk,t,Math.max(s.maxPoint,t.maxPoint));return t}}K.empty=new K([],[],null,-1);function l0(i){if(i.length>1)for(let e=i[0],t=1;t<i.length;t++){let n=i[t];if(ao(e,n)>0)return i.slice().sort(ao);e=n}return i}K.empty.nextLayer=K.empty;class xi{finishChunk(e){this.chunks.push(new sl(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new xi)).add(e,t,n)}addInner(e,t,n){let s=e-this.lastTo||n.startSide-this.last.endSide;if(s<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(K.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=K.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Ba(i,e,t){let n=new Map;for(let r of i)for(let o=0;o<r.chunk.length;o++)r.chunk[o].maxPoint<=0&&n.set(r.chunk[o],r.chunkPos[o]);let s=new Set;for(let r of e)for(let o=0;o<r.chunk.length;o++){let l=n.get(r.chunk[o]);l!=null&&(t?t.mapPos(l):l)==r.chunkPos[o]&&!(t!=null&&t.touchesRange(l,l+r.chunk[o].length))&&s.add(r.chunk[o])}return s}class Tu{constructor(e,t,n,s=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<e||s.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Oi{constructor(e){this.heap=e}static from(e,t=null,n=-1){let s=[];for(let r=0;r<e.length;r++)for(let o=e[r];!o.isEmpty;o=o.nextLayer)o.maxPoint>=n&&s.push(new Tu(o,t,n,r));return s.length==1?s[0]:new Oi(s)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let n=this.heap.length>>1;n>=0;n--)xr(this.heap,n);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let n=this.heap.length>>1;n>=0;n--)xr(this.heap,n);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),xr(this.heap,0)}}}function xr(i,e){for(let t=i[e];;){let n=(e<<1)+1;if(n>=i.length)break;let s=i[n];if(n+1<i.length&&s.compare(i[n+1])>=0&&(s=i[n+1],n++),t.compare(s)<0)break;i[n]=t,i[e]=s,e=n}}class Xn{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Oi.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Wi(this.active,e),Wi(this.activeTo,e),Wi(this.activeRank,e),this.minActive=Ia(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:s,rank:r}=this.cursor;for(;t<this.activeRank.length&&(r-this.activeRank[t]||s-this.activeTo[t])>0;)t++;ji(this.active,t,n),ji(this.activeTo,t,s),ji(this.activeRank,t,r),e&&ji(e,t,this.cursor.from),this.minActive=Ia(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),n&&Wi(n,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let r=this.cursor.value;if(!r.point)this.addActive(n),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let s=n.length-1;s>=0&&n[s]<e;s--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}}function La(i,e,t,n,s,r){i.goto(e),t.goto(n);let o=n+s,l=n,a=n-e;for(;;){let c=i.to+a-t.to||i.endSide-t.endSide,h=c<0?i.to+a:t.to,u=Math.min(h,o);if(i.point||t.point?i.point&&t.point&&(i.point==t.point||i.point.eq(t.point))&&co(i.activeForPoint(i.to),t.activeForPoint(t.to))||r.comparePoint(l,u,i.point,t.point):u>l&&!co(i.active,t.active)&&r.compareRange(l,u,i.active,t.active),h>o)break;l=h,c<=0&&i.next(),c>=0&&t.next()}}function co(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!=e[t]&&!i[t].eq(e[t]))return!1;return!0}function Wi(i,e){for(let t=e,n=i.length-1;t<n;t++)i[t]=i[t+1];i.pop()}function ji(i,e,t){for(let n=i.length-1;n>=e;n--)i[n+1]=i[n];i[e]=t}function Ia(i,e){let t=-1,n=1e9;for(let s=0;s<e.length;s++)(e[s]-n||i[s].endSide-i[t].endSide)<0&&(t=s,n=e[s]);return t}function ir(i,e,t=i.length){let n=0;for(let s=0;s<t;)i.charCodeAt(s)==9?(n+=e-n%e,s++):(n++,s=_e(i,s));return n}function a0(i,e,t,n){for(let s=0,r=0;;){if(r>=e)return s;if(s==i.length)break;r+=i.charCodeAt(s)==9?t-r%t:1,s=_e(i,s)}return n===!0?-1:i.length}const ho="",Fa=typeof Symbol>"u"?"__"+ho:Symbol.for(ho),uo=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Na=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Dt{constructor(e,t){this.rules=[];let{finish:n}=t||{};function s(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function r(o,l,a,c){let h=[],u=/^@(\w+)\b/.exec(o[0]),f=u&&u[1]=="keyframes";if(u&&l==null)return a.push(o[0]+";");for(let d in l){let p=l[d];if(/&/.test(d))r(d.split(/,\s*/).map(m=>o.map(b=>m.replace(/&/,b))).reduce((m,b)=>m.concat(b)),p,a);else if(p&&typeof p=="object"){if(!u)throw new RangeError("The value of a property ("+d+") should be a primitive value.");r(s(d),p,h,f)}else p!=null&&h.push(d.replace(/_.*/,"").replace(/[A-Z]/g,m=>"-"+m.toLowerCase())+": "+p+";")}(h.length||f)&&a.push((n&&!u&&!c?o.map(n):o).join(", ")+" {"+h.join(" ")+"}")}for(let o in e)r(s(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=Na[Fa]||1;return Na[Fa]=e+1,ho+e.toString(36)}static mount(e,t,n){let s=e[uo],r=n&&n.nonce;s?r&&s.setNonce(r):s=new c0(e,r),s.mount(Array.isArray(t)?t:[t],e)}}let qa=new Map;class c0{constructor(e,t){let n=e.ownerDocument||e,s=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&s.CSSStyleSheet){let r=qa.get(n);if(r)return e[uo]=r;this.sheet=new s.CSSStyleSheet,qa.set(n,this)}else this.styleTag=n.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[uo]=this}mount(e,t){let n=this.sheet,s=0,r=0;for(let o=0;o<e.length;o++){let l=e[o],a=this.modules.indexOf(l);if(a<r&&a>-1&&(this.modules.splice(a,1),r--,a=-1),a==-1){if(this.modules.splice(r++,0,l),n)for(let c=0;c<l.rules.length;c++)n.insertRule(l.rules[c],s++)}else{for(;r<a;)s+=this.modules[r++].rules.length;s+=l.rules.length,r++}}if(n)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let a=0;a<this.modules.length;a++)o+=this.modules[a].getRules()+`
`;this.styleTag.textContent=o;let l=t.head||t;this.styleTag.parentNode!=l&&l.insertBefore(this.styleTag,l.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Bt={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},ki={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},h0=typeof navigator<"u"&&/Mac/.test(navigator.platform),u0=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var be=0;be<10;be++)Bt[48+be]=Bt[96+be]=String(be);for(var be=1;be<=24;be++)Bt[be+111]="F"+be;for(var be=65;be<=90;be++)Bt[be]=String.fromCharCode(be+32),ki[be]=String.fromCharCode(be);for(var Or in Bt)ki.hasOwnProperty(Or)||(ki[Or]=Bt[Or]);function f0(i){var e=h0&&i.metaKey&&i.shiftKey&&!i.ctrlKey&&!i.altKey||u0&&i.shiftKey&&i.key&&i.key.length==1||i.key=="Unidentified",t=!e&&i.key||(i.shiftKey?ki:Bt)[i.keyCode]||i.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function wi(i){let e;return i.nodeType==11?e=i.getSelection?i:i.ownerDocument:e=i,e.getSelection()}function fo(i,e){return e?i==e||i.contains(e.nodeType!=1?e.parentNode:e):!1}function xs(i,e){if(!e.anchorNode)return!1;try{return fo(i,e.anchorNode)}catch{return!1}}function An(i){return i.nodeType==3?en(i,0,i.nodeValue.length).getClientRects():i.nodeType==1?i.getClientRects():[]}function li(i,e,t,n){return t?Qa(i,e,t,n,-1)||Qa(i,e,t,n,1):!1}function Jt(i){for(var e=0;;e++)if(i=i.previousSibling,!i)return e}function Ds(i){return i.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(i.nodeName)}function Qa(i,e,t,n,s){for(;;){if(i==t&&e==n)return!0;if(e==(s<0?0:ft(i))){if(i.nodeName=="DIV")return!1;let r=i.parentNode;if(!r||r.nodeType!=1)return!1;e=Jt(i)+(s<0?0:1),i=r}else if(i.nodeType==1){if(i=i.childNodes[e+(s<0?-1:0)],i.nodeType==1&&i.contentEditable=="false")return!1;e=s<0?ft(i):0}else return!1}}function ft(i){return i.nodeType==3?i.nodeValue.length:i.childNodes.length}function Mi(i,e){let t=e?i.left:i.right;return{left:t,right:t,top:i.top,bottom:i.bottom}}function d0(i){let e=i.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:i.innerWidth,top:0,bottom:i.innerHeight}}function Ru(i,e){let t=e.width/i.offsetWidth,n=e.height/i.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-i.offsetWidth)<1)&&(t=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-i.offsetHeight)<1)&&(n=1),{scaleX:t,scaleY:n}}function p0(i,e,t,n,s,r,o,l){let a=i.ownerDocument,c=a.defaultView||window;for(let h=i,u=!1;h&&!u;)if(h.nodeType==1){let f,d=h==a.body,p=1,m=1;if(d)f=d0(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(u=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let v=h.getBoundingClientRect();({scaleX:p,scaleY:m}=Ru(h,v)),f={left:v.left,right:v.left+h.clientWidth*p,top:v.top,bottom:v.top+h.clientHeight*m}}let b=0,y=0;if(s=="nearest")e.top<f.top?(y=-(f.top-e.top+o),t>0&&e.bottom>f.bottom+y&&(y=e.bottom-f.bottom+y+o)):e.bottom>f.bottom&&(y=e.bottom-f.bottom+o,t<0&&e.top-y<f.top&&(y=-(f.top+y-e.top+o)));else{let v=e.bottom-e.top,x=f.bottom-f.top;y=(s=="center"&&v<=x?e.top+v/2-x/2:s=="start"||s=="center"&&t<0?e.top-o:e.bottom-x+o)-f.top}if(n=="nearest"?e.left<f.left?(b=-(f.left-e.left+r),t>0&&e.right>f.right+b&&(b=e.right-f.right+b+r)):e.right>f.right&&(b=e.right-f.right+r,t<0&&e.left<f.left+b&&(b=-(f.left+b-e.left+r))):b=(n=="center"?e.left+(e.right-e.left)/2-(f.right-f.left)/2:n=="start"==l?e.left-r:e.right-(f.right-f.left)+r)-f.left,b||y)if(d)c.scrollBy(b,y);else{let v=0,x=0;if(y){let w=h.scrollTop;h.scrollTop+=y/m,x=(h.scrollTop-w)*m}if(b){let w=h.scrollLeft;h.scrollLeft+=b/p,v=(h.scrollLeft-w)*p}e={left:e.left-v,top:e.top-x,right:e.right-v,bottom:e.bottom-x},v&&Math.abs(v-b)<1&&(n="nearest"),x&&Math.abs(x-y)<1&&(s="nearest")}if(d)break;h=h.assignedSlot||h.parentNode}else if(h.nodeType==11)h=h.host;else break}function g0(i){let e=i.ownerDocument,t,n;for(let s=i.parentNode;s&&!(s==e.body||t&&n);)if(s.nodeType==1)!n&&s.scrollHeight>s.clientHeight&&(n=s),!t&&s.scrollWidth>s.clientWidth&&(t=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:t,y:n}}class m0{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?ft(t):0),n,Math.min(e.focusOffset,n?ft(n):0))}set(e,t,n,s){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=s}}let an=null;function Mu(i){if(i.setActive)return i.setActive();if(an)return i.focus(an);let e=[];for(let t=i;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(i.focus(an==null?{get preventScroll(){return an={preventScroll:!0},!0}}:void 0),!an){an=!1;for(let t=0;t<e.length;){let n=e[t++],s=e[t++],r=e[t++];n.scrollTop!=s&&(n.scrollTop=s),n.scrollLeft!=r&&(n.scrollLeft=r)}}}let Ha;function en(i,e,t=e){let n=Ha||(Ha=document.createRange());return n.setEnd(i,t),n.setStart(i,e),n}function vn(i,e,t,n){let s={key:e,code:e,keyCode:t,which:t,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let r=new KeyboardEvent("keydown",s);r.synthetic=!0,i.dispatchEvent(r);let o=new KeyboardEvent("keyup",s);return o.synthetic=!0,i.dispatchEvent(o),r.defaultPrevented||o.defaultPrevented}function b0(i){for(;i;){if(i&&(i.nodeType==9||i.nodeType==11&&i.host))return i;i=i.assignedSlot||i.parentNode}return null}function $u(i){for(;i.attributes.length;)i.removeAttributeNode(i.attributes[0])}function y0(i,e){let t=e.focusNode,n=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=n)return!1;for(n=Math.min(n,ft(t));;)if(n){if(t.nodeType!=1)return!1;let s=t.childNodes[n-1];s.contentEditable=="false"?n--:(t=s,n=ft(t))}else{if(t==i)return!0;n=Jt(t),t=t.parentNode}}function Du(i){return i.scrollTop>Math.max(1,i.scrollHeight-i.clientHeight-4)}function Bu(i,e){for(let t=i,n=e;;){if(t.nodeType==3&&n>0)return{node:t,offset:n};if(t.nodeType==1&&n>0){if(t.contentEditable=="false")return null;t=t.childNodes[n-1],n=ft(t)}else if(t.parentNode&&!Ds(t))n=Jt(t),t=t.parentNode;else return null}}function Lu(i,e){for(let t=i,n=e;;){if(t.nodeType==3&&n<t.nodeValue.length)return{node:t,offset:n};if(t.nodeType==1&&n<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[n],n=0}else if(t.parentNode&&!Ds(t))n=Jt(t)+1,t=t.parentNode;else return null}}class we{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new we(e.parentNode,Jt(e),t)}static after(e,t){return new we(e.parentNode,Jt(e)+1,t)}}const rl=[];class te{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let n=this.dom,s=null,r;for(let o of this.children){if(o.flags&7){if(!o.dom&&(r=s?s.nextSibling:n.firstChild)){let l=te.get(r);(!l||!l.parent&&l.canReuseDOM(o))&&o.reuseDOM(r)}o.sync(e,t),o.flags&=-8}if(r=s?s.nextSibling:n.firstChild,t&&!t.written&&t.node==n&&r!=o.dom&&(t.written=!0),o.dom.parentNode==n)for(;r&&r!=o.dom;)r=Va(r);else n.insertBefore(o.dom,r);s=o.dom}for(r=s?s.nextSibling:n.firstChild,r&&t&&t.node==n&&(t.written=!0);r;)r=Va(r)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,t),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let s=ft(e)==0?0:t==0?-1:1;for(;;){let r=e.parentNode;if(r==this.dom)break;s==0&&r.firstChild!=r.lastChild&&(e==r.firstChild?s=-1:s=1),e=r}s<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!te.get(n);)n=n.nextSibling;if(!n)return this.length;for(let s=0,r=0;;s++){let o=this.children[s];if(o.dom==n)return r;r+=o.length+o.breakAfter}}domBoundsAround(e,t,n=0){let s=-1,r=-1,o=-1,l=-1;for(let a=0,c=n,h=n;a<this.children.length;a++){let u=this.children[a],f=c+u.length;if(c<e&&f>t)return u.domBoundsAround(e,t,c);if(f>=e&&s==-1&&(s=a,r=c),c>t&&u.dom.parentNode==this.dom){o=a,l=h;break}h=f,c=f+u.breakAfter}return{from:r,to:l<0?n+this.length:l,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=rl){this.markDirty();for(let s=e;s<t;s++){let r=this.children[s];r.parent==this&&n.indexOf(r)<0&&r.destroy()}n.length<250?this.children.splice(e,t-e,...n):this.children=[].concat(this.children.slice(0,e),n,this.children.slice(t));for(let s=0;s<n.length;s++)n[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Iu(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,s,r,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}te.prototype.breakAfter=0;function Va(i){let e=i.nextSibling;return i.parentNode.removeChild(i),e}class Iu{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function Fu(i,e,t,n,s,r,o,l,a){let{children:c}=i,h=c.length?c[e]:null,u=r.length?r[r.length-1]:null,f=u?u.breakAfter:o;if(!(e==n&&h&&!o&&!f&&r.length<2&&h.merge(t,s,r.length?u:null,t==0,l,a))){if(n<c.length){let d=c[n];d&&(s<d.length||d.breakAfter&&(u!=null&&u.breakAfter))?(e==n&&(d=d.split(s),s=0),!f&&u&&d.merge(0,s,u,!0,0,a)?r[r.length-1]=d:((s||d.children.length&&!d.children[0].length)&&d.merge(0,s,null,!1,0,a),r.push(d))):d!=null&&d.breakAfter&&(u?u.breakAfter=1:o=1),n++}for(h&&(h.breakAfter=o,t>0&&(!o&&r.length&&h.merge(t,h.length,r[0],!1,l,0)?h.breakAfter=r.shift().breakAfter:(t<h.length||h.children.length&&h.children[h.children.length-1].length==0)&&h.merge(t,h.length,null,!1,l,0),e++));e<n&&r.length;)if(c[n-1].become(r[r.length-1]))n--,r.pop(),a=r.length?0:l;else if(c[e].become(r[0]))e++,r.shift(),l=r.length?0:a;else break;!r.length&&e&&n<c.length&&!c[e-1].breakAfter&&c[n].merge(0,0,c[e-1],!1,l,a)&&e--,(e<n||r.length)&&i.replaceChildren(e,n,r)}}function Nu(i,e,t,n,s,r){let o=i.childCursor(),{i:l,off:a}=o.findPos(t,1),{i:c,off:h}=o.findPos(e,-1),u=e-t;for(let f of n)u+=f.length;i.length+=u,Fu(i,c,h,l,a,n,0,s,r)}let Ee=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},po=typeof document<"u"?document:{documentElement:{style:{}}};const go=/Edge\/(\d+)/.exec(Ee.userAgent),qu=/MSIE \d/.test(Ee.userAgent),mo=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ee.userAgent),sr=!!(qu||mo||go),za=!sr&&/gecko\/(\d+)/i.test(Ee.userAgent),kr=!sr&&/Chrome\/(\d+)/.exec(Ee.userAgent),v0="webkitFontSmoothing"in po.documentElement.style,Qu=!sr&&/Apple Computer/.test(Ee.vendor),Xa=Qu&&(/Mobile\/\w+/.test(Ee.userAgent)||Ee.maxTouchPoints>2);var $={mac:Xa||/Mac/.test(Ee.platform),windows:/Win/.test(Ee.platform),linux:/Linux|X11/.test(Ee.platform),ie:sr,ie_version:qu?po.documentMode||6:mo?+mo[1]:go?+go[1]:0,gecko:za,gecko_version:za?+(/Firefox\/(\d+)/.exec(Ee.userAgent)||[0,0])[1]:0,chrome:!!kr,chrome_version:kr?+kr[1]:0,ios:Xa,android:/Android\b/.test(Ee.userAgent),safari:Qu,webkit_version:v0?+(/\bAppleWebKit\/(\d+)/.exec(Ee.userAgent)||[0,0])[1]:0,tabSize:po.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const x0=256;class Ke extends te{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,n){return this.flags&8||n&&(!(n instanceof Ke)||this.length-(t-e)+n.length>x0||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new Ke(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new we(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return O0(this.dom,e,t)}}class kt extends te{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let s of t)s.setParent(this)}setAttrs(e){if($u(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,s,r,o){return n&&(!(n instanceof kt&&n.mark.eq(this.mark))||e&&r<=0||t<this.length&&o<=0)?!1:(Nu(this,e,t,n?n.children.slice():[],r-1,o-1),this.markDirty(),!0)}split(e){let t=[],n=0,s=-1,r=0;for(let l of this.children){let a=n+l.length;a>e&&t.push(n<e?l.split(e-n):l),s<0&&n>=e&&(s=r),n=a,r++}let o=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new kt(this.mark,t,o)}domAtPos(e){return Hu(this,e)}coordsAt(e,t){return zu(this,e,t)}}function O0(i,e,t){let n=i.nodeValue.length;e>n&&(e=n);let s=e,r=e,o=0;e==0&&t<0||e==n&&t>=0?$.chrome||$.gecko||(e?(s--,o=1):r<n&&(r++,o=-1)):t<0?s--:r<n&&r++;let l=en(i,s,r).getClientRects();if(!l.length)return null;let a=l[(o?o<0:t>=0)?0:l.length-1];return $.safari&&!o&&a.width==0&&(a=Array.prototype.find.call(l,c=>c.width)||a),o?Mi(a,o<0):a||null}class Rt extends te{static create(e,t,n){return new Rt(e,t,n)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(e){let t=Rt.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,n,s,r,o){return n&&(!(n instanceof Rt)||!this.widget.compare(n.widget)||e>0&&r<=0||t<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e instanceof Rt&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return j.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,s=this.posAtStart;return n?n.slice(s,s+this.length):j.empty}domAtPos(e){return(this.length?e==0:this.side>0)?we.before(this.dom):we.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let s=this.dom.getClientRects(),r=null;if(!s.length)return null;let o=this.side?this.side<0:e>0;for(let l=o?s.length-1:0;r=s[l],!(e>0?l==0:l==s.length-1||r.top<r.bottom);l+=o?-1:1);return Mi(r,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Pn extends te{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Pn&&e.side==this.side}split(){return new Pn(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?we.before(this.dom):we.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return j.empty}get isHidden(){return!0}}Ke.prototype.children=Rt.prototype.children=Pn.prototype.children=rl;function Hu(i,e){let t=i.dom,{children:n}=i,s=0;for(let r=0;s<n.length;s++){let o=n[s],l=r+o.length;if(!(l==r&&o.getSide()<=0)){if(e>r&&e<l&&o.dom.parentNode==t)return o.domAtPos(e-r);if(e<=r)break;r=l}}for(let r=s;r>0;r--){let o=n[r-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let r=s;r<n.length;r++){let o=n[r];if(o.dom.parentNode==t)return o.domAtPos(0)}return new we(t,0)}function Vu(i,e,t){let n,{children:s}=i;t>0&&e instanceof kt&&s.length&&(n=s[s.length-1])instanceof kt&&n.mark.eq(e.mark)?Vu(n,e.children[0],t-1):(s.push(e),e.setParent(i)),i.length+=e.length}function zu(i,e,t){let n=null,s=-1,r=null,o=-1;function l(c,h){for(let u=0,f=0;u<c.children.length&&f<=h;u++){let d=c.children[u],p=f+d.length;p>=h&&(d.children.length?l(d,h-f):(!r||r.isHidden&&t>0)&&(p>h||f==p&&d.getSide()>0)?(r=d,o=h-f):(f<h||f==p&&d.getSide()<0&&!d.isHidden)&&(n=d,s=h-f)),f=p}}l(i,e);let a=(t<0?n:r)||n||r;return a?a.coordsAt(Math.max(0,a==n?s:o),t):k0(i)}function k0(i){let e=i.dom.lastChild;if(!e)return i.dom.getBoundingClientRect();let t=An(e);return t[t.length-1]||null}function bo(i,e){for(let t in i)t=="class"&&e.class?e.class+=" "+i.class:t=="style"&&e.style?e.style+=";"+i.style:e[t]=i[t];return e}const Wa=Object.create(null);function Bs(i,e,t){if(i==e)return!0;i||(i=Wa),e||(e=Wa);let n=Object.keys(i),s=Object.keys(e);if(n.length-(t&&n.indexOf(t)>-1?1:0)!=s.length-(t&&s.indexOf(t)>-1?1:0))return!1;for(let r of n)if(r!=t&&(s.indexOf(r)==-1||i[r]!==e[r]))return!1;return!0}function yo(i,e,t){let n=!1;if(e)for(let s in e)t&&s in t||(n=!0,s=="style"?i.style.cssText="":i.removeAttribute(s));if(t)for(let s in t)e&&e[s]==t[s]||(n=!0,s=="style"?i.style.cssText=t[s]:i.setAttribute(s,t[s]));return n}function w0(i){let e=Object.create(null);for(let t=0;t<i.attributes.length;t++){let n=i.attributes[t];e[n.name]=n.value}return e}class Nn{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Xe=function(i){return i[i.Text=0]="Text",i[i.WidgetBefore=1]="WidgetBefore",i[i.WidgetAfter=2]="WidgetAfter",i[i.WidgetRange=3]="WidgetRange",i}(Xe||(Xe={}));class V extends Zt{constructor(e,t,n,s){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=s}get heightRelevant(){return!1}static mark(e){return new $i(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new Lt(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,s;if(e.isBlockGap)n=-5e8,s=4e8;else{let{start:r,end:o}=Xu(e,t);n=(r?t?-3e8:-1:5e8)-1,s=(o?t?2e8:1:-6e8)+1}return new Lt(e,n,s,t,e.widget||null,!0)}static line(e){return new Di(e)}static set(e,t=!1){return K.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}V.none=K.empty;class $i extends V{constructor(e){let{start:t,end:n}=Xu(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,n;return this==e||e instanceof $i&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&Bs(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}$i.prototype.point=!1;class Di extends V{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Di&&this.spec.class==e.spec.class&&Bs(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Di.prototype.mapMode=ye.TrackBefore;Di.prototype.point=!0;class Lt extends V{constructor(e,t,n,s,r,o){super(t,n,r,e),this.block=s,this.isReplace=o,this.mapMode=s?t<=0?ye.TrackBefore:ye.TrackAfter:ye.TrackDel}get type(){return this.startSide!=this.endSide?Xe.WidgetRange:this.startSide<=0?Xe.WidgetBefore:Xe.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Lt&&S0(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Lt.prototype.point=!0;function Xu(i,e=!1){let{inclusiveStart:t,inclusiveEnd:n}=i;return t==null&&(t=i.inclusive),n==null&&(n=i.inclusive),{start:t??e,end:n??e}}function S0(i,e){return i==e||!!(i&&e&&i.compare(e))}function vo(i,e,t,n=0){let s=t.length-1;s>=0&&t[s]+n>=i?t[s]=Math.max(t[s],e):t.push(i,e)}class he extends te{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,s,r,o){if(n){if(!(n instanceof he))return!1;this.dom||n.transferDOM(this)}return s&&this.setDeco(n?n.attrs:null),Nu(this,e,t,n?n.children.slice():[],r,o),!0}split(e){let t=new he;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:n,off:s}=this.childPos(e);s&&(t.append(this.children[n].split(s),0),this.children[n].merge(s,this.children[n].length,null,!1,0,0),n++);for(let r=n;r<this.children.length;r++)t.append(this.children[r],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Bs(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){Vu(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=bo(t,this.attrs||{})),n&&(this.attrs=bo({class:n},this.attrs||{}))}domAtPos(e){return Hu(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var n;this.dom?this.flags&4&&($u(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(yo(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let s=this.dom.lastChild;for(;s&&te.get(s)instanceof kt;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((n=te.get(s))===null||n===void 0?void 0:n.isEditable)==!1&&(!$.ios||!this.children.some(r=>r instanceof Ke))){let r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let n of this.children){if(!(n instanceof Ke)||/[^ -~]/.test(n.text))return null;let s=An(n.dom);if(s.length!=1)return null;e+=s[0].width,t=s[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let n=zu(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:s}=this.parent.view.viewState,r=n.bottom-n.top;if(Math.abs(r-s.lineHeight)<2&&s.textHeight<r){let o=(r-s.textHeight)/2;return{top:n.top+o,bottom:n.bottom-o,left:n.left,right:n.left}}}return n}become(e){return e instanceof he&&this.children.length==0&&e.children.length==0&&Bs(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let n=0,s=0;n<e.children.length;n++){let r=e.children[n],o=s+r.length;if(o>=t){if(r instanceof he)return r;if(o>t)break}s=o+r.breakAfter}return null}}class xt extends te{constructor(e,t,n){super(),this.widget=e,this.length=t,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,s,r,o){return n&&(!(n instanceof xt)||!this.widget.compare(n.widget)||e>0&&r<=0||t<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?we.before(this.dom):we.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new xt(this.widget,t,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return rl}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):j.empty}domBoundsAround(){return null}become(e){return e instanceof xt&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);return n||(this.widget instanceof xo?null:Mi(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:n}=this.deco;return t==n?!1:e<0?t<0:n>0}}class xo extends Nn{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class ai{constructor(e,t,n,s){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof xt&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new he),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Yi(new Pn(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof xt)&&this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:r,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=r,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(Yi(new Ke(this.text.slice(this.textOff,this.textOff+s)),t),n),this.atCursorPos=!0,this.textOff+=s,e-=s,n=0}}span(e,t,n,s){this.buildText(t-e,n,s),this.pos=t,this.openStart<0&&(this.openStart=s)}point(e,t,n,s,r,o){if(this.disallowBlockEffectsFor[o]&&n instanceof Lt){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=t-e;if(n instanceof Lt)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new xt(n.widget||En.block,l,n));else{let a=Rt.create(n.widget||En.inline,l,l?0:n.startSide),c=this.atCursorPos&&!a.isEditable&&r<=s.length&&(e<t||n.startSide>0),h=!a.isEditable&&(e<t||r>s.length||n.startSide<=0),u=this.getLine();this.pendingBuffer==2&&!c&&!a.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),c&&(u.append(Yi(new Pn(1),s),r),r=s.length+Math.max(0,r-s.length)),u.append(Yi(a,s),r),this.atCursorPos=h,this.pendingBuffer=h?e<t||r>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=r)}static build(e,t,n,s,r){let o=new ai(e,t,n,r);return o.openEnd=K.spans(s,t,n,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function Yi(i,e){for(let t of e)i=new kt(t,[i],i.length);return i}class En extends Nn{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}En.inline=new En("span");En.block=new En("div");var le=function(i){return i[i.LTR=0]="LTR",i[i.RTL=1]="RTL",i}(le||(le={}));const tn=le.LTR,ol=le.RTL;function Wu(i){let e=[];for(let t=0;t<i.length;t++)e.push(1<<+i[t]);return e}const C0=Wu("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),_0=Wu("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Oo=Object.create(null),it=[];for(let i of["()","[]","{}"]){let e=i.charCodeAt(0),t=i.charCodeAt(1);Oo[e]=t,Oo[t]=-e}function ju(i){return i<=247?C0[i]:1424<=i&&i<=1524?2:1536<=i&&i<=1785?_0[i-1536]:1774<=i&&i<=2220?4:8192<=i&&i<=8204?256:64336<=i&&i<=65023?4:1}const A0=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Mt{get dir(){return this.level%2?ol:tn}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,n,s){let r=-1;for(let o=0;o<e.length;o++){let l=e[o];if(l.from<=t&&l.to>=t){if(l.level==n)return o;(r<0||(s!=0?s<0?l.from<t:l.to>t:e[r].level>l.level))&&(r=o)}}if(r<0)throw new RangeError("Index out of range");return r}}function Yu(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++){let n=i[t],s=e[t];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!Yu(n.inner,s.inner))return!1}return!0}const ee=[];function P0(i,e,t,n,s){for(let r=0;r<=n.length;r++){let o=r?n[r-1].to:e,l=r<n.length?n[r].from:t,a=r?256:s;for(let c=o,h=a,u=a;c<l;c++){let f=ju(i.charCodeAt(c));f==512?f=h:f==8&&u==4&&(f=16),ee[c]=f==4?2:f,f&7&&(u=f),h=f}for(let c=o,h=a,u=a;c<l;c++){let f=ee[c];if(f==128)c<l-1&&h==ee[c+1]&&h&24?f=ee[c]=h:ee[c]=256;else if(f==64){let d=c+1;for(;d<l&&ee[d]==64;)d++;let p=c&&h==8||d<t&&ee[d]==8?u==1?1:8:256;for(let m=c;m<d;m++)ee[m]=p;c=d-1}else f==8&&u==1&&(ee[c]=1);h=f,f&7&&(u=f)}}}function E0(i,e,t,n,s){let r=s==1?2:1;for(let o=0,l=0,a=0;o<=n.length;o++){let c=o?n[o-1].to:e,h=o<n.length?n[o].from:t;for(let u=c,f,d,p;u<h;u++)if(d=Oo[f=i.charCodeAt(u)])if(d<0){for(let m=l-3;m>=0;m-=3)if(it[m+1]==-d){let b=it[m+2],y=b&2?s:b&4?b&1?r:s:0;y&&(ee[u]=ee[it[m]]=y),l=m;break}}else{if(it.length==189)break;it[l++]=u,it[l++]=f,it[l++]=a}else if((p=ee[u])==2||p==1){let m=p==s;a=m?0:1;for(let b=l-3;b>=0;b-=3){let y=it[b+2];if(y&2)break;if(m)it[b+2]|=2;else{if(y&4)break;it[b+2]|=4}}}}}function T0(i,e,t,n){for(let s=0,r=n;s<=t.length;s++){let o=s?t[s-1].to:i,l=s<t.length?t[s].from:e;for(let a=o;a<l;){let c=ee[a];if(c==256){let h=a+1;for(;;)if(h==l){if(s==t.length)break;h=t[s++].to,l=s<t.length?t[s].from:e}else if(ee[h]==256)h++;else break;let u=r==1,f=(h<e?ee[h]:n)==1,d=u==f?u?1:2:n;for(let p=h,m=s,b=m?t[m-1].to:i;p>a;)p==b&&(p=t[--m].from,b=m?t[m-1].to:i),ee[--p]=d;a=h}else r=c,a++}}}function ko(i,e,t,n,s,r,o){let l=n%2?2:1;if(n%2==s%2)for(let a=e,c=0;a<t;){let h=!0,u=!1;if(c==r.length||a<r[c].from){let m=ee[a];m!=l&&(h=!1,u=m==16)}let f=!h&&l==1?[]:null,d=h?n:n+1,p=a;e:for(;;)if(c<r.length&&p==r[c].from){if(u)break e;let m=r[c];if(!h)for(let b=m.to,y=c+1;;){if(b==t)break e;if(y<r.length&&r[y].from==b)b=r[y++].to;else{if(ee[b]==l)break e;break}}if(c++,f)f.push(m);else{m.from>a&&o.push(new Mt(a,m.from,d));let b=m.direction==tn!=!(d%2);wo(i,b?n+1:n,s,m.inner,m.from,m.to,o),a=m.to}p=m.to}else{if(p==t||(h?ee[p]!=l:ee[p]==l))break;p++}f?ko(i,a,p,n+1,s,f,o):a<p&&o.push(new Mt(a,p,d)),a=p}else for(let a=t,c=r.length;a>e;){let h=!0,u=!1;if(!c||a>r[c-1].to){let m=ee[a-1];m!=l&&(h=!1,u=m==16)}let f=!h&&l==1?[]:null,d=h?n:n+1,p=a;e:for(;;)if(c&&p==r[c-1].to){if(u)break e;let m=r[--c];if(!h)for(let b=m.from,y=c;;){if(b==e)break e;if(y&&r[y-1].to==b)b=r[--y].from;else{if(ee[b-1]==l)break e;break}}if(f)f.push(m);else{m.to<a&&o.push(new Mt(m.to,a,d));let b=m.direction==tn!=!(d%2);wo(i,b?n+1:n,s,m.inner,m.from,m.to,o),a=m.from}p=m.from}else{if(p==e||(h?ee[p-1]!=l:ee[p-1]==l))break;p--}f?ko(i,p,a,n+1,s,f,o):p<a&&o.push(new Mt(p,a,d)),a=p}}function wo(i,e,t,n,s,r,o){let l=e%2?2:1;P0(i,s,r,n,l),E0(i,s,r,n,l),T0(s,r,n,l),ko(i,s,r,e,t,n,o)}function R0(i,e,t){if(!i)return[new Mt(0,0,e==ol?1:0)];if(e==tn&&!t.length&&!A0.test(i))return Uu(i.length);if(t.length)for(;i.length>ee.length;)ee[ee.length]=256;let n=[],s=e==tn?0:1;return wo(i,s,s,t,0,i.length,n),n}function Uu(i){return[new Mt(0,i,0)]}let Gu="";function M0(i,e,t,n,s){var r;let o=n.head-i.from,l=Mt.find(e,o,(r=n.bidiLevel)!==null&&r!==void 0?r:-1,n.assoc),a=e[l],c=a.side(s,t);if(o==c){let f=l+=s?1:-1;if(f<0||f>=e.length)return null;a=e[l=f],o=a.side(!s,t),c=a.side(s,t)}let h=_e(i.text,o,a.forward(s,t));(h<a.from||h>a.to)&&(h=c),Gu=i.text.slice(Math.min(o,h),Math.max(o,h));let u=l==(s?e.length-1:0)?null:e[l+(s?1:-1)];return u&&h==c&&u.level+(s?0:1)<a.level?C.cursor(u.side(!s,t)+i.from,u.forward(s,t)?1:-1,u.level):C.cursor(h+i.from,a.forward(s,t)?-1:1,a.level)}function $0(i,e,t){for(let n=e;n<t;n++){let s=ju(i.charCodeAt(n));if(s==1)return tn;if(s==2||s==4)return ol}return tn}const Ku=D.define(),Zu=D.define(),Ju=D.define(),ef=D.define(),So=D.define(),tf=D.define(),nf=D.define(),ll=D.define(),al=D.define(),sf=D.define({combine:i=>i.some(e=>e)}),D0=D.define({combine:i=>i.some(e=>e)}),rf=D.define();class xn{constructor(e,t="nearest",n="nearest",s=5,r=5,o=!1){this.range=e,this.y=t,this.x=n,this.yMargin=s,this.xMargin=r,this.isSnapshot=o}map(e){return e.empty?this:new xn(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new xn(C.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Ui=Y.define({map:(i,e)=>i.map(e)}),of=Y.define();function Ae(i,e,t){let n=i.facet(ef);n.length?n[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const _t=D.define({combine:i=>i.length?i[0]:!0});let B0=0;const Zn=D.define();class $e{constructor(e,t,n,s,r){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=s,this.extension=r(this)}static define(e,t){const{eventHandlers:n,eventObservers:s,provide:r,decorations:o}=t||{};return new $e(B0++,e,n,s,l=>{let a=[Zn.of(l)];return o&&a.push(Si.of(c=>{let h=c.plugin(l);return h?o(h):V.none})),r&&a.push(r(l)),a})}static fromClass(e,t){return $e.define(n=>new e(n),t)}}class wr{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(Ae(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){Ae(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(n){Ae(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const lf=D.define(),cl=D.define(),Si=D.define(),af=D.define(),hl=D.define(),cf=D.define();function ja(i,e){let t=i.state.facet(cf);if(!t.length)return t;let n=t.map(r=>r instanceof Function?r(i):r),s=[];return K.spans(n,e.from,e.to,{point(){},span(r,o,l,a){let c=r-e.from,h=o-e.from,u=s;for(let f=l.length-1;f>=0;f--,a--){let d=l[f].spec.bidiIsolate,p;if(d==null&&(d=$0(e.text,c,h)),a>0&&u.length&&(p=u[u.length-1]).to==c&&p.direction==d)p.to=h,u=p.inner;else{let m={from:c,to:h,direction:d,inner:[]};u.push(m),u=m.inner}}}}),s}const hf=D.define();function ul(i){let e=0,t=0,n=0,s=0;for(let r of i.state.facet(hf)){let o=r(i);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(n=Math.max(n,o.top)),o.bottom!=null&&(s=Math.max(s,o.bottom)))}return{left:e,right:t,top:n,bottom:s}}const Jn=D.define();class We{constructor(e,t,n,s){this.fromA=e,this.toA=t,this.fromB=n,this.toB=s}join(e){return new We(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let s=e[t-1];if(!(s.fromA>n.toA)){if(s.toA<n.fromA)break;n=n.join(s),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(t.length==0)return e;let n=[];for(let s=0,r=0,o=0,l=0;;s++){let a=s==e.length?null:e[s],c=o-l,h=a?a.fromB:1e9;for(;r<t.length&&t[r]<h;){let u=t[r],f=t[r+1],d=Math.max(l,u),p=Math.min(h,f);if(d<=p&&new We(d+c,p+c,d,p).addToSet(n),f>h)break;r+=2}if(!a)return n;new We(a.fromA,a.toA,a.fromB,a.toB).addToSet(n),o=a.toA,l=a.toB}}}class Ls{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=pe.empty(this.startState.doc.length);for(let r of n)this.changes=this.changes.compose(r.changes);let s=[];this.changes.iterChangedRanges((r,o,l,a)=>s.push(new We(r,o,l,a))),this.changedRanges=s}static create(e,t,n){return new Ls(e,t,n)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class Ya extends te{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=V.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new he],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new We(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:c,toA:h})=>h<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?s=this.domChanged.newSel.head:!H0(e.changes,this.hasComposition)&&!e.selectionSet&&(s=e.state.selection.main.head));let r=s>-1?I0(this.view,e.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:h}=this.hasComposition;n=new We(c,h,e.changes.mapPos(c,-1),e.changes.mapPos(h,1)).addToSet(n.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,($.ie||$.chrome)&&!r&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,l=this.updateDeco(),a=q0(o,l,e.changes);return n=We.extendWithRanges(n,a),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,r),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,n);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=$.chrome||$.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||s.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof xt&&o.widget instanceof xo&&r.push(o.dom);s.updateGaps(r)}updateChildren(e,t,n){let s=n?n.range.addToSet(e.slice()):e,r=this.childCursor(t);for(let o=s.length-1;;o--){let l=o>=0?s[o]:null;if(!l)break;let{fromA:a,toA:c,fromB:h,toB:u}=l,f,d,p,m;if(n&&n.range.fromB<u&&n.range.toB>h){let w=ai.build(this.view.state.doc,h,n.range.fromB,this.decorations,this.dynamicDecorationMap),k=ai.build(this.view.state.doc,n.range.toB,u,this.decorations,this.dynamicDecorationMap);d=w.breakAtStart,p=w.openStart,m=k.openEnd;let _=this.compositionView(n);k.breakAtStart?_.breakAfter=1:k.content.length&&_.merge(_.length,_.length,k.content[0],!1,k.openStart,0)&&(_.breakAfter=k.content[0].breakAfter,k.content.shift()),w.content.length&&_.merge(0,0,w.content[w.content.length-1],!0,0,w.openEnd)&&w.content.pop(),f=w.content.concat(_).concat(k.content)}else({content:f,breakAtStart:d,openStart:p,openEnd:m}=ai.build(this.view.state.doc,h,u,this.decorations,this.dynamicDecorationMap));let{i:b,off:y}=r.findPos(c,1),{i:v,off:x}=r.findPos(a,-1);Fu(this,v,x,b,y,f,d,p,m)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let n of t.effects)n.is(of)&&(this.editContextFormatting=n.value)}compositionView(e){let t=new Ke(e.text.nodeValue);t.flags|=8;for(let{deco:s}of e.marks)t=new kt(s,[t],t.length);let n=new he;return n.append(t,0),n}fixCompositionDOM(e){let t=(r,o)=>{o.flags|=8|(o.children.some(a=>a.flags&7)?1:0),this.markedForComposition.add(o);let l=te.get(r);l&&l!=o&&(l.dom=null),o.setDOM(r)},n=this.childPos(e.range.fromB,1),s=this.children[n.i];t(e.line,s);for(let r=e.marks.length-1;r>=-1;r--)n=s.childPos(n.off,1),s=s.children[n.i],t(r>=0?e.marks[r].node:e.text,s)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,s=n==this.dom,r=!s&&xs(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(s||t||r))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(l.anchor)),c=l.empty?a:this.moveToLine(this.domAtPos(l.head));if($.gecko&&l.empty&&!this.hasComposition&&L0(a)){let u=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(u,a.node.childNodes[a.offset]||null)),a=c=new we(u,0),o=!0}let h=this.view.observer.selectionRange;(o||!h.focusNode||(!li(a.node,a.offset,h.anchorNode,h.anchorOffset)||!li(c.node,c.offset,h.focusNode,h.focusOffset))&&!this.suppressWidgetCursorChange(h,l))&&(this.view.observer.ignore(()=>{$.android&&$.chrome&&this.dom.contains(h.focusNode)&&Q0(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let u=wi(this.view.root);if(u)if(l.empty){if($.gecko){let f=F0(a.node,a.offset);if(f&&f!=3){let d=(f==1?Bu:Lu)(a.node,a.offset);d&&(a=new we(d.node,d.offset))}}u.collapse(a.node,a.offset),l.bidiLevel!=null&&u.caretBidiLevel!==void 0&&(u.caretBidiLevel=l.bidiLevel)}else if(u.extend){u.collapse(a.node,a.offset);try{u.extend(c.node,c.offset)}catch{}}else{let f=document.createRange();l.anchor>l.head&&([a,c]=[c,a]),f.setEnd(c.node,c.offset),f.setStart(a.node,a.offset),u.removeAllRanges(),u.addRange(f)}r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(a,c)),this.impreciseAnchor=a.precise?null:new we(h.anchorNode,h.anchorOffset),this.impreciseHead=c.precise?null:new we(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&li(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=wi(e.root),{anchorNode:s,anchorOffset:r}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let o=he.find(this,t.head);if(!o)return;let l=o.posAtStart;if(t.head==l||t.head==l+o.length)return;let a=this.coordsAt(t.head,-1),c=this.coordsAt(t.head,1);if(!a||!c||a.bottom>c.top)return;let h=this.domAtPos(t.head+t.assoc);n.collapse(h.node,h.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let u=e.observer.selectionRange;e.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=t.from&&n.collapse(s,r)}moveToLine(e){let t=this.dom,n;if(e.node!=t)return e;for(let s=e.offset;!n&&s<t.childNodes.length;s++){let r=te.get(t.childNodes[s]);r instanceof he&&(n=r.domAtPos(0))}for(let s=e.offset-1;!n&&s>=0;s--){let r=te.get(t.childNodes[s]);r instanceof he&&(n=r.domAtPos(r.length))}return n?new we(n.node,n.offset,!0):e}nearest(e){for(let t=e;t;){let n=te.get(t);if(n&&n.rootView==this)return n;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let s=this.children[t];if(n<s.length||s instanceof he)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){let n=null,s=0;for(let r=this.length,o=this.children.length-1;o>=0;o--){let l=this.children[o],a=r-l.breakAfter,c=a-l.length;if(a<e)break;if(c<=e&&(c<e||l.covers(-1))&&(a>e||l.covers(1))&&(!n||l instanceof he&&!(n instanceof he&&t>=0)))n=l,s=c;else if(n&&c==e&&a==e&&l instanceof xt&&Math.abs(t)<2){if(l.deco.startSide<0)break;o&&(n=null)}r=c}return n?n.coordsAt(e-s,t):null}coordsForChar(e){let{i:t,off:n}=this.childPos(e,1),s=this.children[t];if(!(s instanceof he))return null;for(;s.children.length;){let{i:l,off:a}=s.childPos(n,1);for(;;l++){if(l==s.children.length)return null;if((s=s.children[l]).length)break}n=a}if(!(s instanceof Ke))return null;let r=_e(s.text,n);if(r==n)return null;let o=en(s.dom,n,r).getClientRects();for(let l=0;l<o.length;l++){let a=o[l];if(l==o.length-1||a.top<a.bottom&&a.left<a.right)return a}return null}measureVisibleLineHeights(e){let t=[],{from:n,to:s}=e,r=this.view.contentDOM.clientWidth,o=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,a=this.view.textDirection==le.LTR;for(let c=0,h=0;h<this.children.length;h++){let u=this.children[h],f=c+u.length;if(f>s)break;if(c>=n){let d=u.dom.getBoundingClientRect();if(t.push(d.height),o){let p=u.dom.lastChild,m=p?An(p):[];if(m.length){let b=m[m.length-1],y=a?b.right-d.left:d.right-b.left;y>l&&(l=y,this.minWidth=r,this.minWidthFrom=c,this.minWidthTo=f)}}}c=f+u.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?le.RTL:le.LTR}measureTextSize(){for(let r of this.children)if(r instanceof he){let o=r.measureTextSize();if(o)return o}let e=document.createElement("div"),t,n,s;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let r=An(e.firstChild)[0];t=e.getBoundingClientRect().height,n=r?r.width/27:7,s=r?r.height:t,e.remove()}),{lineHeight:t,charWidth:n,textHeight:s}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new Iu(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,s=0;;s++){let r=s==t.viewports.length?null:t.viewports[s],o=r?r.from-1:this.length;if(o>n){let l=(t.lineBlockAt(o).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(V.replace({widget:new xo(l),block:!0,inclusive:!0,isBlockGap:!0}).range(n,o))}if(!r)break;n=r.to+1}return V.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Si).map(r=>(this.dynamicDecorationMap[e++]=typeof r=="function")?r(this.view):r),n=!1,s=this.view.state.facet(af).map((r,o)=>{let l=typeof r=="function";return l&&(n=!0),l?r(this.view):r});for(s.length&&(this.dynamicDecorationMap[e++]=n,t.push(K.join(s))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(rf))try{if(c(this.view,e.range,e))return!0}catch(h){Ae(this.view.state,h,"scroll handler")}let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),s;if(!n)return;!t.empty&&(s=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,s.left),top:Math.min(n.top,s.top),right:Math.max(n.right,s.right),bottom:Math.max(n.bottom,s.bottom)});let r=ul(this.view),o={left:n.left-r.left,top:n.top-r.top,right:n.right+r.right,bottom:n.bottom+r.bottom},{offsetWidth:l,offsetHeight:a}=this.view.scrollDOM;p0(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,l),-l),Math.max(Math.min(e.yMargin,a),-a),this.view.textDirection==le.LTR)}}function L0(i){return i.node.nodeType==1&&i.node.firstChild&&(i.offset==0||i.node.childNodes[i.offset-1].contentEditable=="false")&&(i.offset==i.node.childNodes.length||i.node.childNodes[i.offset].contentEditable=="false")}function uf(i,e){let t=i.observer.selectionRange;if(!t.focusNode)return null;let n=Bu(t.focusNode,t.focusOffset),s=Lu(t.focusNode,t.focusOffset),r=n||s;if(s&&n&&s.node!=n.node){let l=te.get(s.node);if(!l||l instanceof Ke&&l.text!=s.node.nodeValue)r=s;else if(i.docView.lastCompositionAfterCursor){let a=te.get(n.node);!a||a instanceof Ke&&a.text!=n.node.nodeValue||(r=s)}}if(i.docView.lastCompositionAfterCursor=r!=n,!r)return null;let o=e-r.offset;return{from:o,to:o+r.node.nodeValue.length,node:r.node}}function I0(i,e,t){let n=uf(i,t);if(!n)return null;let{node:s,from:r,to:o}=n,l=s.nodeValue;if(/[\n\r]/.test(l)||i.state.doc.sliceString(n.from,n.to)!=l)return null;let a=e.invertedDesc,c=new We(a.mapPos(r),a.mapPos(o),r,o),h=[];for(let u=s.parentNode;;u=u.parentNode){let f=te.get(u);if(f instanceof kt)h.push({node:u,deco:f.mark});else{if(f instanceof he||u.nodeName=="DIV"&&u.parentNode==i.contentDOM)return{range:c,text:s,marks:h,line:u};if(u!=i.contentDOM)h.push({node:u,deco:new $i({inclusive:!0,attributes:w0(u),tagName:u.tagName.toLowerCase()})});else return null}}}function F0(i,e){return i.nodeType!=1?0:(e&&i.childNodes[e-1].contentEditable=="false"?1:0)|(e<i.childNodes.length&&i.childNodes[e].contentEditable=="false"?2:0)}let N0=class{constructor(){this.changes=[]}compareRange(e,t){vo(e,t,this.changes)}comparePoint(e,t){vo(e,t,this.changes)}};function q0(i,e,t){let n=new N0;return K.compare(i,e,t,n),n.changes}function Q0(i,e){for(let t=i;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function H0(i,e){let t=!1;return e&&i.iterChangedRanges((n,s)=>{n<e.to&&s>e.from&&(t=!0)}),t}function V0(i,e,t=1){let n=i.charCategorizer(e),s=i.doc.lineAt(e),r=e-s.from;if(s.length==0)return C.cursor(e);r==0?t=1:r==s.length&&(t=-1);let o=r,l=r;t<0?o=_e(s.text,r,!1):l=_e(s.text,r);let a=n(s.text.slice(o,l));for(;o>0;){let c=_e(s.text,o,!1);if(n(s.text.slice(c,o))!=a)break;o=c}for(;l<s.length;){let c=_e(s.text,l);if(n(s.text.slice(l,c))!=a)break;l=c}return C.range(o+s.from,l+s.from)}function z0(i,e){return e.left>i?e.left-i:Math.max(0,i-e.right)}function X0(i,e){return e.top>i?e.top-i:Math.max(0,i-e.bottom)}function Sr(i,e){return i.top<e.bottom-1&&i.bottom>e.top+1}function Ua(i,e){return e<i.top?{top:e,left:i.left,right:i.right,bottom:i.bottom}:i}function Ga(i,e){return e>i.bottom?{top:i.top,left:i.left,right:i.right,bottom:e}:i}function Co(i,e,t){let n,s,r,o,l=!1,a,c,h,u;for(let p=i.firstChild;p;p=p.nextSibling){let m=An(p);for(let b=0;b<m.length;b++){let y=m[b];s&&Sr(s,y)&&(y=Ua(Ga(y,s.bottom),s.top));let v=z0(e,y),x=X0(t,y);if(v==0&&x==0)return p.nodeType==3?Ka(p,e,t):Co(p,e,t);if(!n||o>x||o==x&&r>v){n=p,s=y,r=v,o=x;let w=x?t<y.top?-1:1:v?e<y.left?-1:1:0;l=!w||(w>0?b<m.length-1:b>0)}v==0?t>y.bottom&&(!h||h.bottom<y.bottom)?(a=p,h=y):t<y.top&&(!u||u.top>y.top)&&(c=p,u=y):h&&Sr(h,y)?h=Ga(h,y.bottom):u&&Sr(u,y)&&(u=Ua(u,y.top))}}if(h&&h.bottom>=t?(n=a,s=h):u&&u.top<=t&&(n=c,s=u),!n)return{node:i,offset:0};let f=Math.max(s.left,Math.min(s.right,e));if(n.nodeType==3)return Ka(n,f,t);if(l&&n.contentEditable!="false")return Co(n,f,t);let d=Array.prototype.indexOf.call(i.childNodes,n)+(e>=(s.left+s.right)/2?1:0);return{node:i,offset:d}}function Ka(i,e,t){let n=i.nodeValue.length,s=-1,r=1e9,o=0;for(let l=0;l<n;l++){let a=en(i,l,l+1).getClientRects();for(let c=0;c<a.length;c++){let h=a[c];if(h.top==h.bottom)continue;o||(o=e-h.left);let u=(h.top>t?h.top-t:t-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&u<r){let f=e>=(h.left+h.right)/2,d=f;if(($.chrome||$.gecko)&&en(i,l).getBoundingClientRect().left==h.right&&(d=!f),u<=0)return{node:i,offset:l+(d?1:0)};s=l+(d?1:0),r=u}}}return{node:i,offset:s>-1?s:o>0?i.nodeValue.length:0}}function ff(i,e,t,n=-1){var s,r;let o=i.contentDOM.getBoundingClientRect(),l=o.top+i.viewState.paddingTop,a,{docHeight:c}=i.viewState,{x:h,y:u}=e,f=u-l;if(f<0)return 0;if(f>c)return i.state.doc.length;for(let w=i.viewState.heightOracle.textHeight/2,k=!1;a=i.elementAtHeight(f),a.type!=Xe.Text;)for(;f=n>0?a.bottom+w:a.top-w,!(f>=0&&f<=c);){if(k)return t?null:0;k=!0,n=-n}u=l+f;let d=a.from;if(d<i.viewport.from)return i.viewport.from==0?0:t?null:Za(i,o,a,h,u);if(d>i.viewport.to)return i.viewport.to==i.state.doc.length?i.state.doc.length:t?null:Za(i,o,a,h,u);let p=i.dom.ownerDocument,m=i.root.elementFromPoint?i.root:p,b=m.elementFromPoint(h,u);b&&!i.contentDOM.contains(b)&&(b=null),b||(h=Math.max(o.left+1,Math.min(o.right-1,h)),b=m.elementFromPoint(h,u),b&&!i.contentDOM.contains(b)&&(b=null));let y,v=-1;if(b&&((s=i.docView.nearest(b))===null||s===void 0?void 0:s.isEditable)!=!1){if(p.caretPositionFromPoint){let w=p.caretPositionFromPoint(h,u);w&&({offsetNode:y,offset:v}=w)}else if(p.caretRangeFromPoint){let w=p.caretRangeFromPoint(h,u);w&&({startContainer:y,startOffset:v}=w,(!i.contentDOM.contains(y)||$.safari&&W0(y,v,h)||$.chrome&&j0(y,v,h))&&(y=void 0))}y&&(v=Math.min(ft(y),v))}if(!y||!i.docView.dom.contains(y)){let w=he.find(i.docView,d);if(!w)return f>a.top+a.height/2?a.to:a.from;({node:y,offset:v}=Co(w.dom,h,u))}let x=i.docView.nearest(y);if(!x)return null;if(x.isWidget&&((r=x.dom)===null||r===void 0?void 0:r.nodeType)==1){let w=x.dom.getBoundingClientRect();return e.y<w.top||e.y<=w.bottom&&e.x<=(w.left+w.right)/2?x.posAtStart:x.posAtEnd}else return x.localPosFromDOM(y,v)+x.posAtStart}function Za(i,e,t,n,s){let r=Math.round((n-e.left)*i.defaultCharacterWidth);if(i.lineWrapping&&t.height>i.defaultLineHeight*1.5){let l=i.viewState.heightOracle.textHeight,a=Math.floor((s-t.top-(i.defaultLineHeight-l)*.5)/l);r+=a*i.viewState.heightOracle.lineLength}let o=i.state.sliceDoc(t.from,t.to);return t.from+a0(o,r,i.state.tabSize)}function W0(i,e,t){let n;if(i.nodeType!=3||e!=(n=i.nodeValue.length))return!1;for(let s=i.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return en(i,n-1,n).getBoundingClientRect().left>t}function j0(i,e,t){if(e!=0)return!1;for(let s=i;;){let r=s.parentNode;if(!r||r.nodeType!=1||r.firstChild!=s)return!1;if(r.classList.contains("cm-line"))break;s=r}let n=i.nodeType==1?i.getBoundingClientRect():en(i,0,Math.max(i.nodeValue.length,1)).getBoundingClientRect();return t-n.left>5}function Y0(i,e){let t=i.lineBlockAt(e);if(Array.isArray(t.type)){for(let n of t.type)if(n.to>e||n.to==e&&(n.to==t.to||n.type==Xe.Text))return n}return t}function U0(i,e,t,n){let s=Y0(i,e.head),r=!n||s.type!=Xe.Text||!(i.lineWrapping||s.widgetLineBreaks)?null:i.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(r){let o=i.dom.getBoundingClientRect(),l=i.textDirectionAt(s.from),a=i.posAtCoords({x:t==(l==le.LTR)?o.right-1:o.left+1,y:(r.top+r.bottom)/2});if(a!=null)return C.cursor(a,t?-1:1)}return C.cursor(t?s.to:s.from,t?-1:1)}function Ja(i,e,t,n){let s=i.state.doc.lineAt(e.head),r=i.bidiSpans(s),o=i.textDirectionAt(s.from);for(let l=e,a=null;;){let c=M0(s,r,o,l,t),h=Gu;if(!c){if(s.number==(t?i.state.doc.lines:1))return l;h=`
`,s=i.state.doc.line(s.number+(t?1:-1)),r=i.bidiSpans(s),c=i.visualLineSide(s,!t)}if(a){if(!a(h))return l}else{if(!n)return c;a=n(h)}l=c}}function G0(i,e,t){let n=i.state.charCategorizer(e),s=n(t);return r=>{let o=n(r);return s==Ve.Space&&(s=o),s==o}}function K0(i,e,t,n){let s=e.head,r=t?1:-1;if(s==(t?i.state.doc.length:0))return C.cursor(s,e.assoc);let o=e.goalColumn,l,a=i.contentDOM.getBoundingClientRect(),c=i.coordsAtPos(s,e.assoc||-1),h=i.documentTop;if(c)o==null&&(o=c.left-a.left),l=r<0?c.top:c.bottom;else{let d=i.viewState.lineBlockAt(s);o==null&&(o=Math.min(a.right-a.left,i.defaultCharacterWidth*(s-d.from))),l=(r<0?d.top:d.bottom)+h}let u=a.left+o,f=n??i.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=l+(f+d)*r,m=ff(i,{x:u,y:p},!1,r);if(p<a.top||p>a.bottom||(r<0?m<s:m>s)){let b=i.docView.coordsForChar(m),y=!b||p<b.top?-1:1;return C.cursor(m,y,void 0,o)}}}function Os(i,e,t){for(;;){let n=0;for(let s of i)s.between(e-1,e+1,(r,o,l)=>{if(e>r&&e<o){let a=n||t||(e-r<o-e?-1:1);e=a<0?r:o,n=a}});if(!n)return e}}function Cr(i,e,t){let n=Os(i.state.facet(hl).map(s=>s(i)),t.from,e.head>t.from?-1:1);return n==t.from?t:C.cursor(n,n<t.from?1:-1)}const ei="";class Z0{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(W.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=ei}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let s=e;;){this.findPointBefore(n,s);let r=this.text.length;this.readNode(s);let o=s.nextSibling;if(o==t)break;let l=te.get(s),a=te.get(o);(l&&a?l.breakAfter:(l?l.breakAfter:Ds(s))||Ds(o)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>r)&&this.lineBreak(),s=o}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let r=-1,o=1,l;if(this.lineSeparator?(r=t.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(l=s.exec(t))&&(r=l.index,o=l[0].length),this.append(t.slice(n,r<0?t.length:r)),r<0)break;if(this.lineBreak(),o>1)for(let a of this.points)a.node==e&&a.pos>this.text.length&&(a.pos-=o-1);n=r+o}}readNode(e){if(e.cmIgnore)return;let t=te.get(e),n=t&&t.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let s=n.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(J0(e,n.node,n.offset)?t:0))}}function J0(i,e,t){for(;;){if(!e||t<ft(e))return!1;if(e==i)return!0;t=Jt(e)+1,e=e.parentNode}}class ec{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class eb{constructor(e,t,n,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:r,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let l=r||o?[]:ib(e),a=new Z0(l,e.state);a.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=a.text,this.newSel=sb(l,this.bounds.from)}else{let l=e.observer.selectionRange,a=r&&r.node==l.focusNode&&r.offset==l.focusOffset||!fo(e.contentDOM,l.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(l.focusNode,l.focusOffset),c=o&&o.node==l.anchorNode&&o.offset==l.anchorOffset||!fo(e.contentDOM,l.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(l.anchorNode,l.anchorOffset),h=e.viewport;if(($.ios||$.chrome)&&e.state.selection.main.empty&&a!=c&&(h.from>0||h.to<e.state.doc.length)){let u=Math.min(a,c),f=Math.max(a,c),d=h.from-u,p=h.to-f;(d==0||d==1||u==0)&&(p==0||p==-1||f==e.state.doc.length)&&(a=0,c=e.state.doc.length)}this.newSel=C.single(c,a)}}}function df(i,e){let t,{newSel:n}=e,s=i.state.selection.main,r=i.inputState.lastKeyTime>Date.now()-100?i.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:l}=e.bounds,a=s.from,c=null;(r===8||$.android&&e.text.length<l-o)&&(a=s.to,c="end");let h=nb(i.state.doc.sliceString(o,l,ei),e.text,a-o,c);h&&($.chrome&&r==13&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==ei+ei&&h.toB--,t={from:o+h.from,to:o+h.toA,insert:j.of(e.text.slice(h.from,h.toB).split(ei))})}else n&&(!i.hasFocus&&i.state.facet(_t)||n.main.eq(s))&&(n=null);if(!t&&!n)return!1;if(!t&&e.typeOver&&!s.empty&&n&&n.main.empty?t={from:s.from,to:s.to,insert:i.state.doc.slice(s.from,s.to)}:t&&t.from>=s.from&&t.to<=s.to&&(t.from!=s.from||t.to!=s.to)&&s.to-s.from-(t.to-t.from)<=4?t={from:s.from,to:s.to,insert:i.state.doc.slice(s.from,t.from).append(t.insert).append(i.state.doc.slice(t.to,s.to))}:($.mac||$.android)&&t&&t.from==t.to&&t.from==s.head-1&&/^\. ?$/.test(t.insert.toString())&&i.contentDOM.getAttribute("autocorrect")=="off"?(n&&t.insert.length==2&&(n=C.single(n.main.anchor-1,n.main.head-1)),t={from:s.from,to:s.to,insert:j.of([" "])}):$.chrome&&t&&t.from==t.to&&t.from==s.head&&t.insert.toString()==`
 `&&i.lineWrapping&&(n&&(n=C.single(n.main.anchor-1,n.main.head-1)),t={from:s.from,to:s.to,insert:j.of([" "])}),t)return fl(i,t,n,r);if(n&&!n.main.eq(s)){let o=!1,l="select";return i.inputState.lastSelectionTime>Date.now()-50&&(i.inputState.lastSelectionOrigin=="select"&&(o=!0),l=i.inputState.lastSelectionOrigin),i.dispatch({selection:n,scrollIntoView:o,userEvent:l}),!0}else return!1}function fl(i,e,t,n=-1){if($.ios&&i.inputState.flushIOSKey(e))return!0;let s=i.state.selection.main;if($.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&i.state.sliceDoc(e.from,s.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&vn(i.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&e.insert.length==0||n==8&&e.insert.length<e.to-e.from&&e.to>s.head)&&vn(i.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&e.insert.length==0&&vn(i.contentDOM,"Delete",46)))return!0;let r=e.insert.toString();i.inputState.composing>=0&&i.inputState.composing++;let o,l=()=>o||(o=tb(i,e,t));return i.state.facet(tf).some(a=>a(i,e.from,e.to,r,l))||i.dispatch(l()),!0}function tb(i,e,t){let n,s=i.state,r=s.selection.main;if(e.from>=r.from&&e.to<=r.to&&e.to-e.from>=(r.to-r.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&i.inputState.composing<0){let l=r.from<e.from?s.sliceDoc(r.from,e.from):"",a=r.to>e.to?s.sliceDoc(e.to,r.to):"";n=s.replaceSelection(i.state.toText(l+e.insert.sliceString(0,void 0,i.state.lineBreak)+a))}else{let l=s.changes(e),a=t&&t.main.to<=l.newLength?t.main:void 0;if(s.selection.ranges.length>1&&i.inputState.composing>=0&&e.to<=r.to&&e.to>=r.to-10){let c=i.state.sliceDoc(e.from,e.to),h,u=t&&uf(i,t.main.head);if(u){let p=e.insert.length-(e.to-e.from);h={from:u.from,to:u.to-p}}else h=i.state.doc.lineAt(r.head);let f=r.to-e.to,d=r.to-r.from;n=s.changeByRange(p=>{if(p.from==r.from&&p.to==r.to)return{changes:l,range:a||p.map(l)};let m=p.to-f,b=m-c.length;if(p.to-p.from!=d||i.state.sliceDoc(b,m)!=c||p.to>=h.from&&p.from<=h.to)return{range:p};let y=s.changes({from:b,to:m,insert:e.insert}),v=p.to-r.to;return{changes:y,range:a?C.range(Math.max(0,a.anchor+v),Math.max(0,a.head+v)):p.map(y)}})}else n={changes:l,selection:a&&s.selection.replaceRange(a)}}let o="input.type";return(i.composing||i.inputState.compositionPendingChange&&i.inputState.compositionEndedAt>Date.now()-50)&&(i.inputState.compositionPendingChange=!1,o+=".compose",i.inputState.compositionFirstChange&&(o+=".start",i.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:o,scrollIntoView:!0})}function nb(i,e,t,n){let s=Math.min(i.length,e.length),r=0;for(;r<s&&i.charCodeAt(r)==e.charCodeAt(r);)r++;if(r==s&&i.length==e.length)return null;let o=i.length,l=e.length;for(;o>0&&l>0&&i.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if(n=="end"){let a=Math.max(0,r-Math.min(o,l));t-=o+a-r}if(o<r&&i.length<e.length){let a=t<=r&&t>=o?r-t:0;r-=a,l=r+(l-o),o=r}else if(l<r){let a=t<=r&&t>=l?r-t:0;r-=a,o=r+(o-l),l=r}return{from:r,toA:o,toB:l}}function ib(i){let e=[];if(i.root.activeElement!=i.contentDOM)return e;let{anchorNode:t,anchorOffset:n,focusNode:s,focusOffset:r}=i.observer.selectionRange;return t&&(e.push(new ec(t,n)),(s!=t||r!=n)&&e.push(new ec(s,r))),e}function sb(i,e){if(i.length==0)return null;let t=i[0].pos,n=i.length==2?i[1].pos:t;return t>-1&&n>-1?C.single(t+e,n+e):null}class rb{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,$.safari&&e.contentDOM.addEventListener("input",()=>null),$.gecko&&Ob(e.contentDOM.ownerDocument)}handleEvent(e){!db(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let n=this.handlers[e];if(n){for(let s of n.observers)s(this.view,t);for(let s of n.handlers){if(t.defaultPrevented)break;if(s(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=ob(e),n=this.handlers,s=this.view.contentDOM;for(let r in t)if(r!="scroll"){let o=!t[r].handlers.length,l=n[r];l&&o!=!l.handlers.length&&(s.removeEventListener(r,this.handleEvent),l=null),l||s.addEventListener(r,this.handleEvent,{passive:o})}for(let r in n)r!="scroll"&&!t[r]&&s.removeEventListener(r,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&gf.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),$.android&&$.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return $.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=pf.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||lb.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,vn(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:$.safari&&!$.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function tc(i,e){return(t,n)=>{try{return e.call(i,n,t)}catch(s){Ae(t.state,s)}}}function ob(i){let e=Object.create(null);function t(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of i){let s=n.spec;if(s&&s.domEventHandlers)for(let r in s.domEventHandlers){let o=s.domEventHandlers[r];o&&t(r).handlers.push(tc(n.value,o))}if(s&&s.domEventObservers)for(let r in s.domEventObservers){let o=s.domEventObservers[r];o&&t(r).observers.push(tc(n.value,o))}}for(let n in Ze)t(n).handlers.push(Ze[n]);for(let n in je)t(n).observers.push(je[n]);return e}const pf=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],lb="dthko",gf=[16,17,18,20,91,92,224,225],Gi=6;function Ki(i){return Math.max(0,i)*.7+8}function ab(i,e){return Math.max(Math.abs(i.clientX-e.clientX),Math.abs(i.clientY-e.clientY))}class cb{constructor(e,t,n,s){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=g0(e.contentDOM),this.atoms=e.state.facet(hl).map(o=>o(e));let r=e.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(W.allowMultipleSelections)&&hb(e,t),this.dragging=fb(e,t)&&yf(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&ab(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,n=0,s=0,r=0,o=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:l}=this.scrollParents.y.getBoundingClientRect());let a=ul(this.view);e.clientX-a.left<=s+Gi?t=-Ki(s-e.clientX):e.clientX+a.right>=o-Gi&&(t=Ki(e.clientX-o)),e.clientY-a.top<=r+Gi?n=-Ki(r-e.clientY):e.clientY+a.bottom>=l-Gi&&(n=Ki(e.clientY-l)),this.setScrollSpeed(t,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let s=e.ranges[n],r=null;if(s.empty){let o=Os(this.atoms,s.from,0);o!=s.from&&(r=C.cursor(o,-1))}else{let o=Os(this.atoms,s.from,-1),l=Os(this.atoms,s.to,1);(o!=s.from||l!=s.to)&&(r=C.range(s.from==s.anchor?o:l,s.from==s.head?o:l))}r&&(t||(t=e.ranges.slice()),t[n]=r)}return t?C.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function hb(i,e){let t=i.state.facet(Ku);return t.length?t[0](e):$.mac?e.metaKey:e.ctrlKey}function ub(i,e){let t=i.state.facet(Zu);return t.length?t[0](e):$.mac?!e.altKey:!e.ctrlKey}function fb(i,e){let{main:t}=i.state.selection;if(t.empty)return!1;let n=wi(i.root);if(!n||n.rangeCount==0)return!0;let s=n.getRangeAt(0).getClientRects();for(let r=0;r<s.length;r++){let o=s[r];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function db(i,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,n;t!=i.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(n=te.get(t))&&n.ignoreEvent(e))return!1;return!0}const Ze=Object.create(null),je=Object.create(null),mf=$.ie&&$.ie_version<15||$.ios&&$.webkit_version<604;function pb(i){let e=i.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{i.focus(),t.remove(),bf(i,t.value)},50)}function rr(i,e,t){for(let n of i.facet(e))t=n(t,i);return t}function bf(i,e){e=rr(i.state,ll,e);let{state:t}=i,n,s=1,r=t.toText(e),o=r.lines==t.selection.ranges.length;if(_o!=null&&t.selection.ranges.every(a=>a.empty)&&_o==r.toString()){let a=-1;n=t.changeByRange(c=>{let h=t.doc.lineAt(c.from);if(h.from==a)return{range:c};a=h.from;let u=t.toText((o?r.line(s++).text:e)+t.lineBreak);return{changes:{from:h.from,insert:u},range:C.cursor(c.from+u.length)}})}else o?n=t.changeByRange(a=>{let c=r.line(s++);return{changes:{from:a.from,to:a.to,insert:c.text},range:C.cursor(a.from+c.length)}}):n=t.replaceSelection(r);i.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}je.scroll=i=>{i.inputState.lastScrollTop=i.scrollDOM.scrollTop,i.inputState.lastScrollLeft=i.scrollDOM.scrollLeft};Ze.keydown=(i,e)=>(i.inputState.setSelectionOrigin("select"),e.keyCode==27&&i.inputState.tabFocusMode!=0&&(i.inputState.tabFocusMode=Date.now()+2e3),!1);je.touchstart=(i,e)=>{i.inputState.lastTouchTime=Date.now(),i.inputState.setSelectionOrigin("select.pointer")};je.touchmove=i=>{i.inputState.setSelectionOrigin("select.pointer")};Ze.mousedown=(i,e)=>{if(i.observer.flush(),i.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let n of i.state.facet(Ju))if(t=n(i,e),t)break;if(!t&&e.button==0&&(t=bb(i,e)),t){let n=!i.hasFocus;i.inputState.startMouseSelection(new cb(i,e,t,n)),n&&i.observer.ignore(()=>{Mu(i.contentDOM);let r=i.root.activeElement;r&&!r.contains(i.contentDOM)&&r.blur()});let s=i.inputState.mouseSelection;if(s)return s.start(e),s.dragging===!1}return!1};function nc(i,e,t,n){if(n==1)return C.cursor(e,t);if(n==2)return V0(i.state,e,t);{let s=he.find(i.docView,e),r=i.state.doc.lineAt(s?s.posAtEnd:e),o=s?s.posAtStart:r.from,l=s?s.posAtEnd:r.to;return l<i.state.doc.length&&l==r.to&&l++,C.range(o,l)}}let ic=(i,e,t)=>e>=t.top&&e<=t.bottom&&i>=t.left&&i<=t.right;function gb(i,e,t,n){let s=he.find(i.docView,e);if(!s)return 1;let r=e-s.posAtStart;if(r==0)return 1;if(r==s.length)return-1;let o=s.coordsAt(r,-1);if(o&&ic(t,n,o))return-1;let l=s.coordsAt(r,1);return l&&ic(t,n,l)?1:o&&o.bottom>=n?-1:1}function sc(i,e){let t=i.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:gb(i,t,e.clientX,e.clientY)}}const mb=$.ie&&$.ie_version<=11;let rc=null,oc=0,lc=0;function yf(i){if(!mb)return i.detail;let e=rc,t=lc;return rc=i,lc=Date.now(),oc=!e||t>Date.now()-400&&Math.abs(e.clientX-i.clientX)<2&&Math.abs(e.clientY-i.clientY)<2?(oc+1)%3:1}function bb(i,e){let t=sc(i,e),n=yf(e),s=i.state.selection;return{update(r){r.docChanged&&(t.pos=r.changes.mapPos(t.pos),s=s.map(r.changes))},get(r,o,l){let a=sc(i,r),c,h=nc(i,a.pos,a.bias,n);if(t.pos!=a.pos&&!o){let u=nc(i,t.pos,t.bias,n),f=Math.min(u.from,h.from),d=Math.max(u.to,h.to);h=f<h.from?C.range(f,d):C.range(d,f)}return o?s.replaceRange(s.main.extend(h.from,h.to)):l&&n==1&&s.ranges.length>1&&(c=yb(s,a.pos))?c:l?s.addRange(h):C.create([h])}}}function yb(i,e){for(let t=0;t<i.ranges.length;t++){let{from:n,to:s}=i.ranges[t];if(n<=e&&s>=e)return C.create(i.ranges.slice(0,t).concat(i.ranges.slice(t+1)),i.mainIndex==t?0:i.mainIndex-(i.mainIndex>t?1:0))}return null}Ze.dragstart=(i,e)=>{let{selection:{main:t}}=i.state;if(e.target.draggable){let s=i.docView.nearest(e.target);if(s&&s.isWidget){let r=s.posAtStart,o=r+s.length;(r>=t.to||o<=t.from)&&(t=C.range(r,o))}}let{inputState:n}=i;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",rr(i.state,al,i.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Ze.dragend=i=>(i.inputState.draggedContent=null,!1);function ac(i,e,t,n){if(t=rr(i.state,ll,t),!t)return;let s=i.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:r}=i.inputState,o=n&&r&&ub(i,e)?{from:r.from,to:r.to}:null,l={from:s,insert:t},a=i.state.changes(o?[o,l]:l);i.focus(),i.dispatch({changes:a,selection:{anchor:a.mapPos(s,-1),head:a.mapPos(s,1)},userEvent:o?"move.drop":"input.drop"}),i.inputState.draggedContent=null}Ze.drop=(i,e)=>{if(!e.dataTransfer)return!1;if(i.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let n=Array(t.length),s=0,r=()=>{++s==t.length&&ac(i,e,n.filter(o=>o!=null).join(i.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let l=new FileReader;l.onerror=r,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(n[o]=l.result),r()},l.readAsText(t[o])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return ac(i,e,n,!0),!0}return!1};Ze.paste=(i,e)=>{if(i.state.readOnly)return!0;i.observer.flush();let t=mf?null:e.clipboardData;return t?(bf(i,t.getData("text/plain")||t.getData("text/uri-list")),!0):(pb(i),!1)};function vb(i,e){let t=i.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),i.focus()},50)}function xb(i){let e=[],t=[],n=!1;for(let s of i.selection.ranges)s.empty||(e.push(i.sliceDoc(s.from,s.to)),t.push(s));if(!e.length){let s=-1;for(let{from:r}of i.selection.ranges){let o=i.doc.lineAt(r);o.number>s&&(e.push(o.text),t.push({from:o.from,to:Math.min(i.doc.length,o.to+1)})),s=o.number}n=!0}return{text:rr(i,al,e.join(i.lineBreak)),ranges:t,linewise:n}}let _o=null;Ze.copy=Ze.cut=(i,e)=>{let{text:t,ranges:n,linewise:s}=xb(i.state);if(!t&&!s)return!1;_o=s?t:null,e.type=="cut"&&!i.state.readOnly&&i.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let r=mf?null:e.clipboardData;return r?(r.clearData(),r.setData("text/plain",t),!0):(vb(i,t),!1)};const vf=on.define();function xf(i,e){let t=[];for(let n of i.facet(nf)){let s=n(i,e);s&&t.push(s)}return t?i.update({effects:t,annotations:vf.of(!0)}):null}function Of(i){setTimeout(()=>{let e=i.hasFocus;if(e!=i.inputState.notifiedFocused){let t=xf(i.state,e);t?i.dispatch(t):i.update([])}},10)}je.focus=i=>{i.inputState.lastFocusTime=Date.now(),!i.scrollDOM.scrollTop&&(i.inputState.lastScrollTop||i.inputState.lastScrollLeft)&&(i.scrollDOM.scrollTop=i.inputState.lastScrollTop,i.scrollDOM.scrollLeft=i.inputState.lastScrollLeft),Of(i)};je.blur=i=>{i.observer.clearSelectionRange(),Of(i)};je.compositionstart=je.compositionupdate=i=>{i.observer.editContext||(i.inputState.compositionFirstChange==null&&(i.inputState.compositionFirstChange=!0),i.inputState.composing<0&&(i.inputState.composing=0))};je.compositionend=i=>{i.observer.editContext||(i.inputState.composing=-1,i.inputState.compositionEndedAt=Date.now(),i.inputState.compositionPendingKey=!0,i.inputState.compositionPendingChange=i.observer.pendingRecords().length>0,i.inputState.compositionFirstChange=null,$.chrome&&$.android?i.observer.flushSoon():i.inputState.compositionPendingChange?Promise.resolve().then(()=>i.observer.flush()):setTimeout(()=>{i.inputState.composing<0&&i.docView.hasComposition&&i.update([])},50))};je.contextmenu=i=>{i.inputState.lastContextMenu=Date.now()};Ze.beforeinput=(i,e)=>{var t,n;if(e.inputType=="insertReplacementText"&&i.observer.editContext){let r=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(r&&o.length){let l=o[0],a=i.posAtDOM(l.startContainer,l.startOffset),c=i.posAtDOM(l.endContainer,l.endOffset);return fl(i,{from:a,to:c,insert:i.state.toText(r)},null),!0}}let s;if($.chrome&&$.android&&(s=pf.find(r=>r.inputType==e.inputType))&&(i.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let r=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>r+10&&i.hasFocus&&(i.contentDOM.blur(),i.focus())},100)}return $.ios&&e.inputType=="deleteContentForward"&&i.observer.flushSoon(),$.safari&&e.inputType=="insertText"&&i.inputState.composing>=0&&setTimeout(()=>je.compositionend(i,e),20),!1};const cc=new Set;function Ob(i){cc.has(i)||(cc.add(i),i.addEventListener("copy",()=>{}),i.addEventListener("cut",()=>{}))}const hc=["pre-wrap","normal","pre-line","break-spaces"];let Tn=!1;function uc(){Tn=!1}class kb{constructor(e){this.lineWrapping=e,this.doc=j.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return hc.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let s=e[n];s<0?n++:this.heightSamples[Math.floor(s*10)]||(t=!0,this.heightSamples[Math.floor(s*10)]=!0)}return t}refresh(e,t,n,s,r,o){let l=hc.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=t,this.charWidth=n,this.textHeight=s,this.lineLength=r,a){this.heightSamples={};for(let c=0;c<o.length;c++){let h=o[c];h<0?c++:this.heightSamples[Math.floor(h*10)]=!0}}return a}}class wb{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class lt{constructor(e,t,n,s,r){this.from=e,this.length=t,this.top=n,this.height=s,this._content=r}get type(){return typeof this._content=="number"?Xe.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Lt?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new lt(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var ie=function(i){return i[i.ByPos=0]="ByPos",i[i.ByHeight=1]="ByHeight",i[i.ByPosNoHeight=2]="ByPosNoHeight",i}(ie||(ie={}));const ks=.001;class Pe{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>ks&&(Tn=!0),this.height=e)}replace(e,t,n){return Pe.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,s){let r=this,o=n.doc;for(let l=s.length-1;l>=0;l--){let{fromA:a,toA:c,fromB:h,toB:u}=s[l],f=r.lineAt(a,ie.ByPosNoHeight,n.setDoc(t),0,0),d=f.to>=c?f:r.lineAt(c,ie.ByPosNoHeight,n,0,0);for(u+=d.to-c,c=d.to;l>0&&f.from<=s[l-1].toA;)a=s[l-1].fromA,h=s[l-1].fromB,l--,a<f.from&&(f=r.lineAt(a,ie.ByPosNoHeight,n,0,0));h+=f.from-a,a=f.from;let p=dl.build(n.setDoc(o),e,h,u);r=Is(r,r.replace(a,c,p))}return r.updateHeight(n,0)}static empty(){return new Be(0,0)}static of(e){if(e.length==1)return e[0];let t=0,n=e.length,s=0,r=0;for(;;)if(t==n)if(s>r*2){let l=e[t-1];l.break?e.splice(--t,1,l.left,null,l.right):e.splice(--t,1,l.left,l.right),n+=1+l.break,s-=l.size}else if(r>s*2){let l=e[n];l.break?e.splice(n,1,l.left,null,l.right):e.splice(n,1,l.left,l.right),n+=2+l.break,r-=l.size}else break;else if(s<r){let l=e[t++];l&&(s+=l.size)}else{let l=e[--n];l&&(r+=l.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,n++),new Sb(Pe.of(e.slice(0,t)),o,Pe.of(e.slice(n)))}}function Is(i,e){return i==e?i:(i.constructor!=e.constructor&&(Tn=!0),e)}Pe.prototype.size=1;class kf extends Pe{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,s){return new lt(s,this.length,n,this.height,this.deco||0)}lineAt(e,t,n,s,r){return this.blockAt(0,n,s,r)}forEachLine(e,t,n,s,r,o){e<=r+this.length&&t>=r&&o(this.blockAt(0,n,s,r))}updateHeight(e,t=0,n=!1,s){return s&&s.from<=t&&s.more&&this.setHeight(s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Be extends kf{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,n,s){return new lt(s,this.length,n,this.height,this.breaks)}replace(e,t,n){let s=n[0];return n.length==1&&(s instanceof Be||s instanceof me&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof me?s=new Be(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):Pe.of(n)}updateHeight(e,t=0,n=!1,s){return s&&s.from<=t&&s.more?this.setHeight(s.heights[s.index++]):(n||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class me extends Pe{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,s=e.doc.lineAt(t+this.length).number,r=s-n+1,o,l=0;if(e.lineWrapping){let a=Math.min(this.height,e.lineHeight*r);o=a/r,this.length>r+1&&(l=(this.height-a)/(this.length-r-1))}else o=this.height/r;return{firstLine:n,lastLine:s,perLine:o,perChar:l}}blockAt(e,t,n,s){let{firstLine:r,lastLine:o,perLine:l,perChar:a}=this.heightMetrics(t,s);if(t.lineWrapping){let c=s+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),h=t.doc.lineAt(c),u=l+h.length*a,f=Math.max(n,e-u/2);return new lt(h.from,h.length,f,u,0)}else{let c=Math.max(0,Math.min(o-r,Math.floor((e-n)/l))),{from:h,length:u}=t.doc.line(r+c);return new lt(h,u,n+l*c,l,0)}}lineAt(e,t,n,s,r){if(t==ie.ByHeight)return this.blockAt(e,n,s,r);if(t==ie.ByPosNoHeight){let{from:d,to:p}=n.doc.lineAt(e);return new lt(d,p-d,0,0,0)}let{firstLine:o,perLine:l,perChar:a}=this.heightMetrics(n,r),c=n.doc.lineAt(e),h=l+c.length*a,u=c.number-o,f=s+l*u+a*(c.from-r-u);return new lt(c.from,c.length,Math.max(s,Math.min(f,s+this.height-h)),h,0)}forEachLine(e,t,n,s,r,o){e=Math.max(e,r),t=Math.min(t,r+this.length);let{firstLine:l,perLine:a,perChar:c}=this.heightMetrics(n,r);for(let h=e,u=s;h<=t;){let f=n.doc.lineAt(h);if(h==e){let p=f.number-l;u+=a*p+c*(e-r-p)}let d=a+c*f.length;o(new lt(f.from,f.length,u,d,0)),u+=d,h=f.to+1}}replace(e,t,n){let s=this.length-t;if(s>0){let r=n[n.length-1];r instanceof me?n[n.length-1]=new me(r.length+s):n.push(null,new me(s-1))}if(e>0){let r=n[0];r instanceof me?n[0]=new me(e+r.length):n.unshift(new me(e-1),null)}return Pe.of(n)}decomposeLeft(e,t){t.push(new me(e-1),null)}decomposeRight(e,t){t.push(null,new me(this.length-e-1))}updateHeight(e,t=0,n=!1,s){let r=t+this.length;if(s&&s.from<=t+this.length&&s.more){let o=[],l=Math.max(t,s.from),a=-1;for(s.from>t&&o.push(new me(s.from-t-1).updateHeight(e,t));l<=r&&s.more;){let h=e.doc.lineAt(l).length;o.length&&o.push(null);let u=s.heights[s.index++];a==-1?a=u:Math.abs(u-a)>=ks&&(a=-2);let f=new Be(h,u);f.outdated=!1,o.push(f),l+=h+1}l<=r&&o.push(null,new me(r-l).updateHeight(e,l));let c=Pe.of(o);return(a<0||Math.abs(c.height-this.height)>=ks||Math.abs(a-this.heightMetrics(e,t).perLine)>=ks)&&(Tn=!0),Is(this,c)}else(n||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Sb extends Pe{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,t,n,s){let r=n+this.left.height;return e<r?this.left.blockAt(e,t,n,s):this.right.blockAt(e,t,r,s+this.left.length+this.break)}lineAt(e,t,n,s,r){let o=s+this.left.height,l=r+this.left.length+this.break,a=t==ie.ByHeight?e<o:e<l,c=a?this.left.lineAt(e,t,n,s,r):this.right.lineAt(e,t,n,o,l);if(this.break||(a?c.to<l:c.from>l))return c;let h=t==ie.ByPosNoHeight?ie.ByPosNoHeight:ie.ByPos;return a?c.join(this.right.lineAt(l,h,n,o,l)):this.left.lineAt(l,h,n,s,r).join(c)}forEachLine(e,t,n,s,r,o){let l=s+this.left.height,a=r+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,n,s,r,o),t>=a&&this.right.forEachLine(e,t,n,l,a,o);else{let c=this.lineAt(a,ie.ByPos,n,s,r);e<c.from&&this.left.forEachLine(e,c.from-1,n,s,r,o),c.to>=e&&c.from<=t&&o(c),t>c.to&&this.right.forEachLine(c.to+1,t,n,l,a,o)}}replace(e,t,n){let s=this.left.length+this.break;if(t<s)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,t-s,n));let r=[];e>0&&this.decomposeLeft(e,r);let o=r.length;for(let l of n)r.push(l);if(e>0&&fc(r,o-1),t<this.length){let l=r.length;this.decomposeRight(t,r),fc(r,l)}return Pe.of(r)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,s=n+this.break;if(e>=s)return this.right.decomposeRight(e-s,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<s&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Pe.of(this.break?[e,null,t]:[e,t]):(this.left=Is(this.left,e),this.right=Is(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,s){let{left:r,right:o}=this,l=t+r.length+this.break,a=null;return s&&s.from<=t+r.length&&s.more?a=r=r.updateHeight(e,t,n,s):r.updateHeight(e,t,n),s&&s.from<=l+o.length&&s.more?a=o=o.updateHeight(e,l,n,s):o.updateHeight(e,l,n),a?this.balanced(r,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function fc(i,e){let t,n;i[e]==null&&(t=i[e-1])instanceof me&&(n=i[e+1])instanceof me&&i.splice(e-1,3,new me(t.length+1+n.length))}const Cb=5;class dl{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let n=Math.min(t,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof Be?s.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Be(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let s=n.widget?n.widget.estimatedHeight:0,r=n.widget?n.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let o=t-e;n.block?this.addBlock(new kf(o,s,n)):(o||r||s>=Cb)&&this.addLineDeco(s,r,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Be(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new me(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Be)return e;let t=new Be(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let s=this.ensureLine();s.length+=n,s.collapsed+=n,s.widgetHeight=Math.max(s.widgetHeight,e),s.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Be)&&!this.isCovered?this.nodes.push(new Be(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let s of this.nodes)s instanceof Be&&s.updateHeight(this.oracle,n),n+=s?s.length:1;return this.nodes}static build(e,t,n,s){let r=new dl(n,e);return K.spans(t,n,s,r,0),r.finish(n)}}function _b(i,e,t){let n=new Ab;return K.compare(i,e,t,n,0),n.changes}class Ab{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,s){(e<t||n&&n.heightRelevant||s&&s.heightRelevant)&&vo(e,t,this.changes,5)}}function Pb(i,e){let t=i.getBoundingClientRect(),n=i.ownerDocument,s=n.defaultView||window,r=Math.max(0,t.left),o=Math.min(s.innerWidth,t.right),l=Math.max(0,t.top),a=Math.min(s.innerHeight,t.bottom);for(let c=i.parentNode;c&&c!=n.body;)if(c.nodeType==1){let h=c,u=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&u.overflow!="visible"){let f=h.getBoundingClientRect();r=Math.max(r,f.left),o=Math.min(o,f.right),l=Math.max(l,f.top),a=Math.min(c==i.parentNode?s.innerHeight:a,f.bottom)}c=u.position=="absolute"||u.position=="fixed"?h.offsetParent:h.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:r-t.left,right:Math.max(r,o)-t.left,top:l-(t.top+e),bottom:Math.max(l,a)-(t.top+e)}}function Eb(i,e){let t=i.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class _r{constructor(e,t,n,s){this.from=e,this.to=t,this.size=n,this.displaySize=s}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let s=e[n],r=t[n];if(s.from!=r.from||s.to!=r.to||s.size!=r.size)return!1}return!0}draw(e,t){return V.replace({widget:new Tb(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class Tb extends Nn{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class dc{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=pc,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=le.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(cl).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new kb(t),this.stateDeco=e.facet(Si).filter(n=>typeof n!="function"),this.heightMap=Pe.empty().applyChanges(this.stateDeco,j.empty,this.heightOracle.setDoc(e.doc),[new We(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=V.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let s=n?t.head:t.anchor;if(!e.some(({from:r,to:o})=>s>=r&&s<=o)){let{from:r,to:o}=this.lineBlockAt(s);e.push(new Zi(r,o))}}return this.viewports=e.sort((n,s)=>n.from-s.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?pc:new pl(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(ti(e,this.scaler))})}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Si).filter(h=>typeof h!="function");let s=e.changedRanges,r=We.extendWithRanges(s,_b(n,this.stateDeco,e?e.changes:pe.empty(this.state.doc.length))),o=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);uc(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),r),(this.heightMap.height!=o||Tn)&&(e.flags|=2),l?(this.scrollAnchorPos=e.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let a=r.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let c=a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(D0)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),s=this.heightOracle,r=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?le.RTL:le.LTR;let o=this.heightOracle.mustRefreshForWrapping(r),l=t.getBoundingClientRect(),a=o||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let c=0,h=0;if(l.width&&l.height){let{scaleX:w,scaleY:k}=Ru(t,l);(w>.005&&Math.abs(this.scaleX-w)>.005||k>.005&&Math.abs(this.scaleY-k)>.005)&&(this.scaleX=w,this.scaleY=k,c|=8,o=a=!0)}let u=(parseInt(n.paddingTop)||0)*this.scaleY,f=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=u||this.paddingBottom!=f)&&(this.paddingTop=u,this.paddingBottom=f,c|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=8);let d=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=Du(e.scrollDOM);let p=(this.printing?Eb:Pb)(t,this.paddingTop),m=p.top-this.pixelViewport.top,b=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let y=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(y!=this.inView&&(this.inView=y,y&&(a=!0)),!this.inView&&!this.scrollTarget)return 0;let v=l.width;if((this.contentDOMWidth!=v||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=e.scrollDOM.clientHeight,c|=8),a){let w=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(w)&&(o=!0),o||s.lineWrapping&&Math.abs(v-this.contentDOMWidth)>s.charWidth){let{lineHeight:k,charWidth:_,textHeight:E}=e.docView.measureTextSize();o=k>0&&s.refresh(r,k,_,E,v/_,w),o&&(e.docView.minWidth=0,c|=8)}m>0&&b>0?h=Math.max(m,b):m<0&&b<0&&(h=Math.min(m,b)),uc();for(let k of this.viewports){let _=k.from==this.viewport.from?w:e.docView.measureVisibleLineHeights(k);this.heightMap=(o?Pe.empty().applyChanges(this.stateDeco,j.empty,this.heightOracle,[new We(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,o,new wb(k.from,_))}Tn&&(c|=2)}let x=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return x&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),c|=this.updateForViewport()),(c&2||x)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,r=this.heightOracle,{visibleTop:o,visibleBottom:l}=this,a=new Zi(s.lineAt(o-n*1e3,ie.ByHeight,r,0,0).from,s.lineAt(l+(1-n)*1e3,ie.ByHeight,r,0,0).to);if(t){let{head:c}=t.range;if(c<a.from||c>a.to){let h=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),u=s.lineAt(c,ie.ByPos,r,0,0),f;t.y=="center"?f=(u.top+u.bottom)/2-h/2:t.y=="start"||t.y=="nearest"&&c<a.from?f=u.top:f=u.bottom-h,a=new Zi(s.lineAt(f-1e3/2,ie.ByHeight,r,0,0).from,s.lineAt(f+h+1e3/2,ie.ByHeight,r,0,0).to)}}return a}mapViewport(e,t){let n=t.mapPos(e.from,-1),s=t.mapPos(e.to,1);return new Zi(this.heightMap.lineAt(n,ie.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,ie.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,ie.ByPos,this.heightOracle,0,0),{bottom:r}=this.heightMap.lineAt(t,ie.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:l}=this;return(e==0||s<=o-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||r>=l+Math.max(10,Math.min(n,250)))&&s>o-2*1e3&&r<l+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let s of e)t.touchesRange(s.from,s.to)||n.push(new _r(t.mapPos(s.from),t.mapPos(s.to),s.size,s.displaySize));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,s=n?1e4:2e3,r=s>>1,o=s<<1;if(this.defaultTextDirection!=le.LTR&&!n)return[];let l=[],a=(h,u,f,d)=>{if(u-h<r)return;let p=this.state.selection.main,m=[p.from];p.empty||m.push(p.to);for(let y of m)if(y>h&&y<u){a(h,y-10,f,d),a(y+10,u,f,d);return}let b=Mb(e,y=>y.from>=f.from&&y.to<=f.to&&Math.abs(y.from-h)<r&&Math.abs(y.to-u)<r&&!m.some(v=>y.from<v&&y.to>v));if(!b){if(u<f.to&&t&&n&&t.visibleRanges.some(x=>x.from<=u&&x.to>=u)){let x=t.moveToLineBoundary(C.cursor(u),!1,!0).head;x>h&&(u=x)}let y=this.gapSize(f,h,u,d),v=n||y<2e6?y:2e6;b=new _r(h,u,y,v)}l.push(b)},c=h=>{if(h.length<o||h.type!=Xe.Text)return;let u=Rb(h.from,h.to,this.stateDeco);if(u.total<o)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,d,p;if(n){let m=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,b,y;if(f!=null){let v=es(u,f),x=((this.visibleBottom-this.visibleTop)/2+m)/h.height;b=v-x,y=v+x}else b=(this.visibleTop-h.top-m)/h.height,y=(this.visibleBottom-h.top+m)/h.height;d=Ji(u,b),p=Ji(u,y)}else{let m=u.total*this.heightOracle.charWidth,b=s*this.heightOracle.charWidth,y=0;if(m>2e6)for(let _ of e)_.from>=h.from&&_.from<h.to&&_.size!=_.displaySize&&_.from*this.heightOracle.charWidth+y<this.pixelViewport.left&&(y=_.size-_.displaySize);let v=this.pixelViewport.left+y,x=this.pixelViewport.right+y,w,k;if(f!=null){let _=es(u,f),E=((x-v)/2+b)/m;w=_-E,k=_+E}else w=(v-b)/m,k=(x+b)/m;d=Ji(u,w),p=Ji(u,k)}d>h.from&&a(h.from,d,h,u),p<h.to&&a(p,h.to,h,u)};for(let h of this.viewportLines)Array.isArray(h.type)?h.type.forEach(c):c(h);return l}gapSize(e,t,n,s){let r=es(s,n)-es(s,t);return this.heightOracle.lineWrapping?e.height*r:s.total*this.heightOracle.charWidth*r}updateLineGaps(e){_r.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=V.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];K.spans(e,this.viewport.from,this.viewport.to,{span(s,r){t.push({from:s,to:r})},point(){}},20);let n=t.length!=this.visibleRanges.length||this.visibleRanges.some((s,r)=>s.from!=t[r].from||s.to!=t[r].to);return this.visibleRanges=t,n?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||ti(this.heightMap.lineAt(e,ie.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||ti(this.heightMap.lineAt(this.scaler.fromDOM(e),ie.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return ti(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Zi{constructor(e,t){this.from=e,this.to=t}}function Rb(i,e,t){let n=[],s=i,r=0;return K.spans(t,i,e,{span(){},point(o,l){o>s&&(n.push({from:s,to:o}),r+=o-s),s=l}},20),s<e&&(n.push({from:s,to:e}),r+=e-s),{total:r,ranges:n}}function Ji({total:i,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let n=Math.floor(i*t);for(let s=0;;s++){let{from:r,to:o}=e[s],l=o-r;if(n<=l)return r+n;n-=l}}function es(i,e){let t=0;for(let{from:n,to:s}of i.ranges){if(e<=s){t+=e-n;break}t+=s-n}return t/i.total}function Mb(i,e){for(let t of i)if(e(t))return t}const pc={toDOM(i){return i},fromDOM(i){return i},scale:1,eq(i){return i==this}};class pl{constructor(e,t,n){let s=0,r=0,o=0;this.viewports=n.map(({from:l,to:a})=>{let c=t.lineAt(l,ie.ByPos,e,0,0).top,h=t.lineAt(a,ie.ByPos,e,0,0).bottom;return s+=h-c,{from:l,to:a,top:c,bottom:h,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(t.height-s);for(let l of this.viewports)l.domTop=o+(l.top-r)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),r=l.bottom}toDOM(e){for(let t=0,n=0,s=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.top)return s+(e-n)*this.scale;if(e<=r.bottom)return r.domTop+(e-r.top);n=r.bottom,s=r.domBottom}}fromDOM(e){for(let t=0,n=0,s=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.domTop)return n+(e-s)/this.scale;if(e<=r.domBottom)return r.top+(e-r.domTop);n=r.bottom,s=r.domBottom}}eq(e){return e instanceof pl?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,n)=>t.from==e.viewports[n].from&&t.to==e.viewports[n].to):!1}}function ti(i,e){if(e.scale==1)return i;let t=e.toDOM(i.top),n=e.toDOM(i.bottom);return new lt(i.from,i.length,t,n-t,Array.isArray(i._content)?i._content.map(s=>ti(s,e)):i._content)}const ts=D.define({combine:i=>i.join(" ")}),Ao=D.define({combine:i=>i.indexOf(!0)>-1}),Po=Dt.newName(),wf=Dt.newName(),Sf=Dt.newName(),Cf={"&light":"."+wf,"&dark":"."+Sf};function Eo(i,e,t){return new Dt(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,s=>{if(s=="&")return i;if(!t||!t[s])throw new RangeError(`Unsupported selector: ${s}`);return t[s]}):i+" "+n}})}const $b=Eo("."+Po,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Cf),Db={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Ar=$.ie&&$.ie_version<=11;class Bb{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new m0,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let n of t)this.queue.push(n);($.ie&&$.ie_version<=11||$.ios&&e.composing)&&t.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!($.chrome&&$.chrome_version<126)&&(this.editContext=new Ib(e),e.state.facet(_t)&&(e.contentDOM.editContext=this.editContext.editContext)),Ar&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,s=this.selectionRange;if(n.state.facet(_t)?n.root.activeElement!=this.dom:!xs(this.dom,s))return;let r=s.anchorNode&&n.docView.nearest(s.anchorNode);if(r&&r.ignoreEvent(e)){t||(this.selectionChanged=!1);return}($.ie&&$.ie_version<=11||$.android&&$.chrome)&&!n.state.selection.main.empty&&s.focusNode&&li(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=wi(e.root);if(!t)return!1;let n=$.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&Lb(this.view,t)||t;if(!n||this.selectionRange.eq(n))return!1;let s=xs(this.dom,n);return s&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&y0(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),s&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(n.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=t)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Db),Ar&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Ar&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let s=()=>{let r=this.delayedAndroidKey;r&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=r.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&r.force&&vn(this.dom,r.key,r.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,s=!1;for(let r of e){let o=this.readMutation(r);o&&(o.typeOver&&(s=!0),t==-1?{from:t,to:n}=o:(t=Math.min(o.from,t),n=Math.max(o.to,n)))}return{from:t,to:n,typeOver:s}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),s=this.selectionChanged&&xs(this.dom,this.selectionRange);if(e<0&&!s)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let r=new eb(this.view,e,t,n);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,s=df(this.view,t);return this.view.state==n&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),s}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let n=gc(t,e.previousSibling||e.target.previousSibling,-1),s=gc(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:s?t.posBefore(s):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(_t)!=e.state.facet(_t)&&(e.view.contentDOM.editContext=e.state.facet(_t)?this.editContext.editContext:null))}destroy(){var e,t,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function gc(i,e,t){for(;e;){let n=te.get(e);if(n&&n.parent==i)return n;let s=e.parentNode;e=s!=i.dom?s:t>0?e.nextSibling:e.previousSibling}return null}function mc(i,e){let t=e.startContainer,n=e.startOffset,s=e.endContainer,r=e.endOffset,o=i.docView.domAtPos(i.state.selection.main.anchor);return li(o.node,o.offset,s,r)&&([t,n,s,r]=[s,r,t,n]),{anchorNode:t,anchorOffset:n,focusNode:s,focusOffset:r}}function Lb(i,e){if(e.getComposedRanges){let s=e.getComposedRanges(i.root)[0];if(s)return mc(i,s)}let t=null;function n(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return i.contentDOM.addEventListener("beforeinput",n,!0),i.dom.ownerDocument.execCommand("indent"),i.contentDOM.removeEventListener("beforeinput",n,!0),t?mc(i,t):null}class Ib{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let{anchor:s}=e.state.selection.main,r=this.toEditorPos(n.updateRangeStart),o=this.toEditorPos(n.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:r,drifted:!1});let l={from:r,to:o,insert:j.of(n.text.split(`
`))};l.from==this.from&&s<this.from?l.from=s:l.to==this.to&&s>this.to&&(l.to=s),!(l.from==l.to&&!l.insert.length)&&(this.pendingContextChange=l,e.state.readOnly||fl(e,l,C.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd))),this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)))},this.handlers.characterboundsupdate=n=>{let s=[],r=null;for(let o=this.toEditorPos(n.rangeStart),l=this.toEditorPos(n.rangeEnd);o<l;o++){let a=e.coordsForChar(o);r=a&&new DOMRect(a.left,a.top,a.right-a.left,a.bottom-a.top)||r||new DOMRect,s.push(r)}t.updateCharacterBounds(n.rangeStart,s)},this.handlers.textformatupdate=n=>{let s=[];for(let r of n.getTextFormats()){let o=r.underlineStyle,l=r.underlineThickness;if(o!="None"&&l!="None"){let a=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${l=="Thin"?1:2}px`;s.push(V.mark({attributes:{style:a}}).range(this.toEditorPos(r.rangeStart),this.toEditorPos(r.rangeEnd)))}}e.dispatch({effects:of.of(V.set(s))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:n}=this.composing;this.composing=null,n&&this.reset(e.state)}};for(let n in this.handlers)t.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let s=wi(n.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,n=!1,s=this.pendingContextChange;return e.changes.iterChanges((r,o,l,a,c)=>{if(n)return;let h=c.length-(o-r);if(s&&o>=s.to)if(s.from==r&&s.to==o&&s.insert.eq(c)){s=this.pendingContextChange=null,t+=h,this.to+=h;return}else s=null,this.revertPending(e.state);if(r+=t,o+=t,o<=this.from)this.from+=h,this.to+=h;else if(r<this.to){if(r<this.from||o>this.to||this.to-this.from+c.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(r),this.toContextPos(o),c.toString()),this.to+=h}t+=h}),s&&!n&&this.revertPending(e.state),!n}update(e){let t=this.pendingContextChange;this.composing&&(this.composing.drifted||e.transactions.some(n=>!n.isUserEvent("input.type")&&n.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),s=this.toContextPos(t.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(n,s)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e){let t=this.composing;return t&&t.drifted?t.editorBase+(e-t.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class T{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(s=>s.forEach(r=>n(r,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=e.root||b0(e.parent)||document,this.viewState=new dc(e.state||W.create(e)),e.scrollTo&&e.scrollTo.is(Ui)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Zn).map(s=>new wr(s));for(let s of this.plugins)s.update(this);this.observer=new Bb(this),this.inputState=new rb(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Ya(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof ve?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,s,r=this.state;for(let f of e){if(f.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=f.state}if(this.destroyed){this.viewState.state=r;return}let o=this.hasFocus,l=0,a=null;e.some(f=>f.annotation(vf))?(this.inputState.notifiedFocused=o,l=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,a=xf(r,o),a||(l=1));let c=this.observer.delayedAndroidKey,h=null;if(c?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(h=null)):this.observer.clear(),r.facet(W.phrases)!=this.state.facet(W.phrases))return this.setState(r);s=Ls.create(this,r,e),s.flags|=l;let u=this.viewState.scrollTarget;try{this.updateState=2;for(let f of e){if(u&&(u=u.map(f.changes)),f.scrollIntoView){let{main:d}=f.state.selection;u=new xn(d.empty?d:C.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of f.effects)d.is(Ui)&&(u=d.value.clip(this.state))}this.viewState.update(s,u),this.bidiCache=Fs.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),t=this.docView.update(s),this.state.facet(Jn)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(f=>f.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(ts)!=s.state.facet(ts)&&(this.viewState.mustMeasureContent=!0),(t||n||u||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!s.empty)for(let f of this.state.facet(So))try{f(s)}catch(d){Ae(this.state,d,"update listener")}(a||h)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),h&&!df(this,h)&&c.force&&vn(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new dc(e),this.plugins=e.facet(Zn).map(n=>new wr(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new Ya(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Zn),n=e.state.facet(Zn);if(t!=n){let s=[];for(let r of n){let o=t.indexOf(r);if(o<0)s.push(new wr(r));else{let l=this.plugins[o];l.mustUpdate=e,s.push(l)}}for(let r of this.plugins)r.mustUpdate!=e&&r.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(n){Ae(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,s=n.scrollTop*this.scaleY,{scrollAnchorPos:r,scrollAnchorHeight:o}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(o<0)if(Du(n))r=-1,o=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(s);r=d.from,o=d.top}this.updateState=1;let a=this.viewState.measure(this);if(!a&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];a&4||([this.measureRequests,c]=[c,this.measureRequests]);let h=c.map(d=>{try{return d.read(this)}catch(p){return Ae(this.state,p),bc}}),u=Ls.create(this,this.state,[]),f=!1;u.flags|=a,t?t.flags|=a:t=u,this.updateState=2,u.empty||(this.updatePlugins(u),this.inputState.update(u),this.updateAttrs(),f=this.docView.update(u),f&&this.docViewUpdate());for(let d=0;d<c.length;d++)if(h[d]!=bc)try{let p=c[d];p.write&&p.write(h[d],this)}catch(p){Ae(this.state,p)}if(f&&this.docView.updateSelection(!0),!u.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let p=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-o;if(p>1||p<-1){s=s+p,n.scrollTop=s/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let l of this.state.facet(So))l(t)}get themeClasses(){return Po+" "+(this.state.facet(Ao)?Sf:wf)+" "+this.state.facet(ts)}updateAttrs(){let e=yc(this,lf,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(_t)?"true":"false",class:"cm-content",style:`${$.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),yc(this,cl,t);let n=this.observer.ignore(()=>{let s=yo(this.contentDOM,this.contentAttrs,t),r=yo(this.dom,this.editorAttrs,e);return s||r});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let s of n.effects)if(s.is(T.announce)){t&&(this.announceDOM.textContent=""),t=!1;let r=this.announceDOM.appendChild(document.createElement("div"));r.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(Jn);let e=this.state.facet(T.cspNonce);Dt.mount(this.root,this.styleModules.concat($b).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(n=>n.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return Cr(this,e,Ja(this,e,t,n))}moveByGroup(e,t){return Cr(this,e,Ja(this,e,t,n=>G0(this,e.head,n)))}visualLineSide(e,t){let n=this.bidiSpans(e),s=this.textDirectionAt(e.from),r=n[t?n.length-1:0];return C.cursor(r.side(t,s)+e.from,r.forward(!t,s)?1:-1)}moveToLineBoundary(e,t,n=!0){return U0(this,e,t,n)}moveVertically(e,t,n){return Cr(this,e,K0(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),ff(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let s=this.state.doc.lineAt(e),r=this.bidiSpans(s),o=r[Mt.find(r,e-s.from,-1,t)];return Mi(n,o.dir==le.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(sf)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Fb)return Uu(e.length);let t=this.textDirectionAt(e.from),n;for(let r of this.bidiCache)if(r.from==e.from&&r.dir==t&&(r.fresh||Yu(r.isolates,n=ja(this,e))))return r.order;n||(n=ja(this,e));let s=R0(e.text,t,n);return this.bidiCache.push(new Fs(e.from,e.to,t,n,!0,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||$.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Mu(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Ui.of(new xn(typeof e=="number"?C.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return Ui.of(new xn(C.cursor(n.from),"start","start",n.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return $e.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return $e.define(()=>({}),{eventObservers:e})}static theme(e,t){let n=Dt.newName(),s=[ts.of(n),Jn.of(Eo(`.${n}`,e))];return t&&t.dark&&s.push(Ao.of(!0)),s}static baseTheme(e){return In.lowest(Jn.of(Eo("."+Po,e,Cf)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),s=n&&te.get(n)||te.get(e);return((t=s==null?void 0:s.rootView)===null||t===void 0?void 0:t.view)||null}}T.styleModule=Jn;T.inputHandler=tf;T.clipboardInputFilter=ll;T.clipboardOutputFilter=al;T.scrollHandler=rf;T.focusChangeEffect=nf;T.perLineTextDirection=sf;T.exceptionSink=ef;T.updateListener=So;T.editable=_t;T.mouseSelectionStyle=Ju;T.dragMovesSelection=Zu;T.clickAddsSelectionRange=Ku;T.decorations=Si;T.outerDecorations=af;T.atomicRanges=hl;T.bidiIsolatedRanges=cf;T.scrollMargins=hf;T.darkTheme=Ao;T.cspNonce=D.define({combine:i=>i.length?i[0]:""});T.contentAttributes=cl;T.editorAttributes=lf;T.lineWrapping=T.contentAttributes.of({class:"cm-lineWrapping"});T.announce=Y.define();const Fb=4096,bc={};class Fs{constructor(e,t,n,s,r,o){this.from=e,this.to=t,this.dir=n,this.isolates=s,this.fresh=r,this.order=o}static update(e,t){if(t.empty&&!e.some(r=>r.fresh))return e;let n=[],s=e.length?e[e.length-1].dir:le.LTR;for(let r=Math.max(0,e.length-10);r<e.length;r++){let o=e[r];o.dir==s&&!t.touchesRange(o.from,o.to)&&n.push(new Fs(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return n}}function yc(i,e,t){for(let n=i.state.facet(e),s=n.length-1;s>=0;s--){let r=n[s],o=typeof r=="function"?r(i):r;o&&bo(o,t)}return t}const Nb=$.mac?"mac":$.windows?"win":$.linux?"linux":"key";function qb(i,e){const t=i.split(/-(?!$)/);let n=t[t.length-1];n=="Space"&&(n=" ");let s,r,o,l;for(let a=0;a<t.length-1;++a){const c=t[a];if(/^(cmd|meta|m)$/i.test(c))l=!0;else if(/^a(lt)?$/i.test(c))s=!0;else if(/^(c|ctrl|control)$/i.test(c))r=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))e=="mac"?l=!0:r=!0;else throw new Error("Unrecognized modifier name: "+c)}return s&&(n="Alt-"+n),r&&(n="Ctrl-"+n),l&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function ns(i,e,t){return e.altKey&&(i="Alt-"+i),e.ctrlKey&&(i="Ctrl-"+i),e.metaKey&&(i="Meta-"+i),t!==!1&&e.shiftKey&&(i="Shift-"+i),i}const Qb=In.default(T.domEventHandlers({keydown(i,e){return Xb(Hb(e.state),i,e,"editor")}})),Bi=D.define({enables:Qb}),vc=new WeakMap;function Hb(i){let e=i.facet(Bi),t=vc.get(e);return t||vc.set(e,t=zb(e.reduce((n,s)=>n.concat(s),[]))),t}let At=null;const Vb=4e3;function zb(i,e=Nb){let t=Object.create(null),n=Object.create(null),s=(o,l)=>{let a=n[o];if(a==null)n[o]=l;else if(a!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},r=(o,l,a,c,h)=>{var u,f;let d=t[o]||(t[o]=Object.create(null)),p=l.split(/ (?!$)/).map(y=>qb(y,e));for(let y=1;y<p.length;y++){let v=p.slice(0,y).join(" ");s(v,!0),d[v]||(d[v]={preventDefault:!0,stopPropagation:!1,run:[x=>{let w=At={view:x,prefix:v,scope:o};return setTimeout(()=>{At==w&&(At=null)},Vb),!0}]})}let m=p.join(" ");s(m,!1);let b=d[m]||(d[m]={preventDefault:!1,stopPropagation:!1,run:((f=(u=d._any)===null||u===void 0?void 0:u.run)===null||f===void 0?void 0:f.slice())||[]});a&&b.run.push(a),c&&(b.preventDefault=!0),h&&(b.stopPropagation=!0)};for(let o of i){let l=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of l){let h=t[c]||(t[c]=Object.create(null));h._any||(h._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:u}=o;for(let f in h)h[f].run.push(d=>u(d,To))}let a=o[e]||o.key;if(a)for(let c of l)r(c,a,o.run,o.preventDefault,o.stopPropagation),o.shift&&r(c,"Shift-"+a,o.shift,o.preventDefault,o.stopPropagation)}return t}let To=null;function Xb(i,e,t,n){To=e;let s=f0(e),r=Ie(s,0),o=ot(r)==s.length&&s!=" ",l="",a=!1,c=!1,h=!1;At&&At.view==t&&At.scope==n&&(l=At.prefix+" ",gf.indexOf(e.keyCode)<0&&(c=!0,At=null));let u=new Set,f=b=>{if(b){for(let y of b.run)if(!u.has(y)&&(u.add(y),y(t)))return b.stopPropagation&&(h=!0),!0;b.preventDefault&&(b.stopPropagation&&(h=!0),c=!0)}return!1},d=i[n],p,m;return d&&(f(d[l+ns(s,e,!o)])?a=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!($.windows&&e.ctrlKey&&e.altKey)&&(p=Bt[e.keyCode])&&p!=s?(f(d[l+ns(p,e,!0)])||e.shiftKey&&(m=ki[e.keyCode])!=s&&m!=p&&f(d[l+ns(m,e,!1)]))&&(a=!0):o&&e.shiftKey&&f(d[l+ns(s,e,!0)])&&(a=!0),!a&&f(d._any)&&(a=!0)),c&&(a=!0),a&&h&&e.stopPropagation(),To=null,a}const Wb=!$.ios,xc={".cm-line":{},".cm-content":{}};Wb&&(xc[".cm-line"].caretColor=xc[".cm-content"].caretColor="transparent !important");class jb extends Nn{constructor(e){super(),this.content=e}toDOM(e){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),typeof this.content=="string"?t.setAttribute("aria-label","placeholder "+this.content):t.setAttribute("aria-hidden","true"),t}coordsAt(e){let t=e.firstChild?An(e.firstChild):[];if(!t.length)return null;let n=window.getComputedStyle(e.parentNode),s=Mi(t[0],n.direction!="rtl"),r=parseInt(n.lineHeight);return s.bottom-s.top>r*1.5?{left:s.left,right:s.right,top:s.top,bottom:s.top+r}:s}ignoreEvent(){return!1}}function _f(i){return $e.fromClass(class{constructor(e){this.view=e,this.placeholder=i?V.set([V.widget({widget:new jb(i),side:1}).range(0)]):V.none}get decorations(){return this.view.state.doc.length?V.none:this.placeholder}},{decorations:e=>e.decorations})}const Wn="-10000px";class Af{constructor(e,t,n,s){this.facet=t,this.createTooltipView=n,this.removeTooltipView=s,this.input=e.state.facet(t),this.tooltips=this.input.filter(o=>o);let r=null;this.tooltipViews=this.tooltips.map(o=>r=n(o,r))}update(e,t){var n;let s=e.state.facet(this.facet),r=s.filter(a=>a);if(s===this.input){for(let a of this.tooltipViews)a.update&&a.update(e);return!1}let o=[],l=t?[]:null;for(let a=0;a<r.length;a++){let c=r[a],h=-1;if(c){for(let u=0;u<this.tooltips.length;u++){let f=this.tooltips[u];f&&f.create==c.create&&(h=u)}if(h<0)o[a]=this.createTooltipView(c,a?o[a-1]:null),l&&(l[a]=!!c.above);else{let u=o[a]=this.tooltipViews[h];l&&(l[a]=t[h]),u.update&&u.update(e)}}}for(let a of this.tooltipViews)o.indexOf(a)<0&&(this.removeTooltipView(a),(n=a.destroy)===null||n===void 0||n.call(a));return t&&(l.forEach((a,c)=>t[c]=a),t.length=l.length),this.input=s,this.tooltips=r,this.tooltipViews=o,!0}}function Pf(i={}){return ws.of(i)}function Yb(i){let{win:e}=i;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const ws=D.define({combine:i=>{var e,t,n;return{position:$.ios?"absolute":((e=i.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=i.find(s=>s.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((n=i.find(s=>s.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||Yb}}}),Oc=new WeakMap,gl=$e.fromClass(class{constructor(i){this.view=i,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=i.state.facet(ws);this.position=e.position,this.parent=e.parent,this.classes=i.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new Af(i,ml,(t,n)=>this.createTooltip(t,n),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),i.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let i of this.manager.tooltipViews)this.intersectionObserver.observe(i.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(i){i.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(i,this.above);e&&this.observeIntersection();let t=e||i.geometryChanged,n=i.state.facet(ws);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;t=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(i,e){let t=i.create(this.view),n=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),i.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",t.dom.appendChild(s)}return t.dom.style.position=this.position,t.dom.style.top=Wn,t.dom.style.left="0px",this.container.insertBefore(t.dom,n),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var i,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(i=n.destroy)===null||i===void 0||i.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let i=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if($.gecko)t=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==Wn&&r.style.left=="0px"){let o=r.getBoundingClientRect();t=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(t||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(i=r.width/this.parent.offsetWidth,e=r.height/this.parent.offsetHeight)}else({scaleX:i,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),s=ul(this.view);return{visible:{left:n.left+s.left,top:n.top+s.top,right:n.right-s.right,bottom:n.bottom-s.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((r,o)=>{let l=this.manager.tooltipViews[o];return l.getCoords?l.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(ws).tooltipSpace(this.view),scaleX:i,scaleY:e,makeAbsolute:t}}writeMeasure(i){var e;if(i.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{visible:t,space:n,scaleX:s,scaleY:r}=i,o=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],c=this.manager.tooltipViews[l],{dom:h}=c,u=i.pos[l],f=i.size[l];if(!u||u.bottom<=Math.max(t.top,n.top)||u.top>=Math.min(t.bottom,n.bottom)||u.right<Math.max(t.left,n.left)-.1||u.left>Math.min(t.right,n.right)+.1){h.style.top=Wn;continue}let d=a.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,p=d?7:0,m=f.right-f.left,b=(e=Oc.get(c))!==null&&e!==void 0?e:f.bottom-f.top,y=c.offset||Gb,v=this.view.textDirection==le.LTR,x=f.width>n.right-n.left?v?n.left:n.right-f.width:v?Math.max(n.left,Math.min(u.left-(d?14:0)+y.x,n.right-m)):Math.min(Math.max(n.left,u.left-m+(d?14:0)-y.x),n.right-m),w=this.above[l];!a.strictSide&&(w?u.top-b-p-y.y<n.top:u.bottom+b+p+y.y>n.bottom)&&w==n.bottom-u.bottom>u.top-n.top&&(w=this.above[l]=!w);let k=(w?u.top-n.top:n.bottom-u.bottom)-p;if(k<b&&c.resize!==!1){if(k<this.view.defaultLineHeight){h.style.top=Wn;continue}Oc.set(c,b),h.style.height=(b=k)/r+"px"}else h.style.height&&(h.style.height="");let _=w?u.top-b-p-y.y:u.bottom+p+y.y,E=x+m;if(c.overlap!==!0)for(let F of o)F.left<E&&F.right>x&&F.top<_+b&&F.bottom>_&&(_=w?F.top-b-2-p:F.bottom+p+2);if(this.position=="absolute"?(h.style.top=(_-i.parent.top)/r+"px",h.style.left=(x-i.parent.left)/s+"px"):(h.style.top=_/r+"px",h.style.left=x/s+"px"),d){let F=u.left+(v?y.x:-y.x)-(x+14-7);d.style.left=F/s+"px"}c.overlap!==!0&&o.push({left:x,top:_,right:E,bottom:_+b}),h.classList.toggle("cm-tooltip-above",w),h.classList.toggle("cm-tooltip-below",!w),c.positioned&&c.positioned(i.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let i of this.manager.tooltipViews)i.dom.style.top=Wn}},{eventObservers:{scroll(){this.maybeMeasure()}}}),Ub=T.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Gb={x:0,y:0},ml=D.define({enables:[gl,Ub]}),Ns=D.define({combine:i=>i.reduce((e,t)=>e.concat(t),[])});class or{static create(e){return new or(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Af(e,Ns,(t,n)=>this.createHostedView(t,n),t=>t.dom.remove())}createHostedView(e,t){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let n of this.manager.tooltipViews){let s=n[e];if(s!==void 0){if(t===void 0)t=s;else if(t!==s)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const Kb=ml.compute([Ns],i=>{let e=i.facet(Ns);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var n;return(n=t.end)!==null&&n!==void 0?n:t.pos})),create:or.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class Zb{constructor(e,t,n,s,r){this.view=e,this.source=t,this.field=n,this.setHover=s,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,n=e.docView.nearest(t.target);if(!n)return;let s,r=1;if(n instanceof Rt)s=n.posAtStart;else{if(s=e.posAtCoords(t),s==null)return;let l=e.coordsAtPos(s);if(!l||t.y<l.top||t.y>l.bottom||t.x<l.left-e.defaultCharacterWidth||t.x>l.right+e.defaultCharacterWidth)return;let a=e.bidiSpans(e.state.doc.lineAt(s)).find(h=>h.from<=s&&h.to>=s),c=a&&a.dir==le.RTL?-1:1;r=t.x<l.left?-c:c}let o=this.source(e,s,r);if(o!=null&&o.then){let l=this.pending={pos:s};o.then(a=>{this.pending==l&&(this.pending=null,a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])}))},a=>Ae(e.state,a,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(gl),t=e?e.manager.tooltips.findIndex(n=>n.create==or.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:s,tooltip:r}=this;if(s.length&&r&&!Jb(r.dom,e)||this.pending){let{pos:o}=s[0]||this.pending,l=(n=(t=s[0])===null||t===void 0?void 0:t.end)!==null&&n!==void 0?n:o;(o==l?this.view.posAtCoords(this.lastMove)!=o:!e1(this.view,o,l,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:n}=this;n&&n.dom.contains(e.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=n=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const is=4;function Jb(i,e){let{left:t,right:n,top:s,bottom:r}=i.getBoundingClientRect(),o;if(o=i.querySelector(".cm-tooltip-arrow")){let l=o.getBoundingClientRect();s=Math.min(l.top,s),r=Math.max(l.bottom,r)}return e.clientX>=t-is&&e.clientX<=n+is&&e.clientY>=s-is&&e.clientY<=r+is}function e1(i,e,t,n,s,r){let o=i.scrollDOM.getBoundingClientRect(),l=i.documentTop+i.documentPadding.top+i.contentHeight;if(o.left>n||o.right<n||o.top>s||Math.min(o.bottom,l)<s)return!1;let a=i.posAtCoords({x:n,y:s},!1);return a>=e&&a<=t}function t1(i,e={}){let t=Y.define(),n=Fe.define({create(){return[]},update(s,r){if(s.length&&(e.hideOnChange&&(r.docChanged||r.selection)?s=[]:e.hideOn&&(s=s.filter(o=>!e.hideOn(r,o))),r.docChanged)){let o=[];for(let l of s){let a=r.changes.mapPos(l.pos,-1,ye.TrackDel);if(a!=null){let c=Object.assign(Object.create(null),l);c.pos=a,c.end!=null&&(c.end=r.changes.mapPos(c.end)),o.push(c)}}s=o}for(let o of r.effects)o.is(t)&&(s=o.value),o.is(n1)&&(s=[]);return s},provide:s=>Ns.from(s)});return{active:n,extension:[n,$e.define(s=>new Zb(s,i,n,t,e.hoverTime||300)),Kb]}}function Ef(i,e){let t=i.plugin(gl);if(!t)return null;let n=t.manager.tooltips.indexOf(e);return n<0?null:t.manager.tooltipViews[n]}const n1=Y.define(),kc=D.define({combine(i){let e,t;for(let n of i)e=e||n.topContainer,t=t||n.bottomContainer;return{topContainer:e,bottomContainer:t}}}),i1=$e.fromClass(class{constructor(i){this.input=i.state.facet(Ro),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(i));let e=i.state.facet(kc);this.top=new ss(i,!0,e.topContainer),this.bottom=new ss(i,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(i){let e=i.state.facet(kc);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new ss(i.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new ss(i.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=i.state.facet(Ro);if(t!=this.input){let n=t.filter(a=>a),s=[],r=[],o=[],l=[];for(let a of n){let c=this.specs.indexOf(a),h;c<0?(h=a(i.view),l.push(h)):(h=this.panels[c],h.update&&h.update(i)),s.push(h),(h.top?r:o).push(h)}this.specs=n,this.panels=s,this.top.sync(r),this.bottom.sync(o);for(let a of l)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}else for(let n of this.panels)n.update&&n.update(i)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:i=>T.scrollMargins.of(e=>{let t=e.plugin(i);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class ss{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=wc(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=wc(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function wc(i){let e=i.nextSibling;return i.remove(),e}const Ro=D.define({enables:i1});class nn extends Zt{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}nn.prototype.elementClass="";nn.prototype.toDOM=void 0;nn.prototype.mapMode=ye.TrackBefore;nn.prototype.startSide=nn.prototype.endSide=-1;nn.prototype.point=!0;const Pr=D.define(),s1=D.define(),Ss=D.define(),Sc=D.define({combine:i=>i.some(e=>e)});function r1(i){return[o1]}const o1=$e.fromClass(class{constructor(i){this.view=i,this.prevViewport=i.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=i.state.facet(Ss).map(e=>new _c(i,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!i.state.facet(Sc),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),i.scrollDOM.insertBefore(this.dom,i.contentDOM)}update(i){if(this.updateGutters(i)){let e=this.prevViewport,t=i.view.viewport,n=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(n<(t.to-t.from)*.8)}i.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(Sc)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=i.view.viewport}syncGutters(i){let e=this.dom.nextSibling;i&&this.dom.remove();let t=K.iter(this.view.state.facet(Pr),this.view.viewport.from),n=[],s=this.gutters.map(r=>new l1(r,this.view.viewport,-this.view.documentPadding.top));for(let r of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(r.type)){let o=!0;for(let l of r.type)if(l.type==Xe.Text&&o){Mo(t,n,l.from);for(let a of s)a.line(this.view,l,n);o=!1}else if(l.widget)for(let a of s)a.widget(this.view,l)}else if(r.type==Xe.Text){Mo(t,n,r.from);for(let o of s)o.line(this.view,r,n)}else if(r.widget)for(let o of s)o.widget(this.view,r);for(let r of s)r.finish();i&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(i){let e=i.startState.facet(Ss),t=i.state.facet(Ss),n=i.docChanged||i.heightChanged||i.viewportChanged||!K.eq(i.startState.facet(Pr),i.state.facet(Pr),i.view.viewport.from,i.view.viewport.to);if(e==t)for(let s of this.gutters)s.update(i)&&(n=!0);else{n=!0;let s=[];for(let r of t){let o=e.indexOf(r);o<0?s.push(new _c(this.view,r)):(this.gutters[o].update(i),s.push(this.gutters[o]))}for(let r of this.gutters)r.dom.remove(),s.indexOf(r)<0&&r.destroy();for(let r of s)this.dom.appendChild(r.dom);this.gutters=s}return n}destroy(){for(let i of this.gutters)i.destroy();this.dom.remove()}},{provide:i=>T.scrollMargins.of(e=>{let t=e.plugin(i);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==le.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function Cc(i){return Array.isArray(i)?i:[i]}function Mo(i,e,t){for(;i.value&&i.from<=t;)i.from==t&&e.push(i.value),i.next()}class l1{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=K.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:s}=this,r=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;if(this.i==s.elements.length){let l=new Tf(e,o,r,n);s.elements.push(l),s.dom.appendChild(l.dom)}else s.elements[this.i].update(e,o,r,n);this.height=t.bottom,this.i++}line(e,t,n){let s=[];Mo(this.cursor,s,t.from),n.length&&(s=s.concat(n));let r=this.gutter.config.lineMarker(e,t,s);r&&s.unshift(r);let o=this.gutter;s.length==0&&!o.config.renderEmptyElements||this.addElement(e,t,s)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t),s=n?[n]:null;for(let r of e.state.facet(s1)){let o=r(e,t.widget,t);o&&(s||(s=[])).push(o)}s&&this.addElement(e,t,s)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class _c{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,s=>{let r=s.target,o;if(r!=this.dom&&this.dom.contains(r)){for(;r.parentNode!=this.dom;)r=r.parentNode;let a=r.getBoundingClientRect();o=(a.top+a.bottom)/2}else o=s.clientY;let l=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[n](e,l,s)&&s.preventDefault()});this.markers=Cc(t.markers(e)),t.initialSpacer&&(this.spacer=new Tf(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Cc(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let n=e.view.viewport;return!K.eq(this.markers,t,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class Tf{constructor(e,t,n,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,s)}update(e,t,n,s){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),a1(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,t){let n="cm-gutterElement",s=this.dom.firstChild;for(let r=0,o=0;;){let l=o,a=r<t.length?t[r++]:null,c=!1;if(a){let h=a.elementClass;h&&(n+=" "+h);for(let u=o;u<this.markers.length;u++)if(this.markers[u].compare(a)){l=u,c=!0;break}}else l=this.markers.length;for(;o<l;){let h=this.markers[o++];if(h.toDOM){h.destroy(s);let u=s.nextSibling;s.remove(),s=u}}if(!a)break;a.toDOM&&(c?s=s.nextSibling:this.dom.insertBefore(a.toDOM(e),s)),c&&o++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}}function a1(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(!i[t].compare(e[t]))return!1;return!0}const c1=D.define(),h1=D.define(),dn=D.define({combine(i){return nr(i,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let s in t){let r=n[s],o=t[s];n[s]=r?(l,a,c)=>r(l,a,c)||o(l,a,c):o}return n}})}});class Er extends nn{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Tr(i,e){return i.state.facet(dn).formatNumber(e,i.state)}const u1=Ss.compute([dn],i=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(c1)},lineMarker(e,t,n){return n.some(s=>s.toDOM)?null:new Er(Tr(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,n)=>{for(let s of e.state.facet(h1)){let r=s(e,t,n);if(r)return r}return null},lineMarkerChange:e=>e.startState.facet(dn)!=e.state.facet(dn),initialSpacer(e){return new Er(Tr(e,Ac(e.state.doc.lines)))},updateSpacer(e,t){let n=Tr(t.view,Ac(t.view.state.doc.lines));return n==e.number?e:new Er(n)},domEventHandlers:i.facet(dn).domEventHandlers}));function Rf(i={}){return[dn.of(i),r1(),u1]}function Ac(i){let e=9;for(;e<i;)e=e*10+9;return e}var Rr;const pn=new N;function f1(i){return D.define({combine:i?e=>e.concat(i):void 0})}const d1=new N;class Ue{constructor(e,t,n=[],s=""){this.data=e,this.name=s,W.prototype.hasOwnProperty("tree")||Object.defineProperty(W.prototype,"tree",{get(){return de(this)}}),this.parser=t,this.extension=[Mn.of(this),W.languageData.of((r,o,l)=>{let a=Pc(r,o,l),c=a.type.prop(pn);if(!c)return[];let h=r.facet(c),u=a.type.prop(d1);if(u){let f=a.resolve(o-a.from,l);for(let d of u)if(d.test(f,r)){let p=r.facet(d.facet);return d.type=="replace"?p:p.concat(h)}}return h})].concat(n)}isActiveAt(e,t,n=-1){return Pc(e,t,n).type.prop(pn)==this.data}findRegions(e){let t=e.facet(Mn);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],s=(r,o)=>{if(r.prop(pn)==this.data){n.push({from:o,to:o+r.length});return}let l=r.prop(N.mounted);if(l){if(l.tree.prop(pn)==this.data){if(l.overlay)for(let a of l.overlay)n.push({from:a.from+o,to:a.to+o});else n.push({from:o,to:o+r.length});return}else if(l.overlay){let a=n.length;if(s(l.tree,l.overlay[0].from+o),n.length>a)return}}for(let a=0;a<r.children.length;a++){let c=r.children[a];c instanceof Z&&s(c,r.positions[a]+o)}};return s(de(e),0),n}get allowsNesting(){return!0}}Ue.setState=Y.define();function Pc(i,e,t){let n=i.facet(Mn),s=de(i).topNode;if(!n||n.allowsNesting)for(let r=s;r;r=r.enter(e,t,se.ExcludeBuffers))r.type.isTop&&(s=r);return s}class Ci extends Ue{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=f1(e.languageData);return new Ci(t,e.parser.configure({props:[pn.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new Ci(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function de(i){let e=i.field(Ue.state,!1);return e?e.tree:Z.empty}class p1{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}let jn=null;class qs{constructor(e,t,n=[],s,r,o,l,a){this.parser=e,this.state=t,this.fragments=n,this.tree=s,this.treeLen=r,this.viewport=o,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new qs(e,t,[],Z.empty,0,n,[],null)}startParse(){return this.parser.startParse(new p1(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Z.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let s=Date.now()+e;e=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(yt.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(yt.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=jn;jn=this;try{return e()}finally{jn=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Ec(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:s,treeLen:r,viewport:o,skipped:l}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((c,h,u,f)=>a.push({fromA:c,toA:h,fromB:u,toB:f})),n=yt.applyChanges(n,a),s=Z.empty,r=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){l=[];for(let c of this.skipped){let h=e.mapPos(c.from,1),u=e.mapPos(c.to,-1);h<u&&l.push({from:h,to:u})}}}return new qs(this.parser,t,n,s,r,o,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:s,to:r}=this.skipped[n];s<e.to&&r>e.from&&(this.fragments=Ec(this.fragments,s,r),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Zo{createParse(t,n,s){let r=s[0].from,o=s[s.length-1].to;return{parsedPos:r,advance(){let a=jn;if(a){for(let c of s)a.tempSkipped.push(c);e&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,e]):e)}return this.parsedPos=o,new Z(fe.none,[],[],o-r)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return jn}}function Ec(i,e,t){return yt.applyChanges(i,[{fromA:e,toA:t,fromB:e,toB:t}])}class Rn{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new Rn(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=qs.create(e.facet(Mn).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new Rn(n)}}Ue.state=Fe.define({create:Rn.init,update(i,e){for(let t of e.effects)if(t.is(Ue.setState))return t.value;return e.startState.facet(Mn)!=e.state.facet(Mn)?Rn.init(e.state):i.apply(e)}});let Mf=i=>{let e=setTimeout(()=>i(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(Mf=i=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(i,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const Mr=typeof navigator<"u"&&(!((Rr=navigator.scheduling)===null||Rr===void 0)&&Rr.isInputPending)?()=>navigator.scheduling.isInputPending():null,g1=$e.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Ue.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Ue.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=Mf(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:s}}=this.view,r=n.field(Ue.state);if(r.tree==r.context.tree&&r.context.isDone(s+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Mr?Math.max(25,e.timeRemaining()-5):1e9),l=r.context.treeLen<s&&n.doc.length>s+1e3,a=r.context.work(()=>Mr&&Mr()||Date.now()>o,s+(l?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:Ue.setState.of(new Rn(r.context))})),this.chunkBudget>0&&!(a&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Ae(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Mn=D.define({combine(i){return i.length?i[0]:null},enables:i=>[Ue.state,g1,T.contentAttributes.compute([i],e=>{let t=e.facet(i);return t&&t.name?{"data-language":t.name}:{}})]});class $f{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const m1=D.define(),lr=D.define({combine:i=>{if(!i.length)return"  ";let e=i[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(i[0]));return e}});function Qs(i){let e=i.facet(lr);return e.charCodeAt(0)==9?i.tabSize*e.length:e.length}function _i(i,e){let t="",n=i.tabSize,s=i.facet(lr)[0];if(s=="	"){for(;e>=n;)t+="	",e-=n;s=" "}for(let r=0;r<e;r++)t+=s;return t}function bl(i,e){i instanceof W&&(i=new ar(i));for(let n of i.state.facet(m1)){let s=n(i,e);if(s!==void 0)return s}let t=de(i.state);return t.length>=e?b1(i,t,e):null}class ar{constructor(e,t={}){this.state=e,this.options=t,this.unit=Qs(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:s,simulateDoubleBreak:r}=this.options;return s!=null&&s>=n.from&&s<=n.to?r&&s==e?{text:"",from:e}:(t<0?s<e:s<=e)?{text:n.text.slice(s-n.from),from:s}:{text:n.text.slice(0,s-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:s}=this.lineAt(e,t);return n.slice(e-s,Math.min(n.length,e+100-s))}column(e,t=1){let{text:n,from:s}=this.lineAt(e,t),r=this.countColumn(n,e-s),o=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return o>-1&&(r+=o-this.countColumn(n,n.search(/\S|$/))),r}countColumn(e,t=e.length){return ir(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:s}=this.lineAt(e,t),r=this.options.overrideIndentation;if(r){let o=r(s);if(o>-1)return o}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Df=new N;function b1(i,e,t){let n=e.resolveStack(t),s=n.node.enterUnfinishedNodesBefore(t);if(s!=n.node){let r=[];for(let o=s;o!=n.node;o=o.parent)r.push(o);for(let o=r.length-1;o>=0;o--)n={node:r[o],next:n}}return Bf(n,i,t)}function Bf(i,e,t){for(let n=i;n;n=n.next){let s=v1(n.node);if(s)return s(yl.create(e,t,n))}return 0}function y1(i){return i.pos==i.options.simulateBreak&&i.options.simulateDoubleBreak}function v1(i){let e=i.type.prop(Df);if(e)return e;let t=i.firstChild,n;if(t&&(n=t.type.prop(N.closedBy))){let s=i.lastChild,r=s&&n.indexOf(s.name)>-1;return o=>Lf(o,!0,1,void 0,r&&!y1(o)?s.from:void 0)}return i.parent==null?x1:null}function x1(){return 0}class yl extends ar{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.context=n}get node(){return this.context.node}static create(e,t,n){return new yl(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(t.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(O1(n,e))break;t=this.state.doc.lineAt(n.from)}return this.lineIndent(t.from)}continue(){return Bf(this.context.next,this.base,this.pos)}}function O1(i,e){for(let t=e;t;t=t.parent)if(i==t)return!0;return!1}function k1(i){let e=i.node,t=e.childAfter(e.from),n=e.lastChild;if(!t)return null;let s=i.options.simulateBreak,r=i.state.doc.lineAt(t.from),o=s==null||s<=r.from?r.to:Math.min(r.to,s);for(let l=t.to;;){let a=e.childAfter(l);if(!a||a==n)return null;if(!a.type.isSkipped){if(a.from>=o)return null;let c=/^ */.exec(r.text.slice(t.to-r.from))[0].length;return{from:t.from,to:t.to+c}}l=a.to}}function Tc({closing:i,align:e=!0,units:t=1}){return n=>Lf(n,e,t,i)}function Lf(i,e,t,n,s){let r=i.textAfter,o=r.match(/^\s*/)[0].length,l=n&&r.slice(o,o+n.length)==n||s==i.pos+o,a=e?k1(i):null;return a?l?i.column(a.from):i.column(a.to):i.baseIndent+(l?0:i.unit*t)}function $r({except:i,units:e=1}={}){return t=>{let n=i&&i.test(t.textAfter);return t.baseIndent+(n?0:e*t.unit)}}const w1=200;function If(){return W.transactionFilter.of(i=>{if(!i.docChanged||!i.isUserEvent("input.type")&&!i.isUserEvent("input.complete"))return i;let e=i.startState.languageDataAt("indentOnInput",i.startState.selection.main.head);if(!e.length)return i;let t=i.newDoc,{head:n}=i.newSelection.main,s=t.lineAt(n);if(n>s.from+w1)return i;let r=t.sliceString(s.from,n);if(!e.some(c=>c.test(r)))return i;let{state:o}=i,l=-1,a=[];for(let{head:c}of o.selection.ranges){let h=o.doc.lineAt(c);if(h.from==l)continue;l=h.from;let u=bl(o,h.from);if(u==null)continue;let f=/^\s*/.exec(h.text)[0],d=_i(o,u);f!=d&&a.push({from:h.from,to:h.from+f.length,insert:d})}return a.length?[i,{changes:a,sequential:!0}]:i})}const Ff=new N;function ci(i){let e=i.firstChild,t=i.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?i.to:t.from}:null}class Ft{constructor(e,t){this.specs=e;let n;function s(l){let a=Dt.newName();return(n||(n=Object.create(null)))["."+a]=l,a}const r=typeof t.all=="string"?t.all:t.all?s(t.all):void 0,o=t.scope;this.scope=o instanceof Ue?l=>l.prop(pn)==o.data:o?l=>l==o:void 0,this.style=eu(e.map(l=>({tag:l.tag,class:l.class||s(Object.assign({},l,{tag:null}))})),{all:r}).style,this.module=n?new Dt(n):null,this.themeType=t.themeType}static define(e,t){return new Ft(e,t||{})}}const $o=D.define(),S1=D.define({combine(i){return i.length?[i[0]]:null}});function Dr(i){let e=i.facet($o);return e.length?e:i.facet(S1)}function cr(i,e){let t=[_1],n;return i instanceof Ft&&(i.module&&t.push(T.styleModule.of(i.module)),n=i.themeType),n?t.push($o.computeN([T.darkTheme],s=>s.facet(T.darkTheme)==(n=="dark")?[i]:[])):t.push($o.of(i)),t}class C1{constructor(e){this.markCache=Object.create(null),this.tree=de(e.state),this.decorations=this.buildDeco(e,Dr(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=de(e.state),n=Dr(e.state),s=n!=Dr(e.startState),{viewport:r}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<r.to&&!s&&t.type==this.tree.type&&o>=r.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||s)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=r.to)}buildDeco(e,t){if(!t||!this.tree.length)return V.none;let n=new xi;for(let{from:s,to:r}of e.visibleRanges)qg(this.tree,t,(o,l,a)=>{n.add(o,l,this.markCache[a]||(this.markCache[a]=V.mark({class:a})))},s,r);return n.finish()}}const _1=In.high($e.fromClass(C1,{decorations:i=>i.decorations}));g.meta,g.link,g.heading,g.emphasis,g.strong,g.strikethrough,g.keyword,g.atom,g.bool,g.url,g.contentSeparator,g.labelName,g.literal,g.inserted,g.string,g.deleted,g.regexp,g.escape,g.string,g.variableName,g.variableName,g.typeName,g.namespace,g.className,g.variableName,g.macroName,g.propertyName,g.comment,g.invalid;const A1=T.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Nf=1e4,qf="()[]{}",Qf=D.define({combine(i){return nr(i,{afterCursor:!0,brackets:qf,maxScanDistance:Nf,renderMatch:T1})}}),P1=V.mark({class:"cm-matchingBracket"}),E1=V.mark({class:"cm-nonmatchingBracket"});function T1(i){let e=[],t=i.matched?P1:E1;return e.push(t.range(i.start.from,i.start.to)),i.end&&e.push(t.range(i.end.from,i.end.to)),e}const R1=Fe.define({create(){return V.none},update(i,e){if(!e.docChanged&&!e.selection)return i;let t=[],n=e.state.facet(Qf);for(let s of e.state.selection.ranges){if(!s.empty)continue;let r=ct(e.state,s.head,-1,n)||s.head>0&&ct(e.state,s.head-1,1,n)||n.afterCursor&&(ct(e.state,s.head,1,n)||s.head<e.state.doc.length&&ct(e.state,s.head+1,-1,n));r&&(t=t.concat(n.renderMatch(r,e.state)))}return V.set(t,!0)},provide:i=>T.decorations.from(i)}),M1=[R1,A1];function Hf(i={}){return[Qf.of(i),M1]}const $1=new N;function Do(i,e,t){let n=i.prop(e<0?N.openedBy:N.closedBy);if(n)return n;if(i.name.length==1){let s=t.indexOf(i.name);if(s>-1&&s%2==(e<0?1:0))return[t[s+e]]}return null}function Bo(i){let e=i.type.prop($1);return e?e(i.node):i}function ct(i,e,t,n={}){let s=n.maxScanDistance||Nf,r=n.brackets||qf,o=de(i),l=o.resolveInner(e,t);for(let a=l;a;a=a.parent){let c=Do(a.type,t,r);if(c&&a.from<a.to){let h=Bo(a);if(h&&(t>0?e>=h.from&&e<h.to:e>h.from&&e<=h.to))return D1(i,e,t,a,h,c,r)}}return B1(i,e,t,o,l.type,s,r)}function D1(i,e,t,n,s,r,o){let l=n.parent,a={from:s.from,to:s.to},c=0,h=l==null?void 0:l.cursor();if(h&&(t<0?h.childBefore(n.from):h.childAfter(n.to)))do if(t<0?h.to<=n.from:h.from>=n.to){if(c==0&&r.indexOf(h.type.name)>-1&&h.from<h.to){let u=Bo(h);return{start:a,end:u?{from:u.from,to:u.to}:void 0,matched:!0}}else if(Do(h.type,t,o))c++;else if(Do(h.type,-t,o)){if(c==0){let u=Bo(h);return{start:a,end:u&&u.from<u.to?{from:u.from,to:u.to}:void 0,matched:!1}}c--}}while(t<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}function B1(i,e,t,n,s,r,o){let l=t<0?i.sliceDoc(e-1,e):i.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=t>0)return null;let c={from:t<0?e-1:e,to:t>0?e+1:e},h=i.doc.iterRange(e,t>0?i.doc.length:0),u=0;for(let f=0;!h.next().done&&f<=r;){let d=h.value;t<0&&(f+=d.length);let p=e+f*t;for(let m=t>0?0:d.length-1,b=t>0?d.length:-1;m!=b;m+=t){let y=o.indexOf(d[m]);if(!(y<0||n.resolveInner(p+m,1).type!=s))if(y%2==0==t>0)u++;else{if(u==1)return{start:c,end:{from:p+m,to:p+m+1},matched:y>>1==a>>1};u--}}t>0&&(f+=d.length)}return h.done?{start:c,matched:!1}:null}const L1=Object.create(null),Rc=[fe.none],Mc=[],$c=Object.create(null),I1=Object.create(null);for(let[i,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])I1[i]=F1(L1,e);function Br(i,e){Mc.indexOf(i)>-1||(Mc.push(i),console.warn(e))}function F1(i,e){let t=[];for(let l of e.split(" ")){let a=[];for(let c of l.split(".")){let h=i[c]||g[c];h?typeof h=="function"?a.length?a=a.map(h):Br(c,`Modifier ${c} used at start of tag`):a.length?Br(c,`Tag ${c} used as modifier`):a=Array.isArray(h)?h:[h]:Br(c,`Unknown highlighting tag ${c}`)}for(let c of a)t.push(c)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),s=n+" "+t.map(l=>l.id),r=$c[s];if(r)return r.id;let o=$c[s]=fe.define({id:Rc.length,name:n,props:[Ri({[n]:t})]});return Rc.push(o),o.id}le.RTL,le.LTR;class Vf{constructor(e,t,n,s){this.state=e,this.pos=t,this.explicit=n,this.view=s,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=de(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),s=t.text.slice(n-t.from,this.pos-t.from),r=s.search(zf(e,!1));return r<0?null:{from:n+r,to:this.pos,text:s.slice(r)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,n){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function Dc(i){let e=Object.keys(i).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function N1(i){let e=Object.create(null),t=Object.create(null);for(let{label:s}of i){e[s[0]]=!0;for(let r=1;r<s.length;r++)t[s[r]]=!0}let n=Dc(e)+Dc(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function vl(i){let e=i.map(s=>typeof s=="string"?{label:s}:s),[t,n]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:N1(e);return s=>{let r=s.matchBefore(n);return r||s.explicit?{from:r?r.from:s.pos,options:e,validFor:t}:null}}function q1(i,e){return t=>{for(let n=de(t.state).resolveInner(t.pos,-1);n;n=n.parent){if(i.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(t)}}class Bc{constructor(e,t,n,s){this.completion=e,this.source=t,this.match=n,this.score=s}}function Gt(i){return i.selection.main.from}function zf(i,e){var t;let{source:n}=i,s=e&&n[0]!="^",r=n[n.length-1]!="$";return!s&&!r?i:new RegExp(`${s?"^":""}(?:${n})${r?"$":""}`,(t=i.flags)!==null&&t!==void 0?t:i.ignoreCase?"i":"")}const xl=on.define();function Q1(i,e,t,n){let{main:s}=i.selection,r=t-s.from,o=n-s.from;return Object.assign(Object.assign({},i.changeByRange(l=>{if(l!=s&&t!=n&&i.sliceDoc(l.from+r,l.from+o)!=i.sliceDoc(t,n))return{range:l};let a=i.toText(e);return{changes:{from:l.from+r,to:n==s.from?l.to:l.from+o,insert:a},range:C.cursor(l.from+r+a.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const Lc=new WeakMap;function H1(i){if(!Array.isArray(i))return i;let e=Lc.get(i);return e||Lc.set(i,e=vl(i)),e}const Hs=Y.define(),Ai=Y.define();class V1{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let n=Ie(e,t),s=ot(n);this.chars.push(n);let r=e.slice(t,t+s),o=r.toUpperCase();this.folded.push(Ie(o==r?r.toLowerCase():o,0)),t+=s}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:s,precise:r,byWord:o}=this;if(t.length==1){let v=Ie(e,0),x=ot(v),w=x==e.length?0:-100;if(v!=t[0])if(v==n[0])w+=-200;else return null;return this.ret(w,[0,x])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,c=0;if(l<0){for(let v=0,x=Math.min(e.length,200);v<x&&c<a;){let w=Ie(e,v);(w==t[c]||w==n[c])&&(s[c++]=v),v+=ot(w)}if(c<a)return null}let h=0,u=0,f=!1,d=0,p=-1,m=-1,b=/[a-z]/.test(e),y=!0;for(let v=0,x=Math.min(e.length,200),w=0;v<x&&u<a;){let k=Ie(e,v);l<0&&(h<a&&k==t[h]&&(r[h++]=v),d<a&&(k==t[d]||k==n[d]?(d==0&&(p=v),m=v+1,d++):d=0));let _,E=k<255?k>=48&&k<=57||k>=97&&k<=122?2:k>=65&&k<=90?1:0:(_=yu(k))!=_.toLowerCase()?1:_!=_.toUpperCase()?2:0;(!v||E==1&&b||w==0&&E!=0)&&(t[u]==k||n[u]==k&&(f=!0)?o[u++]=v:o.length&&(y=!1)),w=E,v+=ot(k)}return u==a&&o[0]==0&&y?this.result(-100+(f?-200:0),o,e):d==a&&p==0?this.ret(-200-e.length+(m==e.length?0:-100),[0,m]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):d==a?this.ret(-900-e.length,[p,m]):u==a?this.result(-100+(f?-200:0)+-700+(y?0:-1100),o,e):t.length==2?null:this.result((s[0]?-700:0)+-200+-1100,s,e)}result(e,t,n){let s=[],r=0;for(let o of t){let l=o+(this.astral?ot(Ie(n,o)):1);r&&s[r-1]==o?s[r-1]=l:(s[r++]=o,s[r++]=l)}return this.ret(e-n.length,s)}}class z1{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),n=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,t.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}const ge=D.define({combine(i){return nr(i,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:X1,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>Ic(e(n),t(n)),optionClass:(e,t)=>n=>Ic(e(n),t(n)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function Ic(i,e){return i?e?i+" "+e:i:e}function X1(i,e,t,n,s,r){let o=i.textDirection==le.RTL,l=o,a=!1,c="top",h,u,f=e.left-s.left,d=s.right-e.right,p=n.right-n.left,m=n.bottom-n.top;if(l&&f<Math.min(p,d)?l=!1:!l&&d<Math.min(p,f)&&(l=!0),p<=(l?f:d))h=Math.max(s.top,Math.min(t.top,s.bottom-m))-e.top,u=Math.min(400,l?f:d);else{a=!0,u=Math.min(400,(o?e.right:s.right-e.left)-30);let v=s.bottom-e.bottom;v>=m||v>e.top?h=t.bottom-e.top:(c="bottom",h=e.bottom-t.top)}let b=(e.bottom-e.top)/r.offsetHeight,y=(e.right-e.left)/r.offsetWidth;return{style:`${c}: ${h/b}px; max-width: ${u/y}px`,class:"cm-completionInfo-"+(a?o?"left-narrow":"right-narrow":l?"left":"right")}}function W1(i){let e=i.addToOptions.slice();return i.icons&&e.push({render(t){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),t.type&&n.classList.add(...t.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(t,n,s,r){let o=document.createElement("span");o.className="cm-completionLabel";let l=t.displayLabel||t.label,a=0;for(let c=0;c<r.length;){let h=r[c++],u=r[c++];h>a&&o.appendChild(document.createTextNode(l.slice(a,h)));let f=o.appendChild(document.createElement("span"));f.appendChild(document.createTextNode(l.slice(h,u))),f.className="cm-completionMatchedText",a=u}return a<l.length&&o.appendChild(document.createTextNode(l.slice(a))),o},position:50},{render(t){if(!t.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=t.detail,n},position:80}),e.sort((t,n)=>t.position-n.position).map(t=>t.render)}function Lr(i,e,t){if(i<=t)return{from:0,to:i};if(e<0&&(e=0),e<=i>>1){let s=Math.floor(e/t);return{from:s*t,to:(s+1)*t}}let n=Math.floor((i-e)/t);return{from:i-(n+1)*t,to:i-n*t}}class j1{constructor(e,t,n){this.view=e,this.stateField=t,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let s=e.state.field(t),{options:r,selected:o}=s.open,l=e.state.facet(ge);this.optionContent=W1(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=Lr(r.length,o,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",a=>{let{options:c}=e.state.field(t).open;for(let h=a.target,u;h&&h!=this.dom;h=h.parentNode)if(h.nodeName=="LI"&&(u=/-(\d+)$/.exec(h.id))&&+u[1]<c.length){this.applyCompletion(e,c[+u[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(ge).closeOnBlur&&a.relatedTarget!=e.contentDOM&&e.dispatch({effects:Ai.of(null)})}),this.showOptions(r,s.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let n=e.state.field(this.stateField),s=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=s){let{options:r,selected:o,disabled:l}=n.open;(!s.open||s.open.options!=r)&&(this.range=Lr(r.length,o,e.state.facet(ge).maxRenderedOptions),this.showOptions(r,n.id)),this.updateSel(),l!=((t=s.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of t.split(" "))n&&this.dom.classList.add(n);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=Lr(t.options.length,t.selected,this.view.state.facet(ge).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:n}=t.options[t.selected],{info:s}=n;if(!s)return;let r=typeof s=="string"?document.createTextNode(s):s(n);if(!r)return;"then"in r?r.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,n)}).catch(o=>Ae(this.view.state,o,"completion info")):this.addInfoPane(r,n)}}addInfoPane(e,t){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:s,destroy:r}=e;n.appendChild(s),this.infoDestroy=r||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,s=this.range.from;n;n=n.nextSibling,s++)n.nodeName!="LI"||!n.id?s--:s==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return t&&U1(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),s=e.getBoundingClientRect(),r=this.space;if(!r){let o=this.dom.ownerDocument.defaultView||window;r={left:0,top:0,right:o.innerWidth,bottom:o.innerHeight}}return s.top>Math.min(r.bottom,t.bottom)-10||s.bottom<Math.max(r.top,t.top)+10?null:this.view.state.facet(ge).positionInfo(this.view,t,s,n,r,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,n){const s=document.createElement("ul");s.id=t,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions"));let r=null;for(let o=n.from;o<n.to;o++){let{completion:l,match:a}=e[o],{section:c}=l;if(c){let f=typeof c=="string"?c:c.name;if(f!=r&&(o>n.from||n.from==0))if(r=f,typeof c!="string"&&c.header)s.appendChild(c.header(c));else{let d=s.appendChild(document.createElement("completion-section"));d.textContent=f}}const h=s.appendChild(document.createElement("li"));h.id=t+"-"+o,h.setAttribute("role","option");let u=this.optionClass(l);u&&(h.className=u);for(let f of this.optionContent){let d=f(l,this.view.state,this.view,a);d&&h.appendChild(d)}}return n.from&&s.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&s.classList.add("cm-completionListIncompleteBottom"),s}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function Y1(i,e){return t=>new j1(t,i,e)}function U1(i,e){let t=i.getBoundingClientRect(),n=e.getBoundingClientRect(),s=t.height/i.offsetHeight;n.top<t.top?i.scrollTop-=(t.top-n.top)/s:n.bottom>t.bottom&&(i.scrollTop+=(n.bottom-t.bottom)/s)}function Fc(i){return(i.boost||0)*100+(i.apply?10:0)+(i.info?5:0)+(i.type?1:0)}function G1(i,e){let t=[],n=null,s=c=>{t.push(c);let{section:h}=c.completion;if(h){n||(n=[]);let u=typeof h=="string"?h:h.name;n.some(f=>f.name==u)||n.push(typeof h=="string"?{name:u}:h)}},r=e.facet(ge);for(let c of i)if(c.hasResult()){let h=c.result.getMatch;if(c.result.filter===!1)for(let u of c.result.options)s(new Bc(u,c.source,h?h(u):[],1e9-t.length));else{let u=e.sliceDoc(c.from,c.to),f,d=r.filterStrict?new z1(u):new V1(u);for(let p of c.result.options)if(f=d.match(p.label)){let m=p.displayLabel?h?h(p,f.matched):[]:f.matched;s(new Bc(p,c.source,m,f.score+(p.boost||0)))}}}if(n){let c=Object.create(null),h=0,u=(f,d)=>{var p,m;return((p=f.rank)!==null&&p!==void 0?p:1e9)-((m=d.rank)!==null&&m!==void 0?m:1e9)||(f.name<d.name?-1:1)};for(let f of n.sort(u))h-=1e5,c[f.name]=h;for(let f of t){let{section:d}=f.completion;d&&(f.score+=c[typeof d=="string"?d:d.name])}}let o=[],l=null,a=r.compareCompletions;for(let c of t.sort((h,u)=>u.score-h.score||a(h.completion,u.completion))){let h=c.completion;!l||l.label!=h.label||l.detail!=h.detail||l.type!=null&&h.type!=null&&l.type!=h.type||l.apply!=h.apply||l.boost!=h.boost?o.push(c):Fc(c.completion)>Fc(l)&&(o[o.length-1]=c),l=c.completion}return o}class gn{constructor(e,t,n,s,r,o){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=s,this.selected=r,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new gn(this.options,Nc(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,n,s,r,o){if(s&&!o&&e.some(c=>c.isPending))return s.setDisabled();let l=G1(e,t);if(!l.length)return s&&e.some(c=>c.isPending)?s.setDisabled():null;let a=t.facet(ge).selectOnOpen?0:-1;if(s&&s.selected!=a&&s.selected!=-1){let c=s.options[s.selected].completion;for(let h=0;h<l.length;h++)if(l[h].completion==c){a=h;break}}return new gn(l,Nc(n,a),{pos:e.reduce((c,h)=>h.hasResult()?Math.min(c,h.from):c,1e8),create:ny,above:r.aboveCursor},s?s.timestamp:Date.now(),a,!1)}map(e){return new gn(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new gn(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Vs{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new Vs(ey,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,n=t.facet(ge),r=(n.override||t.languageDataAt("autocomplete",Gt(t)).map(H1)).map(a=>(this.active.find(h=>h.source==a)||new ze(a,this.active.some(h=>h.state!=0)?1:0)).update(e,n));r.length==this.active.length&&r.every((a,c)=>a==this.active[c])&&(r=this.active);let o=this.open,l=e.effects.some(a=>a.is(Ol));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||r.some(a=>a.hasResult()&&e.changes.touchesRange(a.from,a.to))||!K1(r,this.active)||l?o=gn.build(r,t,this.id,o,n,l):o&&o.disabled&&!r.some(a=>a.isPending)&&(o=null),!o&&r.every(a=>!a.isPending)&&r.some(a=>a.hasResult())&&(r=r.map(a=>a.hasResult()?new ze(a.source,0):a));for(let a of e.effects)a.is(Wf)&&(o=o&&o.setSelected(a.value,this.id));return r==this.active&&o==this.open?this:new Vs(r,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?Z1:J1}}function K1(i,e){if(i==e)return!0;for(let t=0,n=0;;){for(;t<i.length&&!i[t].hasResult();)t++;for(;n<e.length&&!e[n].hasResult();)n++;let s=t==i.length,r=n==e.length;if(s||r)return s==r;if(i[t++].result!=e[n++].result)return!1}}const Z1={"aria-autocomplete":"list"},J1={};function Nc(i,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":i};return e>-1&&(t["aria-activedescendant"]=i+"-"+e),t}const ey=[];function Xf(i,e){if(i.isUserEvent("input.complete")){let n=i.annotation(xl);if(n&&e.activateOnCompletion(n))return 12}let t=i.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:i.isUserEvent("delete.backward")?2:i.selection?8:i.docChanged?16:0}class ze{constructor(e,t,n=!1){this.source=e,this.state=t,this.explicit=n}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let n=Xf(e,t),s=this;(n&8||n&16&&this.touches(e))&&(s=new ze(s.source,0)),n&4&&s.state==0&&(s=new ze(this.source,1)),s=s.updateFor(e,n);for(let r of e.effects)if(r.is(Hs))s=new ze(s.source,1,r.value);else if(r.is(Ai))s=new ze(s.source,0);else if(r.is(Ol))for(let o of r.value)o.source==s.source&&(s=o);return s}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Gt(e.state))}}class On extends ze{constructor(e,t,n,s,r,o){super(e,3,t),this.limit=n,this.result=s,this.from=r,this.to=o}hasResult(){return!0}updateFor(e,t){var n;if(!(t&3))return this.map(e.changes);let s=this.result;s.map&&!e.changes.empty&&(s=s.map(s,e.changes));let r=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),l=Gt(e.state);if(l>o||!s||t&2&&(Gt(e.startState)==this.from||l<this.limit))return new ze(this.source,t&4?1:0);let a=e.changes.mapPos(this.limit);return ty(s.validFor,e.state,r,o)?new On(this.source,this.explicit,a,s,r,o):s.update&&(s=s.update(s,r,o,new Vf(e.state,l,!1)))?new On(this.source,this.explicit,a,s,s.from,(n=s.to)!==null&&n!==void 0?n:Gt(e.state)):new ze(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new On(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new ze(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function ty(i,e,t,n){if(!i)return!1;let s=e.sliceDoc(t,n);return typeof i=="function"?i(s,t,n,e):zf(i,!0).test(s)}const Ol=Y.define({map(i,e){return i.map(t=>t.map(e))}}),Wf=Y.define(),Te=Fe.define({create(){return Vs.start()},update(i,e){return i.update(e)},provide:i=>[ml.from(i,e=>e.tooltip),T.contentAttributes.from(i,e=>e.attrs)]});function kl(i,e){const t=e.completion.apply||e.completion.label;let n=i.state.field(Te).active.find(s=>s.source==e.source);return n instanceof On?(typeof t=="string"?i.dispatch(Object.assign(Object.assign({},Q1(i.state,t,n.from,n.to)),{annotations:xl.of(e.completion)})):t(i,e.completion,n.from,n.to),!0):!1}const ny=Y1(Te,kl);function rs(i,e="option"){return t=>{let n=t.state.field(Te,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<t.state.facet(ge).interactionDelay)return!1;let s=1,r;e=="page"&&(r=Ef(t,n.open.tooltip))&&(s=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let{length:o}=n.open.options,l=n.open.selected>-1?n.open.selected+s*(i?1:-1):i?0:o-1;return l<0?l=e=="page"?0:o-1:l>=o&&(l=e=="page"?o-1:0),t.dispatch({effects:Wf.of(l)}),!0}}const iy=i=>{let e=i.state.field(Te,!1);return i.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<i.state.facet(ge).interactionDelay?!1:kl(i,e.open.options[e.open.selected])},qc=i=>i.state.field(Te,!1)?(i.dispatch({effects:Hs.of(!0)}),!0):!1,sy=i=>{let e=i.state.field(Te,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(i.dispatch({effects:Ai.of(null)}),!0)};class ry{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const oy=50,ly=1e3,ay=$e.fromClass(class{constructor(i){this.view=i,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of i.state.field(Te).active)e.isPending&&this.startQuery(e)}update(i){let e=i.state.field(Te),t=i.state.facet(ge);if(!i.selectionSet&&!i.docChanged&&i.startState.field(Te)==e)return;let n=i.transactions.some(r=>{let o=Xf(r,t);return o&8||(r.selection||r.docChanged)&&!(o&3)});for(let r=0;r<this.running.length;r++){let o=this.running[r];if(n||o.context.abortOnDocChange&&i.docChanged||o.updates.length+i.transactions.length>oy&&Date.now()-o.time>ly){for(let l of o.context.abortListeners)try{l()}catch(a){Ae(this.view.state,a)}o.context.abortListeners=null,this.running.splice(r--,1)}else o.updates.push(...i.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),i.transactions.some(r=>r.effects.some(o=>o.is(Hs)))&&(this.pendingStart=!0);let s=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(r=>r.isPending&&!this.running.some(o=>o.active.source==r.source))?setTimeout(()=>this.startUpdate(),s):-1,this.composing!=0)for(let r of i.transactions)r.isUserEvent("input.type")?this.composing=2:this.composing==2&&r.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:i}=this.view,e=i.field(Te);for(let t of e.active)t.isPending&&!this.running.some(n=>n.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(ge).updateSyncTime))}startQuery(i){let{state:e}=this.view,t=Gt(e),n=new Vf(e,t,i.explicit,this.view),s=new ry(i,n);this.running.push(s),Promise.resolve(i.source(n)).then(r=>{s.context.aborted||(s.done=r||null,this.scheduleAccept())},r=>{this.view.dispatch({effects:Ai.of(null)}),Ae(this.view.state,r)})}scheduleAccept(){this.running.every(i=>i.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(ge).updateSyncTime))}accept(){var i;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(ge),n=this.view.state.field(Te);for(let s=0;s<this.running.length;s++){let r=this.running[s];if(r.done===void 0)continue;if(this.running.splice(s--,1),r.done){let l=Gt(r.updates.length?r.updates[0].startState:this.view.state),a=Math.min(l,r.done.from+(r.active.explicit?0:1)),c=new On(r.active.source,r.active.explicit,a,r.done,r.done.from,(i=r.done.to)!==null&&i!==void 0?i:l);for(let h of r.updates)c=c.update(h,t);if(c.hasResult()){e.push(c);continue}}let o=n.active.find(l=>l.source==r.active.source);if(o&&o.isPending)if(r.done==null){let l=new ze(r.active.source,0);for(let a of r.updates)l=l.update(a,t);l.isPending||e.push(l)}else this.startQuery(o)}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:Ol.of(e)})}},{eventHandlers:{blur(i){let e=this.view.state.field(Te,!1);if(e&&e.tooltip&&this.view.state.facet(ge).closeOnBlur){let t=e.open&&Ef(this.view,e.open.tooltip);(!t||!t.dom.contains(i.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Ai.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Hs.of(!1)}),20),this.composing=0}}}),cy=typeof navigator=="object"&&/Win/.test(navigator.platform),hy=In.highest(T.domEventHandlers({keydown(i,e){let t=e.state.field(Te,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||i.key.length>1||i.ctrlKey&&!(cy&&i.altKey)||i.metaKey)return!1;let n=t.open.options[t.open.selected],s=t.active.find(o=>o.source==n.source),r=n.completion.commitCharacters||s.result.commitCharacters;return r&&r.indexOf(i.key)>-1&&kl(e,n),!1}})),jf=T.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class uy{constructor(e,t,n,s){this.field=e,this.line=t,this.from=n,this.to=s}}class wl{constructor(e,t,n){this.field=e,this.from=t,this.to=n}map(e){let t=e.mapPos(this.from,-1,ye.TrackDel),n=e.mapPos(this.to,1,ye.TrackDel);return t==null||n==null?null:new wl(this.field,t,n)}}class Sl{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let n=[],s=[t],r=e.doc.lineAt(t),o=/^\s*/.exec(r.text)[0];for(let a of this.lines){if(n.length){let c=o,h=/^\t*/.exec(a)[0].length;for(let u=0;u<h;u++)c+=e.facet(lr);s.push(t+c.length-h),a=c+a.slice(h)}n.push(a),t+=a.length+1}let l=this.fieldPositions.map(a=>new wl(a.field,s[a.line]+a.from,s[a.line]+a.to));return{text:n,ranges:l}}static parse(e){let t=[],n=[],s=[],r;for(let o of e.split(/\r\n?|\n/)){for(;r=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(o);){let l=r[1]?+r[1]:null,a=r[2]||r[3]||"",c=-1,h=a.replace(/\\[{}]/g,u=>u[1]);for(let u=0;u<t.length;u++)(l!=null?t[u].seq==l:h&&t[u].name==h)&&(c=u);if(c<0){let u=0;for(;u<t.length&&(l==null||t[u].seq!=null&&t[u].seq<l);)u++;t.splice(u,0,{seq:l,name:h}),c=u;for(let f of s)f.field>=c&&f.field++}s.push(new uy(c,n.length,r.index,r.index+h.length)),o=o.slice(0,r.index)+a+o.slice(r.index+r[0].length)}o=o.replace(/\\([{}])/g,(l,a,c)=>{for(let h of s)h.line==n.length&&h.from>c&&(h.from--,h.to--);return a}),n.push(o)}return new Sl(n,s)}}let fy=V.widget({widget:new class extends Nn{toDOM(){let i=document.createElement("span");return i.className="cm-snippetFieldPosition",i}ignoreEvent(){return!1}}}),dy=V.mark({class:"cm-snippetField"});class qn{constructor(e,t){this.ranges=e,this.active=t,this.deco=V.set(e.map(n=>(n.from==n.to?fy:dy).range(n.from,n.to)))}map(e){let t=[];for(let n of this.ranges){let s=n.map(e);if(!s)return null;t.push(s)}return new qn(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(n=>n.field==this.active&&n.from<=t.from&&n.to>=t.to))}}const Li=Y.define({map(i,e){return i&&i.map(e)}}),py=Y.define(),Pi=Fe.define({create(){return null},update(i,e){for(let t of e.effects){if(t.is(Li))return t.value;if(t.is(py)&&i)return new qn(i.ranges,t.value)}return i&&e.docChanged&&(i=i.map(e.changes)),i&&e.selection&&!i.selectionInsideField(e.selection)&&(i=null),i},provide:i=>T.decorations.from(i,e=>e?e.deco:V.none)});function Cl(i,e){return C.create(i.filter(t=>t.field==e).map(t=>C.range(t.from,t.to)))}function gy(i){let e=Sl.parse(i);return(t,n,s,r)=>{let{text:o,ranges:l}=e.instantiate(t.state,s),a={changes:{from:s,to:r,insert:j.of(o)},scrollIntoView:!0,annotations:n?[xl.of(n),ve.userEvent.of("input.complete")]:void 0};if(l.length&&(a.selection=Cl(l,0)),l.some(c=>c.field>0)){let c=new qn(l,0),h=a.effects=[Li.of(c)];t.state.field(Pi,!1)===void 0&&h.push(Y.appendConfig.of([Pi,xy,Oy,jf]))}t.dispatch(t.state.update(a))}}function Yf(i){return({state:e,dispatch:t})=>{let n=e.field(Pi,!1);if(!n||i<0&&n.active==0)return!1;let s=n.active+i,r=i>0&&!n.ranges.some(o=>o.field==s+i);return t(e.update({selection:Cl(n.ranges,s),effects:Li.of(r?null:new qn(n.ranges,s)),scrollIntoView:!0})),!0}}const my=({state:i,dispatch:e})=>i.field(Pi,!1)?(e(i.update({effects:Li.of(null)})),!0):!1,by=Yf(1),yy=Yf(-1),vy=[{key:"Tab",run:by,shift:yy},{key:"Escape",run:my}],Qc=D.define({combine(i){return i.length?i[0]:vy}}),xy=In.highest(Bi.compute([Qc],i=>i.facet(Qc)));function Vt(i,e){return Object.assign(Object.assign({},e),{apply:gy(i)})}const Oy=T.domEventHandlers({mousedown(i,e){let t=e.state.field(Pi,!1),n;if(!t||(n=e.posAtCoords({x:i.clientX,y:i.clientY}))==null)return!1;let s=t.ranges.find(r=>r.from<=n&&r.to>=n);return!s||s.field==t.active?!1:(e.dispatch({selection:Cl(t.ranges,s.field),effects:Li.of(t.ranges.some(r=>r.field>s.field)?new qn(t.ranges,s.field):null),scrollIntoView:!0}),!0)}}),zs={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Ut=Y.define({map(i,e){let t=e.mapPos(i,-1,ye.TrackAfter);return t??void 0}}),_l=new class extends Zt{};_l.startSide=1;_l.endSide=-1;const Uf=Fe.define({create(){return K.empty},update(i,e){if(i=i.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);i=i.update({filter:n=>n>=t.from&&n<=t.to})}for(let t of e.effects)t.is(Ut)&&(i=i.update({add:[_l.range(t.value,t.value+1)]}));return i}});function Gf(){return[Cy,Uf]}const Ir="()[]{}<>";function ky(i){for(let e=0;e<Ir.length;e+=2)if(Ir.charCodeAt(e)==i)return Ir.charAt(e+1);return yu(i<128?i:i+1)}function wy(i,e){return i.languageDataAt("closeBrackets",e)[0]||zs}const Sy=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Cy=T.inputHandler.of((i,e,t,n)=>{if((Sy?i.composing:i.compositionStarted)||i.state.readOnly)return!1;let s=i.state.selection.main;if(n.length>2||n.length==2&&ot(Ie(n,0))==1||e!=s.from||t!=s.to)return!1;let r=_y(i.state,n);return r?(i.dispatch(r),!0):!1});function _y(i,e){let t=wy(i,i.selection.main.head),n=t.brackets||zs.brackets;for(let s of n){let r=ky(Ie(s,0));if(e==s)return r==s?Ey(i,s,n.indexOf(s+s+s)>-1,t):Ay(i,s,r,t.before||zs.before);if(e==r&&Kf(i,i.selection.main.from))return Py(i,s,r)}return null}function Kf(i,e){let t=!1;return i.field(Uf).between(0,i.doc.length,n=>{n==e&&(t=!0)}),t}function Al(i,e){let t=i.sliceString(e,e+2);return t.slice(0,ot(Ie(t,0)))}function Ay(i,e,t,n){let s=null,r=i.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:Ut.of(o.to+e.length),range:C.range(o.anchor+e.length,o.head+e.length)};let l=Al(i.doc,o.head);return!l||/\s/.test(l)||n.indexOf(l)>-1?{changes:{insert:e+t,from:o.head},effects:Ut.of(o.head+e.length),range:C.cursor(o.head+e.length)}:{range:s=o}});return s?null:i.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function Py(i,e,t){let n=null,s=i.changeByRange(r=>r.empty&&Al(i.doc,r.head)==t?{changes:{from:r.head,to:r.head+t.length,insert:t},range:C.cursor(r.head+t.length)}:n={range:r});return n?null:i.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function Ey(i,e,t,n){let s=n.stringPrefixes||zs.stringPrefixes,r=null,o=i.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:Ut.of(l.to+e.length),range:C.range(l.anchor+e.length,l.head+e.length)};let a=l.head,c=Al(i.doc,a),h;if(c==e){if(Hc(i,a))return{changes:{insert:e+e,from:a},effects:Ut.of(a+e.length),range:C.cursor(a+e.length)};if(Kf(i,a)){let f=t&&i.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+f.length,insert:f},range:C.cursor(a+f.length)}}}else{if(t&&i.sliceDoc(a-2*e.length,a)==e+e&&(h=Vc(i,a-2*e.length,s))>-1&&Hc(i,h))return{changes:{insert:e+e+e+e,from:a},effects:Ut.of(a+e.length),range:C.cursor(a+e.length)};if(i.charCategorizer(a)(c)!=Ve.Word&&Vc(i,a,s)>-1&&!Ty(i,a,e,s))return{changes:{insert:e+e,from:a},effects:Ut.of(a+e.length),range:C.cursor(a+e.length)}}return{range:r=l}});return r?null:i.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function Hc(i,e){let t=de(i).resolveInner(e+1);return t.parent&&t.from==e}function Ty(i,e,t,n){let s=de(i).resolveInner(e,-1),r=n.reduce((o,l)=>Math.max(o,l.length),0);for(let o=0;o<5;o++){let l=i.sliceDoc(s.from,Math.min(s.to,s.from+t.length+r)),a=l.indexOf(t);if(!a||a>-1&&n.indexOf(l.slice(0,a))>-1){let h=s.firstChild;for(;h&&h.from==s.from&&h.to-h.from>t.length+a;){if(i.sliceDoc(h.to-t.length,h.to)==t)return!1;h=h.firstChild}return!0}let c=s.to==e&&s.parent;if(!c)break;s=c}return!1}function Vc(i,e,t){let n=i.charCategorizer(e);if(n(i.sliceDoc(e-1,e))!=Ve.Word)return e;for(let s of t){let r=e-s.length;if(i.sliceDoc(r,e)==s&&n(i.sliceDoc(r-1,r))!=Ve.Word)return r}return-1}function Ry(i={}){return[hy,Te,ge.of(i),ay,$y,jf]}const My=[{key:"Ctrl-Space",run:qc},{mac:"Alt-`",run:qc},{key:"Escape",run:sy},{key:"ArrowDown",run:rs(!0)},{key:"ArrowUp",run:rs(!1)},{key:"PageDown",run:rs(!0,"page")},{key:"PageUp",run:rs(!1,"page")},{key:"Enter",run:iy}],$y=In.highest(Bi.computeN([ge],i=>i.facet(ge).defaultKeymap?[My]:[])),Dy=i=>{let{state:e}=i,t=e.doc.lineAt(e.selection.main.from),n=El(i.state,t.from);return n.line?By(i):n.block?Iy(i):!1};function Pl(i,e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let s=i(e,t);return s?(n(t.update(s)),!0):!1}}const By=Pl(qy,0),Ly=Pl(Zf,0),Iy=Pl((i,e)=>Zf(i,e,Ny(e)),0);function El(i,e){let t=i.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const Yn=50;function Fy(i,{open:e,close:t},n,s){let r=i.sliceDoc(n-Yn,n),o=i.sliceDoc(s,s+Yn),l=/\s*$/.exec(r)[0].length,a=/^\s*/.exec(o)[0].length,c=r.length-l;if(r.slice(c-e.length,c)==e&&o.slice(a,a+t.length)==t)return{open:{pos:n-l,margin:l&&1},close:{pos:s+a,margin:a&&1}};let h,u;s-n<=2*Yn?h=u=i.sliceDoc(n,s):(h=i.sliceDoc(n,n+Yn),u=i.sliceDoc(s-Yn,s));let f=/^\s*/.exec(h)[0].length,d=/\s*$/.exec(u)[0].length,p=u.length-d-t.length;return h.slice(f,f+e.length)==e&&u.slice(p,p+t.length)==t?{open:{pos:n+f+e.length,margin:/\s/.test(h.charAt(f+e.length))?1:0},close:{pos:s-d-t.length,margin:/\s/.test(u.charAt(p-1))?1:0}}:null}function Ny(i){let e=[];for(let t of i.selection.ranges){let n=i.doc.lineAt(t.from),s=t.to<=n.to?n:i.doc.lineAt(t.to);s.from>n.from&&s.from==t.to&&(s=t.to==n.to+1?n:i.doc.lineAt(t.to-1));let r=e.length-1;r>=0&&e[r].to>n.from?e[r].to=s.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:s.to})}return e}function Zf(i,e,t=e.selection.ranges){let n=t.map(r=>El(e,r.from).block);if(!n.every(r=>r))return null;let s=t.map((r,o)=>Fy(e,n[o],r.from,r.to));if(i!=2&&!s.every(r=>r))return{changes:e.changes(t.map((r,o)=>s[o]?[]:[{from:r.from,insert:n[o].open+" "},{from:r.to,insert:" "+n[o].close}]))};if(i!=1&&s.some(r=>r)){let r=[];for(let o=0,l;o<s.length;o++)if(l=s[o]){let a=n[o],{open:c,close:h}=l;r.push({from:c.pos-a.open.length,to:c.pos+c.margin},{from:h.pos-h.margin,to:h.pos+a.close.length})}return{changes:r}}return null}function qy(i,e,t=e.selection.ranges){let n=[],s=-1;for(let{from:r,to:o}of t){let l=n.length,a=1e9,c=El(e,r).line;if(c){for(let h=r;h<=o;){let u=e.doc.lineAt(h);if(u.from>s&&(r==o||o>u.from)){s=u.from;let f=/^\s*/.exec(u.text)[0].length,d=f==u.length,p=u.text.slice(f,f+c.length)==c?f:-1;f<u.text.length&&f<a&&(a=f),n.push({line:u,comment:p,token:c,indent:f,empty:d,single:!1})}h=u.to+1}if(a<1e9)for(let h=l;h<n.length;h++)n[h].indent<n[h].line.text.length&&(n[h].indent=a);n.length==l+1&&(n[l].single=!0)}}if(i!=2&&n.some(r=>r.comment<0&&(!r.empty||r.single))){let r=[];for(let{line:l,token:a,indent:c,empty:h,single:u}of n)(u||!h)&&r.push({from:l.from+c,insert:a+" "});let o=e.changes(r);return{changes:o,selection:e.selection.map(o,1)}}else if(i!=1&&n.some(r=>r.comment>=0)){let r=[];for(let{line:o,comment:l,token:a}of n)if(l>=0){let c=o.from+l,h=c+a.length;o.text[h-o.from]==" "&&h++,r.push({from:c,to:h})}return{changes:r}}return null}function Qn(i,e){return C.create(i.ranges.map(e),i.mainIndex)}function dt(i,e){return i.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Je({state:i,dispatch:e},t){let n=Qn(i.selection,t);return n.eq(i.selection,!0)?!1:(e(dt(i,n)),!0)}function hr(i,e){return C.cursor(e?i.to:i.from)}function Jf(i,e){return Je(i,t=>t.empty?i.moveByChar(t,e):hr(t,e))}function Ce(i){return i.textDirectionAt(i.state.selection.main.head)==le.LTR}const ed=i=>Jf(i,!Ce(i)),td=i=>Jf(i,Ce(i));function nd(i,e){return Je(i,t=>t.empty?i.moveByGroup(t,e):hr(t,e))}const Qy=i=>nd(i,!Ce(i)),Hy=i=>nd(i,Ce(i));function Vy(i,e,t){if(e.type.prop(t))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(i.sliceDoc(e.from,e.to)))||e.firstChild}function ur(i,e,t){let n=de(i).resolveInner(e.head),s=t?N.closedBy:N.openedBy;for(let a=e.head;;){let c=t?n.childAfter(a):n.childBefore(a);if(!c)break;Vy(i,c,s)?n=c:a=t?c.to:c.from}let r=n.type.prop(s),o,l;return r&&(o=t?ct(i,n.from,1):ct(i,n.to,-1))&&o.matched?l=t?o.end.to:o.end.from:l=t?n.to:n.from,C.cursor(l,t?-1:1)}const zy=i=>Je(i,e=>ur(i.state,e,!Ce(i))),Xy=i=>Je(i,e=>ur(i.state,e,Ce(i)));function id(i,e){return Je(i,t=>{if(!t.empty)return hr(t,e);let n=i.moveVertically(t,e);return n.head!=t.head?n:i.moveToLineBoundary(t,e)})}const sd=i=>id(i,!1),rd=i=>id(i,!0);function od(i){let e=i.scrollDOM.clientHeight<i.scrollDOM.scrollHeight-2,t=0,n=0,s;if(e){for(let r of i.state.facet(T.scrollMargins)){let o=r(i);o!=null&&o.top&&(t=Math.max(o==null?void 0:o.top,t)),o!=null&&o.bottom&&(n=Math.max(o==null?void 0:o.bottom,n))}s=i.scrollDOM.clientHeight-t-n}else s=(i.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:n,selfScroll:e,height:Math.max(i.defaultLineHeight,s-5)}}function ld(i,e){let t=od(i),{state:n}=i,s=Qn(n.selection,o=>o.empty?i.moveVertically(o,e,t.height):hr(o,e));if(s.eq(n.selection))return!1;let r;if(t.selfScroll){let o=i.coordsAtPos(n.selection.main.head),l=i.scrollDOM.getBoundingClientRect(),a=l.top+t.marginTop,c=l.bottom-t.marginBottom;o&&o.top>a&&o.bottom<c&&(r=T.scrollIntoView(s.main.head,{y:"start",yMargin:o.top-a}))}return i.dispatch(dt(n,s),{effects:r}),!0}const zc=i=>ld(i,!1),Lo=i=>ld(i,!0);function Nt(i,e,t){let n=i.lineBlockAt(e.head),s=i.moveToLineBoundary(e,t);if(s.head==e.head&&s.head!=(t?n.to:n.from)&&(s=i.moveToLineBoundary(e,t,!1)),!t&&s.head==n.from&&n.length){let r=/^\s*/.exec(i.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;r&&e.head!=n.from+r&&(s=C.cursor(n.from+r))}return s}const Wy=i=>Je(i,e=>Nt(i,e,!0)),jy=i=>Je(i,e=>Nt(i,e,!1)),Yy=i=>Je(i,e=>Nt(i,e,!Ce(i))),Uy=i=>Je(i,e=>Nt(i,e,Ce(i))),Gy=i=>Je(i,e=>C.cursor(i.lineBlockAt(e.head).from,1)),Ky=i=>Je(i,e=>C.cursor(i.lineBlockAt(e.head).to,-1));function Zy(i,e,t){let n=!1,s=Qn(i.selection,r=>{let o=ct(i,r.head,-1)||ct(i,r.head,1)||r.head>0&&ct(i,r.head-1,1)||r.head<i.doc.length&&ct(i,r.head+1,-1);if(!o||!o.end)return r;n=!0;let l=o.start.from==r.head?o.end.to:o.end.from;return C.cursor(l)});return n?(e(dt(i,s)),!0):!1}const Jy=({state:i,dispatch:e})=>Zy(i,e);function Ye(i,e){let t=Qn(i.state.selection,n=>{let s=e(n);return C.range(n.anchor,s.head,s.goalColumn,s.bidiLevel||void 0)});return t.eq(i.state.selection)?!1:(i.dispatch(dt(i.state,t)),!0)}function ad(i,e){return Ye(i,t=>i.moveByChar(t,e))}const cd=i=>ad(i,!Ce(i)),hd=i=>ad(i,Ce(i));function ud(i,e){return Ye(i,t=>i.moveByGroup(t,e))}const ev=i=>ud(i,!Ce(i)),tv=i=>ud(i,Ce(i)),nv=i=>Ye(i,e=>ur(i.state,e,!Ce(i))),iv=i=>Ye(i,e=>ur(i.state,e,Ce(i)));function fd(i,e){return Ye(i,t=>i.moveVertically(t,e))}const dd=i=>fd(i,!1),pd=i=>fd(i,!0);function gd(i,e){return Ye(i,t=>i.moveVertically(t,e,od(i).height))}const Xc=i=>gd(i,!1),Wc=i=>gd(i,!0),sv=i=>Ye(i,e=>Nt(i,e,!0)),rv=i=>Ye(i,e=>Nt(i,e,!1)),ov=i=>Ye(i,e=>Nt(i,e,!Ce(i))),lv=i=>Ye(i,e=>Nt(i,e,Ce(i))),av=i=>Ye(i,e=>C.cursor(i.lineBlockAt(e.head).from)),cv=i=>Ye(i,e=>C.cursor(i.lineBlockAt(e.head).to)),jc=({state:i,dispatch:e})=>(e(dt(i,{anchor:0})),!0),Yc=({state:i,dispatch:e})=>(e(dt(i,{anchor:i.doc.length})),!0),Uc=({state:i,dispatch:e})=>(e(dt(i,{anchor:i.selection.main.anchor,head:0})),!0),Gc=({state:i,dispatch:e})=>(e(dt(i,{anchor:i.selection.main.anchor,head:i.doc.length})),!0),hv=({state:i,dispatch:e})=>(e(i.update({selection:{anchor:0,head:i.doc.length},userEvent:"select"})),!0),uv=({state:i,dispatch:e})=>{let t=fr(i).map(({from:n,to:s})=>C.range(n,Math.min(s+1,i.doc.length)));return e(i.update({selection:C.create(t),userEvent:"select"})),!0},fv=({state:i,dispatch:e})=>{let t=Qn(i.selection,n=>{let s=de(i),r=s.resolveStack(n.from,1);if(n.empty){let o=s.resolveStack(n.from,-1);o.node.from>=r.node.from&&o.node.to<=r.node.to&&(r=o)}for(let o=r;o;o=o.next){let{node:l}=o;if((l.from<n.from&&l.to>=n.to||l.to>n.to&&l.from<=n.from)&&o.next)return C.range(l.to,l.from)}return n});return t.eq(i.selection)?!1:(e(dt(i,t)),!0)},dv=({state:i,dispatch:e})=>{let t=i.selection,n=null;return t.ranges.length>1?n=C.create([t.main]):t.main.empty||(n=C.create([C.cursor(t.main.head)])),n?(e(dt(i,n)),!0):!1};function Ii(i,e){if(i.state.readOnly)return!1;let t="delete.selection",{state:n}=i,s=n.changeByRange(r=>{let{from:o,to:l}=r;if(o==l){let a=e(r);a<o?(t="delete.backward",a=os(i,a,!1)):a>o&&(t="delete.forward",a=os(i,a,!0)),o=Math.min(o,a),l=Math.max(l,a)}else o=os(i,o,!1),l=os(i,l,!0);return o==l?{range:r}:{changes:{from:o,to:l},range:C.cursor(o,o<r.head?-1:1)}});return s.changes.empty?!1:(i.dispatch(n.update(s,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?T.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function os(i,e,t){if(i instanceof T)for(let n of i.state.facet(T.atomicRanges).map(s=>s(i)))n.between(e,e,(s,r)=>{s<e&&r>e&&(e=t?r:s)});return e}const md=(i,e,t)=>Ii(i,n=>{let s=n.from,{state:r}=i,o=r.doc.lineAt(s),l,a;if(t&&!e&&s>o.from&&s<o.from+200&&!/[^ \t]/.test(l=o.text.slice(0,s-o.from))){if(l[l.length-1]=="	")return s-1;let c=ir(l,r.tabSize),h=c%Qs(r)||Qs(r);for(let u=0;u<h&&l[l.length-1-u]==" ";u++)s--;a=s}else a=_e(o.text,s-o.from,e,e)+o.from,a==s&&o.number!=(e?r.doc.lines:1)?a+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(a-o.from,s-o.from))&&(a=_e(o.text,a-o.from,!1,!1)+o.from);return a}),Io=i=>md(i,!1,!0),bd=i=>md(i,!0,!1),yd=(i,e)=>Ii(i,t=>{let n=t.head,{state:s}=i,r=s.doc.lineAt(n),o=s.charCategorizer(n);for(let l=null;;){if(n==(e?r.to:r.from)){n==t.head&&r.number!=(e?s.doc.lines:1)&&(n+=e?1:-1);break}let a=_e(r.text,n-r.from,e)+r.from,c=r.text.slice(Math.min(n,a)-r.from,Math.max(n,a)-r.from),h=o(c);if(l!=null&&h!=l)break;(c!=" "||n!=t.head)&&(l=h),n=a}return n}),vd=i=>yd(i,!1),pv=i=>yd(i,!0),gv=i=>Ii(i,e=>{let t=i.lineBlockAt(e.head).to;return e.head<t?t:Math.min(i.state.doc.length,e.head+1)}),mv=i=>Ii(i,e=>{let t=i.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),bv=i=>Ii(i,e=>{let t=i.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(i.state.doc.length,e.head+1)}),yv=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=i.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:j.of(["",""])},range:C.cursor(n.from)}));return e(i.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},vv=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=i.changeByRange(n=>{if(!n.empty||n.from==0||n.from==i.doc.length)return{range:n};let s=n.from,r=i.doc.lineAt(s),o=s==r.from?s-1:_e(r.text,s-r.from,!1)+r.from,l=s==r.to?s+1:_e(r.text,s-r.from,!0)+r.from;return{changes:{from:o,to:l,insert:i.doc.slice(s,l).append(i.doc.slice(o,s))},range:C.cursor(l)}});return t.changes.empty?!1:(e(i.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function fr(i){let e=[],t=-1;for(let n of i.selection.ranges){let s=i.doc.lineAt(n.from),r=i.doc.lineAt(n.to);if(!n.empty&&n.to==r.from&&(r=i.doc.lineAt(n.to-1)),t>=s.number){let o=e[e.length-1];o.to=r.to,o.ranges.push(n)}else e.push({from:s.from,to:r.to,ranges:[n]});t=r.number+1}return e}function xd(i,e,t){if(i.readOnly)return!1;let n=[],s=[];for(let r of fr(i)){if(t?r.to==i.doc.length:r.from==0)continue;let o=i.doc.lineAt(t?r.to+1:r.from-1),l=o.length+1;if(t){n.push({from:r.to,to:o.to},{from:r.from,insert:o.text+i.lineBreak});for(let a of r.ranges)s.push(C.range(Math.min(i.doc.length,a.anchor+l),Math.min(i.doc.length,a.head+l)))}else{n.push({from:o.from,to:r.from},{from:r.to,insert:i.lineBreak+o.text});for(let a of r.ranges)s.push(C.range(a.anchor-l,a.head-l))}}return n.length?(e(i.update({changes:n,scrollIntoView:!0,selection:C.create(s,i.selection.mainIndex),userEvent:"move.line"})),!0):!1}const xv=({state:i,dispatch:e})=>xd(i,e,!1),Ov=({state:i,dispatch:e})=>xd(i,e,!0);function Od(i,e,t){if(i.readOnly)return!1;let n=[];for(let s of fr(i))t?n.push({from:s.from,insert:i.doc.slice(s.from,s.to)+i.lineBreak}):n.push({from:s.to,insert:i.lineBreak+i.doc.slice(s.from,s.to)});return e(i.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const kv=({state:i,dispatch:e})=>Od(i,e,!1),wv=({state:i,dispatch:e})=>Od(i,e,!0),Sv=i=>{if(i.state.readOnly)return!1;let{state:e}=i,t=e.changes(fr(e).map(({from:s,to:r})=>(s>0?s--:r<e.doc.length&&r++,{from:s,to:r}))),n=Qn(e.selection,s=>{let r;if(i.lineWrapping){let o=i.lineBlockAt(s.head),l=i.coordsAtPos(s.head,s.assoc||1);l&&(r=o.bottom+i.documentTop-l.bottom+i.defaultLineHeight/2)}return i.moveVertically(s,!0,r)}).map(t);return i.dispatch({changes:t,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function Cv(i,e){if(/\(\)|\[\]|\{\}/.test(i.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=de(i).resolveInner(e),n=t.childBefore(e),s=t.childAfter(e),r;return n&&s&&n.to<=e&&s.from>=e&&(r=n.type.prop(N.closedBy))&&r.indexOf(s.name)>-1&&i.doc.lineAt(n.to).from==i.doc.lineAt(s.from).from&&!/\S/.test(i.sliceDoc(n.to,s.from))?{from:n.to,to:s.from}:null}const Kc=kd(!1),_v=kd(!0);function kd(i){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(s=>{let{from:r,to:o}=s,l=e.doc.lineAt(r),a=!i&&r==o&&Cv(e,r);i&&(r=o=(o<=l.to?l:e.doc.lineAt(o)).to);let c=new ar(e,{simulateBreak:r,simulateDoubleBreak:!!a}),h=bl(c,r);for(h==null&&(h=ir(/^\s*/.exec(e.doc.lineAt(r).text)[0],e.tabSize));o<l.to&&/\s/.test(l.text[o-l.from]);)o++;a?{from:r,to:o}=a:r>l.from&&r<l.from+100&&!/\S/.test(l.text.slice(0,r))&&(r=l.from);let u=["",_i(e,h)];return a&&u.push(_i(e,c.lineIndent(l.from,-1))),{changes:{from:r,to:o,insert:j.of(u)},range:C.cursor(r+1+u[1].length)}});return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function Tl(i,e){let t=-1;return i.changeByRange(n=>{let s=[];for(let o=n.from;o<=n.to;){let l=i.doc.lineAt(o);l.number>t&&(n.empty||n.to>l.from)&&(e(l,s,n),t=l.number),o=l.to+1}let r=i.changes(s);return{changes:s,range:C.range(r.mapPos(n.anchor,1),r.mapPos(n.head,1))}})}const Av=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=Object.create(null),n=new ar(i,{overrideIndentation:r=>{let o=t[r];return o??-1}}),s=Tl(i,(r,o,l)=>{let a=bl(n,r.from);if(a==null)return;/\S/.test(r.text)||(a=0);let c=/^\s*/.exec(r.text)[0],h=_i(i,a);(c!=h||l.from<r.from+c.length)&&(t[r.from]=a,o.push({from:r.from,to:r.from+c.length,insert:h}))});return s.changes.empty||e(i.update(s,{userEvent:"indent"})),!0},Pv=({state:i,dispatch:e})=>i.readOnly?!1:(e(i.update(Tl(i,(t,n)=>{n.push({from:t.from,insert:i.facet(lr)})}),{userEvent:"input.indent"})),!0),Ev=({state:i,dispatch:e})=>i.readOnly?!1:(e(i.update(Tl(i,(t,n)=>{let s=/^\s*/.exec(t.text)[0];if(!s)return;let r=ir(s,i.tabSize),o=0,l=_i(i,Math.max(0,r-Qs(i)));for(;o<s.length&&o<l.length&&s.charCodeAt(o)==l.charCodeAt(o);)o++;n.push({from:t.from+o,to:t.from+s.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0),Tv=i=>(i.setTabFocusMode(),!0),Rv=[{key:"Ctrl-b",run:ed,shift:cd,preventDefault:!0},{key:"Ctrl-f",run:td,shift:hd},{key:"Ctrl-p",run:sd,shift:dd},{key:"Ctrl-n",run:rd,shift:pd},{key:"Ctrl-a",run:Gy,shift:av},{key:"Ctrl-e",run:Ky,shift:cv},{key:"Ctrl-d",run:bd},{key:"Ctrl-h",run:Io},{key:"Ctrl-k",run:gv},{key:"Ctrl-Alt-h",run:vd},{key:"Ctrl-o",run:yv},{key:"Ctrl-t",run:vv},{key:"Ctrl-v",run:Lo}],Mv=[{key:"ArrowLeft",run:ed,shift:cd,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Qy,shift:ev,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Yy,shift:ov,preventDefault:!0},{key:"ArrowRight",run:td,shift:hd,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Hy,shift:tv,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Uy,shift:lv,preventDefault:!0},{key:"ArrowUp",run:sd,shift:dd,preventDefault:!0},{mac:"Cmd-ArrowUp",run:jc,shift:Uc},{mac:"Ctrl-ArrowUp",run:zc,shift:Xc},{key:"ArrowDown",run:rd,shift:pd,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Yc,shift:Gc},{mac:"Ctrl-ArrowDown",run:Lo,shift:Wc},{key:"PageUp",run:zc,shift:Xc},{key:"PageDown",run:Lo,shift:Wc},{key:"Home",run:jy,shift:rv,preventDefault:!0},{key:"Mod-Home",run:jc,shift:Uc},{key:"End",run:Wy,shift:sv,preventDefault:!0},{key:"Mod-End",run:Yc,shift:Gc},{key:"Enter",run:Kc,shift:Kc},{key:"Mod-a",run:hv},{key:"Backspace",run:Io,shift:Io},{key:"Delete",run:bd},{key:"Mod-Backspace",mac:"Alt-Backspace",run:vd},{key:"Mod-Delete",mac:"Alt-Delete",run:pv},{mac:"Mod-Backspace",run:mv},{mac:"Mod-Delete",run:bv}].concat(Rv.map(i=>({mac:i.key,run:i.run,shift:i.shift}))),wd=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:zy,shift:nv},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Xy,shift:iv},{key:"Alt-ArrowUp",run:xv},{key:"Shift-Alt-ArrowUp",run:kv},{key:"Alt-ArrowDown",run:Ov},{key:"Shift-Alt-ArrowDown",run:wv},{key:"Escape",run:dv},{key:"Mod-Enter",run:_v},{key:"Alt-l",mac:"Ctrl-l",run:uv},{key:"Mod-i",run:fv,preventDefault:!0},{key:"Mod-[",run:Ev},{key:"Mod-]",run:Pv},{key:"Mod-Alt-\\",run:Av},{key:"Shift-Mod-k",run:Sv},{key:"Shift-Mod-\\",run:Jy},{key:"Mod-/",run:Dy},{key:"Alt-A",run:Ly},{key:"Ctrl-m",mac:"Shift-Alt-m",run:Tv}].concat(Mv);function at(){var i=arguments[0];typeof i=="string"&&(i=document.createElement(i));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var s=t[n];typeof s=="string"?i.setAttribute(n,s):s!=null&&(i[n]=s)}e++}for(;e<arguments.length;e++)Sd(i,arguments[e]);return i}function Sd(i,e){if(typeof e=="string")i.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)i.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)Sd(i,e[t]);else throw new RangeError("Unsupported child node: "+e)}class $v{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}}class Wt{constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}static init(e,t,n){let s=e,r=n.facet(ht).markerFilter;r&&(s=r(s,n));let o=V.set(s.map(l=>l.from==l.to||l.from==l.to-1&&n.doc.lineAt(l.from).to==l.from?V.widget({widget:new Hv(l),diagnostic:l}).range(l.from):V.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity+(l.markClass?" "+l.markClass:"")},diagnostic:l}).range(l.from,l.to)),!0);return new Wt(o,t,$n(o))}}function $n(i,e=null,t=0){let n=null;return i.between(t,1e9,(s,r,{spec:o})=>{if(!(e&&o.diagnostic!=e))return n=new $v(s,r,o.diagnostic),!1}),n}function Dv(i,e){let t=e.pos,n=e.end||t,s=i.state.facet(ht).hideOn(i,t,n);if(s!=null)return s;let r=i.startState.doc.lineAt(e.pos);return!!(i.effects.some(o=>o.is(Fi))||i.changes.touchesRange(r.from,Math.max(r.to,n)))}function Bv(i,e){return i.field(Ge,!1)?e:e.concat(Y.appendConfig.of(Td))}function Lv(i,e){return{effects:Bv(i,[Fi.of(e)])}}const Fi=Y.define(),Cd=Y.define(),_d=Y.define(),Ge=Fe.define({create(){return new Wt(V.none,null,null)},update(i,e){if(e.docChanged&&i.diagnostics.size){let t=i.diagnostics.map(e.changes),n=null,s=i.panel;if(i.selected){let r=e.changes.mapPos(i.selected.from,1);n=$n(t,i.selected.diagnostic,r)||$n(t,null,r)}!t.size&&s&&e.state.facet(ht).autoPanel&&(s=null),i=new Wt(t,s,n)}for(let t of e.effects)if(t.is(Fi)){let n=e.state.facet(ht).autoPanel?t.value.length?Xs.open:null:i.panel;i=Wt.init(t.value,n,e.state)}else t.is(Cd)?i=new Wt(i.diagnostics,t.value?Xs.open:null,i.selected):t.is(_d)&&(i=new Wt(i.diagnostics,i.panel,t.value));return i},provide:i=>[Ro.from(i,e=>e.panel),T.decorations.from(i,e=>e.diagnostics)]}),Iv=V.mark({class:"cm-lintRange cm-lintRange-active"});function Fv(i,e,t){let{diagnostics:n}=i.state.field(Ge),s=[],r=2e8,o=0;n.between(e-(t<0?1:0),e+(t>0?1:0),(a,c,{spec:h})=>{e>=a&&e<=c&&(a==c||(e>a||t>0)&&(e<c||t<0))&&(s.push(h.diagnostic),r=Math.min(a,r),o=Math.max(c,o))});let l=i.state.facet(ht).tooltipFilter;return l&&(s=l(s,i.state)),s.length?{pos:r,end:o,above:i.state.doc.lineAt(r).to<o,create(){return{dom:Nv(i,s)}}}:null}function Nv(i,e){return at("ul",{class:"cm-tooltip-lint"},e.map(t=>Ed(i,t,!1)))}const Zc=i=>{let e=i.state.field(Ge,!1);return!e||!e.panel?!1:(i.dispatch({effects:Cd.of(!1)}),!0)},qv=$e.fromClass(class{constructor(i){this.view=i,this.timeout=-1,this.set=!0;let{delay:e}=i.state.facet(ht);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){clearTimeout(this.timeout);let i=Date.now();if(i<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-i);else{this.set=!1;let{state:e}=this.view,{sources:t}=e.facet(ht);t.length&&Qv(t.map(n=>Promise.resolve(n(this.view))),n=>{this.view.state.doc==e.doc&&this.view.dispatch(Lv(this.view.state,n.reduce((s,r)=>s.concat(r))))},n=>{Ae(this.view.state,n)})}}update(i){let e=i.state.facet(ht);(i.docChanged||e!=i.startState.facet(ht)||e.needsRefresh&&e.needsRefresh(i))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}});function Qv(i,e,t){let n=[],s=-1;for(let r of i)r.then(o=>{n.push(o),clearTimeout(s),n.length==i.length?e(n):setTimeout(()=>e(n),200)},t)}const ht=D.define({combine(i){return Object.assign({sources:i.map(e=>e.source).filter(e=>e!=null)},nr(i.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?n=>e(n)||t(n):e:t}))}});function Ad(i,e={}){return[ht.of({source:i,config:e}),qv,Td]}function Pd(i){let e=[];if(i)e:for(let{name:t}of i){for(let n=0;n<t.length;n++){let s=t[n];if(/[a-zA-Z]/.test(s)&&!e.some(r=>r.toLowerCase()==s.toLowerCase())){e.push(s);continue e}}e.push("")}return e}function Ed(i,e,t){var n;let s=t?Pd(e.actions):[];return at("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},at("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(i):e.message),(n=e.actions)===null||n===void 0?void 0:n.map((r,o)=>{let l=!1,a=f=>{if(f.preventDefault(),l)return;l=!0;let d=$n(i.state.field(Ge).diagnostics,e);d&&r.apply(i,d.from,d.to)},{name:c}=r,h=s[o]?c.indexOf(s[o]):-1,u=h<0?c:[c.slice(0,h),at("u",c.slice(h,h+1)),c.slice(h+1)];return at("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${c}${h<0?"":` (access key "${s[o]})"`}.`},u)}),e.source&&at("div",{class:"cm-diagnosticSource"},e.source))}class Hv extends Nn{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return at("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Jc{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Ed(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Xs{constructor(e){this.view=e,this.items=[];let t=s=>{if(s.keyCode==27)Zc(this.view),this.view.focus();else if(s.keyCode==38||s.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(s.keyCode==40||s.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(s.keyCode==36)this.moveSelection(0);else if(s.keyCode==35)this.moveSelection(this.items.length-1);else if(s.keyCode==13)this.view.focus();else if(s.keyCode>=65&&s.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:r}=this.items[this.selectedIndex],o=Pd(r.actions);for(let l=0;l<o.length;l++)if(o[l].toUpperCase().charCodeAt(0)==s.keyCode){let a=$n(this.view.state.field(Ge).diagnostics,r);a&&r.actions[l].apply(e,a.from,a.to)}}else return;s.preventDefault()},n=s=>{for(let r=0;r<this.items.length;r++)this.items[r].dom.contains(s.target)&&this.moveSelection(r)};this.list=at("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:n}),this.dom=at("div",{class:"cm-panel-lint"},this.list,at("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Zc(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(Ge).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Ge),n=0,s=!1,r=null;for(e.between(0,this.view.state.doc.length,(o,l,{spec:a})=>{let c=-1,h;for(let u=n;u<this.items.length;u++)if(this.items[u].diagnostic==a.diagnostic){c=u;break}c<0?(h=new Jc(this.view,a.diagnostic),this.items.splice(n,0,h),s=!0):(h=this.items[c],c>n&&(this.items.splice(n,c-n),s=!0)),t&&h.diagnostic==t.diagnostic?h.dom.hasAttribute("aria-selected")||(h.dom.setAttribute("aria-selected","true"),r=h):h.dom.hasAttribute("aria-selected")&&h.dom.removeAttribute("aria-selected"),n++});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)s=!0,this.items.pop();this.items.length==0&&(this.items.push(new Jc(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),s=!0),r?(this.list.setAttribute("aria-activedescendant",r.id),this.view.requestMeasure({key:this,read:()=>({sel:r.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{let a=l.height/this.list.offsetHeight;o.top<l.top?this.list.scrollTop-=(l.top-o.top)/a:o.bottom>l.bottom&&(this.list.scrollTop+=(o.bottom-l.bottom)/a)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),s&&this.sync()}sync(){let e=this.list.firstChild;function t(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(Ge),n=$n(t.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:_d.of(n)})}static open(e){return new Xs(e)}}function Vv(i,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(i)}</svg>')`}function ls(i){return Vv(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${i}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const zv=T.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:ls("#d11")},".cm-lintRange-warning":{backgroundImage:ls("orange")},".cm-lintRange-info":{backgroundImage:ls("#999")},".cm-lintRange-hint":{backgroundImage:ls("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),Td=[Ge,T.decorations.compute([Ge],i=>{let{selected:e,panel:t}=i.field(Ge);return!e||!t||e.from==e.to?V.none:V.set([Iv.range(e.from,e.to)])}),t1(Fv,{hideOn:Dv}),zv];class Ws{static create(e,t,n,s,r){let o=s+(s<<8)+e+(t<<4)|0;return new Ws(e,t,n,o,r,[],[])}constructor(e,t,n,s,r,o,l){this.type=e,this.value=t,this.from=n,this.hash=s,this.end=r,this.children=o,this.positions=l,this.hashProp=[[N.contextHash,s]]}addChild(e,t){e.prop(N.contextHash)!=this.hash&&(e=new Z(e.type,e.children,e.positions,e.length,this.hashProp)),this.children.push(e),this.positions.push(t)}toTree(e,t=this.end){let n=this.children.length-1;return n>=0&&(t=Math.max(t,this.positions[n]+this.children[n].length+this.from)),new Z(e.types[this.type],this.children,this.positions,t-this.from).balance({makeTree:(s,r,o)=>new Z(fe.none,s,r,o,this.hashProp)})}}var A;(function(i){i[i.Document=1]="Document",i[i.CodeBlock=2]="CodeBlock",i[i.FencedCode=3]="FencedCode",i[i.Blockquote=4]="Blockquote",i[i.HorizontalRule=5]="HorizontalRule",i[i.BulletList=6]="BulletList",i[i.OrderedList=7]="OrderedList",i[i.ListItem=8]="ListItem",i[i.ATXHeading1=9]="ATXHeading1",i[i.ATXHeading2=10]="ATXHeading2",i[i.ATXHeading3=11]="ATXHeading3",i[i.ATXHeading4=12]="ATXHeading4",i[i.ATXHeading5=13]="ATXHeading5",i[i.ATXHeading6=14]="ATXHeading6",i[i.SetextHeading1=15]="SetextHeading1",i[i.SetextHeading2=16]="SetextHeading2",i[i.HTMLBlock=17]="HTMLBlock",i[i.LinkReference=18]="LinkReference",i[i.Paragraph=19]="Paragraph",i[i.CommentBlock=20]="CommentBlock",i[i.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",i[i.Escape=22]="Escape",i[i.Entity=23]="Entity",i[i.HardBreak=24]="HardBreak",i[i.Emphasis=25]="Emphasis",i[i.StrongEmphasis=26]="StrongEmphasis",i[i.Link=27]="Link",i[i.Image=28]="Image",i[i.InlineCode=29]="InlineCode",i[i.HTMLTag=30]="HTMLTag",i[i.Comment=31]="Comment",i[i.ProcessingInstruction=32]="ProcessingInstruction",i[i.Autolink=33]="Autolink",i[i.HeaderMark=34]="HeaderMark",i[i.QuoteMark=35]="QuoteMark",i[i.ListMark=36]="ListMark",i[i.LinkMark=37]="LinkMark",i[i.EmphasisMark=38]="EmphasisMark",i[i.CodeMark=39]="CodeMark",i[i.CodeText=40]="CodeText",i[i.CodeInfo=41]="CodeInfo",i[i.LinkTitle=42]="LinkTitle",i[i.LinkLabel=43]="LinkLabel",i[i.URL=44]="URL"})(A||(A={}));class Xv{constructor(e,t){this.start=e,this.content=t,this.marks=[],this.parsers=[]}}class Wv{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let e=this.skipSpace(this.basePos);this.indent=this.countIndent(e,this.pos,this.indent),this.pos=e,this.next=e==this.text.length?-1:this.text.charCodeAt(e)}skipSpace(e){return hi(this.text,e)}reset(e){for(this.text=e,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(e){this.basePos=e,this.baseIndent=this.countIndent(e,this.pos,this.indent)}moveBaseColumn(e){this.baseIndent=e,this.basePos=this.findColumn(e)}addMarker(e){this.markers.push(e)}countIndent(e,t=0,n=0){for(let s=t;s<e;s++)n+=this.text.charCodeAt(s)==9?4-n%4:1;return n}findColumn(e){let t=0;for(let n=0;t<this.text.length&&n<e;t++)n+=this.text.charCodeAt(t)==9?4-n%4:1;return t}scrub(){if(!this.baseIndent)return this.text;let e="";for(let t=0;t<this.basePos;t++)e+=" ";return e+this.text.slice(this.basePos)}}function eh(i,e,t){if(t.pos==t.text.length||i!=e.block&&t.indent>=e.stack[t.depth+1].value+t.baseIndent)return!0;if(t.indent>=t.baseIndent+4)return!1;let n=(i.type==A.OrderedList?$l:Ml)(t,e,!1);return n>0&&(i.type!=A.BulletList||Rl(t,e,!1)<0)&&t.text.charCodeAt(t.pos+n-1)==i.value}const Rd={[A.Blockquote](i,e,t){return t.next!=62?!1:(t.markers.push(X(A.QuoteMark,e.lineStart+t.pos,e.lineStart+t.pos+1)),t.moveBase(t.pos+(et(t.text.charCodeAt(t.pos+1))?2:1)),i.end=e.lineStart+t.text.length,!0)},[A.ListItem](i,e,t){return t.indent<t.baseIndent+i.value&&t.next>-1?!1:(t.moveBaseColumn(t.baseIndent+i.value),!0)},[A.OrderedList]:eh,[A.BulletList]:eh,[A.Document](){return!0}};function et(i){return i==32||i==9||i==10||i==13}function hi(i,e=0){for(;e<i.length&&et(i.charCodeAt(e));)e++;return e}function th(i,e,t){for(;e>t&&et(i.charCodeAt(e-1));)e--;return e}function Md(i){if(i.next!=96&&i.next!=126)return-1;let e=i.pos+1;for(;e<i.text.length&&i.text.charCodeAt(e)==i.next;)e++;if(e<i.pos+3)return-1;if(i.next==96){for(let t=e;t<i.text.length;t++)if(i.text.charCodeAt(t)==96)return-1}return e}function $d(i){return i.next!=62?-1:i.text.charCodeAt(i.pos+1)==32?2:1}function Rl(i,e,t){if(i.next!=42&&i.next!=45&&i.next!=95)return-1;let n=1;for(let s=i.pos+1;s<i.text.length;s++){let r=i.text.charCodeAt(s);if(r==i.next)n++;else if(!et(r))return-1}return t&&i.next==45&&Ld(i)>-1&&i.depth==e.stack.length&&e.parser.leafBlockParsers.indexOf(qd.SetextHeading)>-1||n<3?-1:1}function Dd(i,e){for(let t=i.stack.length-1;t>=0;t--)if(i.stack[t].type==e)return!0;return!1}function Ml(i,e,t){return(i.next==45||i.next==43||i.next==42)&&(i.pos==i.text.length-1||et(i.text.charCodeAt(i.pos+1)))&&(!t||Dd(e,A.BulletList)||i.skipSpace(i.pos+2)<i.text.length)?1:-1}function $l(i,e,t){let n=i.pos,s=i.next;for(;s>=48&&s<=57;){n++;if(n==i.text.length)return-1;s=i.text.charCodeAt(n)}return n==i.pos||n>i.pos+9||s!=46&&s!=41||n<i.text.length-1&&!et(i.text.charCodeAt(n+1))||t&&!Dd(e,A.OrderedList)&&(i.skipSpace(n+1)==i.text.length||n>i.pos+1||i.next!=49)?-1:n+1-i.pos}function Bd(i){if(i.next!=35)return-1;let e=i.pos+1;for(;e<i.text.length&&i.text.charCodeAt(e)==35;)e++;if(e<i.text.length&&i.text.charCodeAt(e)!=32)return-1;let t=e-i.pos;return t>6?-1:t}function Ld(i){if(i.next!=45&&i.next!=61||i.indent>=i.baseIndent+4)return-1;let e=i.pos+1;for(;e<i.text.length&&i.text.charCodeAt(e)==i.next;)e++;let t=e;for(;e<i.text.length&&et(i.text.charCodeAt(e));)e++;return e==i.text.length?t:-1}const Fo=/^[ \t]*$/,Id=/-->/,Fd=/\?>/,No=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,Id],[/^\s*<\?/,Fd],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,Fo],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,Fo]];function Nd(i,e,t){if(i.next!=60)return-1;let n=i.text.slice(i.pos);for(let s=0,r=No.length-(t?1:0);s<r;s++)if(No[s][0].test(n))return s;return-1}function nh(i,e){let t=i.countIndent(e,i.pos,i.indent),n=i.countIndent(i.skipSpace(e),e,t);return n>=t+5?t+1:n}function Ht(i,e,t){let n=i.length-1;n>=0&&i[n].to==e&&i[n].type==A.CodeText?i[n].to=t:i.push(X(A.CodeText,e,t))}const as={LinkReference:void 0,IndentedCode(i,e){let t=e.baseIndent+4;if(e.indent<t)return!1;let n=e.findColumn(t),s=i.lineStart+n,r=i.lineStart+e.text.length,o=[],l=[];for(Ht(o,s,r);i.nextLine()&&e.depth>=i.stack.length;)if(e.pos==e.text.length){Ht(l,i.lineStart-1,i.lineStart);for(let a of e.markers)l.push(a)}else{if(e.indent<t)break;{if(l.length){for(let c of l)c.type==A.CodeText?Ht(o,c.from,c.to):o.push(c);l=[]}Ht(o,i.lineStart-1,i.lineStart);for(let c of e.markers)o.push(c);r=i.lineStart+e.text.length;let a=i.lineStart+e.findColumn(e.baseIndent+4);a<r&&Ht(o,a,r)}}return l.length&&(l=l.filter(a=>a.type!=A.CodeText),l.length&&(e.markers=l.concat(e.markers))),i.addNode(i.buffer.writeElements(o,-s).finish(A.CodeBlock,r-s),s),!0},FencedCode(i,e){let t=Md(e);if(t<0)return!1;let n=i.lineStart+e.pos,s=e.next,r=t-e.pos,o=e.skipSpace(t),l=th(e.text,e.text.length,o),a=[X(A.CodeMark,n,n+r)];o<l&&a.push(X(A.CodeInfo,i.lineStart+o,i.lineStart+l));for(let c=!0;i.nextLine()&&e.depth>=i.stack.length;c=!1){let h=e.pos;if(e.indent-e.baseIndent<4)for(;h<e.text.length&&e.text.charCodeAt(h)==s;)h++;if(h-e.pos>=r&&e.skipSpace(h)==e.text.length){for(let u of e.markers)a.push(u);a.push(X(A.CodeMark,i.lineStart+e.pos,i.lineStart+h)),i.nextLine();break}else{c||Ht(a,i.lineStart-1,i.lineStart);for(let d of e.markers)a.push(d);let u=i.lineStart+e.basePos,f=i.lineStart+e.text.length;u<f&&Ht(a,u,f)}}return i.addNode(i.buffer.writeElements(a,-n).finish(A.FencedCode,i.prevLineEnd()-n),n),!0},Blockquote(i,e){let t=$d(e);return t<0?!1:(i.startContext(A.Blockquote,e.pos),i.addNode(A.QuoteMark,i.lineStart+e.pos,i.lineStart+e.pos+1),e.moveBase(e.pos+t),null)},HorizontalRule(i,e){if(Rl(e,i,!1)<0)return!1;let t=i.lineStart+e.pos;return i.nextLine(),i.addNode(A.HorizontalRule,t),!0},BulletList(i,e){let t=Ml(e,i,!1);if(t<0)return!1;i.block.type!=A.BulletList&&i.startContext(A.BulletList,e.basePos,e.next);let n=nh(e,e.pos+1);return i.startContext(A.ListItem,e.basePos,n-e.baseIndent),i.addNode(A.ListMark,i.lineStart+e.pos,i.lineStart+e.pos+t),e.moveBaseColumn(n),null},OrderedList(i,e){let t=$l(e,i,!1);if(t<0)return!1;i.block.type!=A.OrderedList&&i.startContext(A.OrderedList,e.basePos,e.text.charCodeAt(e.pos+t-1));let n=nh(e,e.pos+t);return i.startContext(A.ListItem,e.basePos,n-e.baseIndent),i.addNode(A.ListMark,i.lineStart+e.pos,i.lineStart+e.pos+t),e.moveBaseColumn(n),null},ATXHeading(i,e){let t=Bd(e);if(t<0)return!1;let n=e.pos,s=i.lineStart+n,r=th(e.text,e.text.length,n),o=r;for(;o>n&&e.text.charCodeAt(o-1)==e.next;)o--;(o==r||o==n||!et(e.text.charCodeAt(o-1)))&&(o=e.text.length);let l=i.buffer.write(A.HeaderMark,0,t).writeElements(i.parser.parseInline(e.text.slice(n+t+1,o),s+t+1),-s);o<e.text.length&&l.write(A.HeaderMark,o-n,r-n);let a=l.finish(A.ATXHeading1-1+t,e.text.length-n);return i.nextLine(),i.addNode(a,s),!0},HTMLBlock(i,e){let t=Nd(e,i,!1);if(t<0)return!1;let n=i.lineStart+e.pos,s=No[t][1],r=[],o=s!=Fo;for(;!s.test(e.text)&&i.nextLine();){if(e.depth<i.stack.length){o=!1;break}for(let c of e.markers)r.push(c)}o&&i.nextLine();let l=s==Id?A.CommentBlock:s==Fd?A.ProcessingInstructionBlock:A.HTMLBlock,a=i.prevLineEnd();return i.addNode(i.buffer.writeElements(r,-n).finish(l,a-n),n),!0},SetextHeading:void 0};class jv{constructor(e){this.stage=0,this.elts=[],this.pos=0,this.start=e.start,this.advance(e.content)}nextLine(e,t,n){if(this.stage==-1)return!1;let s=n.content+`
`+t.scrub(),r=this.advance(s);return r>-1&&r<s.length?this.complete(e,n,r):!1}finish(e,t){return(this.stage==2||this.stage==3)&&hi(t.content,this.pos)==t.content.length?this.complete(e,t,t.content.length):!1}complete(e,t,n){return e.addLeafElement(t,X(A.LinkReference,this.start,this.start+n,this.elts)),!0}nextStage(e){return e?(this.pos=e.to-this.start,this.elts.push(e),this.stage++,!0):(e===!1&&(this.stage=-1),!1)}advance(e){for(;;){if(this.stage==-1)return-1;if(this.stage==0){if(!this.nextStage(Ud(e,this.pos,this.start,!0)))return-1;if(e.charCodeAt(this.pos)!=58)return this.stage=-1;this.elts.push(X(A.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else if(this.stage==1){if(!this.nextStage(jd(e,hi(e,this.pos),this.start)))return-1}else if(this.stage==2){let t=hi(e,this.pos),n=0;if(t>this.pos){let s=Yd(e,t,this.start);if(s){let r=Fr(e,s.to-this.start);r>0&&(this.nextStage(s),n=r)}}return n||(n=Fr(e,this.pos)),n>0&&n<e.length?n:-1}else return Fr(e,this.pos)}}}function Fr(i,e){for(;e<i.length;e++){let t=i.charCodeAt(e);if(t==10)break;if(!et(t))return-1}return e}class Yv{nextLine(e,t,n){let s=t.depth<e.stack.length?-1:Ld(t),r=t.next;if(s<0)return!1;let o=X(A.HeaderMark,e.lineStart+t.pos,e.lineStart+s);return e.nextLine(),e.addLeafElement(n,X(r==61?A.SetextHeading1:A.SetextHeading2,n.start,e.prevLineEnd(),[...e.parser.parseInline(n.content,n.start),o])),!0}finish(){return!1}}const qd={LinkReference(i,e){return e.content.charCodeAt(0)==91?new jv(e):null},SetextHeading(){return new Yv}},Uv=[(i,e)=>Bd(e)>=0,(i,e)=>Md(e)>=0,(i,e)=>$d(e)>=0,(i,e)=>Ml(e,i,!0)>=0,(i,e)=>$l(e,i,!0)>=0,(i,e)=>Rl(e,i,!0)>=0,(i,e)=>Nd(e,i,!0)>=0],Gv={text:"",end:0};class Kv{constructor(e,t,n,s){this.parser=e,this.input=t,this.ranges=s,this.line=new Wv,this.atEnd=!1,this.reusePlaceholders=new Map,this.stoppedAt=null,this.rangeI=0,this.to=s[s.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=s[0].from,this.block=Ws.create(A.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=n.length?new tx(n,t):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(this.stoppedAt!=null&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:e}=this;for(;;){for(let n=0;;){let s=e.depth<this.stack.length?this.stack[this.stack.length-1]:null;for(;n<e.markers.length&&(!s||e.markers[n].from<s.end);){let r=e.markers[n++];this.addNode(r.type,r.from,r.to)}if(!s)break;this.finishContext()}if(e.pos<e.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(e.basePos))return null;e:for(;;){for(let n of this.parser.blockParsers)if(n){let s=n(this,e);if(s!=!1){if(s==!0)return null;e.forward();continue e}}break}let t=new Xv(this.lineStart+e.pos,e.text.slice(e.pos));for(let n of this.parser.leafBlockParsers)if(n){let s=n(this,t);s&&t.parsers.push(s)}e:for(;this.nextLine()&&e.pos!=e.text.length;){if(e.indent<e.baseIndent+4){for(let n of this.parser.endLeafBlock)if(n(this,e,t))break e}for(let n of t.parsers)if(n.nextLine(this,e,t))return null;t.content+=`
`+e.scrub();for(let n of e.markers)t.marks.push(n)}return this.finishLeaf(t),null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}reuseFragment(e){if(!this.fragments.moveTo(this.absoluteLineStart+e,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let t=this.fragments.takeNodes(this);return t?(this.absoluteLineStart+=t,this.lineStart=Gd(this.absoluteLineStart,this.ranges),this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0):!1}get depth(){return this.stack.length}parentType(e=this.depth-1){return this.parser.nodeSet.types[this.stack[e].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(e){let t=Gv;if(t.end=e,e>=this.to)t.text="";else if(t.text=this.lineChunkAt(e),t.end+=t.text.length,this.ranges.length>1){let n=this.absoluteLineStart,s=this.rangeI;for(;this.ranges[s].to<t.end;){s++;let r=this.ranges[s].from,o=this.lineChunkAt(r);t.end=r+o.length,t.text=t.text.slice(0,this.ranges[s-1].to-n)+o,n=t.end-t.text.length}}return t}readLine(){let{line:e}=this,{text:t,end:n}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=n,e.reset(t);e.depth<this.stack.length;e.depth++){let s=this.stack[e.depth],r=this.parser.skipContextMarkup[s.type];if(!r)throw new Error("Unhandled block context "+A[s.type]);if(!r(s,this,e))break;e.forward()}}lineChunkAt(e){let t=this.input.chunk(e),n;if(this.input.lineChunks)n=t==`
`?"":t;else{let s=t.indexOf(`
`);n=s<0?t:t.slice(0,s)}return e+n.length>this.to?n.slice(0,this.to-e):n}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(e,t,n=0){this.block=Ws.create(e,n,this.lineStart+t,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(e,t,n=0){this.startContext(this.parser.getNodeType(e),t,n)}addNode(e,t,n){typeof e=="number"&&(e=new Z(this.parser.nodeSet.types[e],Dn,Dn,(n??this.prevLineEnd())-t)),this.block.addChild(e,t-this.block.from)}addElement(e){this.block.addChild(e.toTree(this.parser.nodeSet),e.from-this.block.from)}addLeafElement(e,t){this.addNode(this.buffer.writeElements(Vo(t.children,e.marks),-t.from).finish(t.type,t.to-t.from),t.from)}finishContext(){let e=this.stack.pop(),t=this.stack[this.stack.length-1];t.addChild(e.toTree(this.parser.nodeSet),e.from-t.from),this.block=t}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(e){return this.ranges.length>1?Qd(this.ranges,0,e.topNode,this.ranges[0].from,this.reusePlaceholders):e}finishLeaf(e){for(let n of e.parsers)if(n.finish(this,e))return;let t=Vo(this.parser.parseInline(e.content,e.start),e.marks);this.addNode(this.buffer.writeElements(t,-e.start).finish(A.Paragraph,e.content.length),e.start)}elt(e,t,n,s){return typeof e=="string"?X(this.parser.getNodeType(e),t,n,s):new zd(e,t)}get buffer(){return new Vd(this.parser.nodeSet)}}function Qd(i,e,t,n,s){let r=i[e].to,o=[],l=[],a=t.from+n;function c(h,u){for(;u?h>=r:h>r;){let f=i[e+1].from-r;n+=f,h+=f,e++,r=i[e].to}}for(let h=t.firstChild;h;h=h.nextSibling){c(h.from+n,!0);let u=h.from+n,f,d=s.get(h.tree);d?f=d:h.to+n>r?(f=Qd(i,e,h,n,s),c(h.to+n,!1)):f=h.toTree(),o.push(f),l.push(u-a)}return c(t.to+n,!1),new Z(t.type,o,l,t.to+n-a,t.tree?t.tree.propValues:void 0)}class Dl extends Zo{constructor(e,t,n,s,r,o,l,a,c){super(),this.nodeSet=e,this.blockParsers=t,this.leafBlockParsers=n,this.blockNames=s,this.endLeafBlock=r,this.skipContextMarkup=o,this.inlineParsers=l,this.inlineNames=a,this.wrappers=c,this.nodeTypes=Object.create(null);for(let h of e.types)this.nodeTypes[h.name]=h.id}createParse(e,t,n){let s=new Kv(this,e,t,n);for(let r of this.wrappers)s=r(s,e,t,n);return s}configure(e){let t=qo(e);if(!t)return this;let{nodeSet:n,skipContextMarkup:s}=this,r=this.blockParsers.slice(),o=this.leafBlockParsers.slice(),l=this.blockNames.slice(),a=this.inlineParsers.slice(),c=this.inlineNames.slice(),h=this.endLeafBlock.slice(),u=this.wrappers;if(Un(t.defineNodes)){s=Object.assign({},s);let f=n.types.slice(),d;for(let p of t.defineNodes){let{name:m,block:b,composite:y,style:v}=typeof p=="string"?{name:p}:p;if(f.some(k=>k.name==m))continue;y&&(s[f.length]=(k,_,E)=>y(_,E,k.value));let x=f.length,w=y?["Block","BlockContext"]:b?x>=A.ATXHeading1&&x<=A.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;f.push(fe.define({id:x,name:m,props:w&&[[N.group,w]]})),v&&(d||(d={}),Array.isArray(v)||v instanceof Le?d[m]=v:Object.assign(d,v))}n=new Ti(f),d&&(n=n.extend(Ri(d)))}if(Un(t.props)&&(n=n.extend(...t.props)),Un(t.remove))for(let f of t.remove){let d=this.blockNames.indexOf(f),p=this.inlineNames.indexOf(f);d>-1&&(r[d]=o[d]=void 0),p>-1&&(a[p]=void 0)}if(Un(t.parseBlock))for(let f of t.parseBlock){let d=l.indexOf(f.name);if(d>-1)r[d]=f.parse,o[d]=f.leaf;else{let p=f.before?cs(l,f.before):f.after?cs(l,f.after)+1:l.length-1;r.splice(p,0,f.parse),o.splice(p,0,f.leaf),l.splice(p,0,f.name)}f.endLeaf&&h.push(f.endLeaf)}if(Un(t.parseInline))for(let f of t.parseInline){let d=c.indexOf(f.name);if(d>-1)a[d]=f.parse;else{let p=f.before?cs(c,f.before):f.after?cs(c,f.after)+1:c.length-1;a.splice(p,0,f.parse),c.splice(p,0,f.name)}}return t.wrap&&(u=u.concat(t.wrap)),new Dl(n,r,o,l,h,s,a,c,u)}getNodeType(e){let t=this.nodeTypes[e];if(t==null)throw new RangeError(`Unknown node type '${e}'`);return t}parseInline(e,t){let n=new Jv(this,e,t);e:for(let s=t;s<n.end;){let r=n.char(s);for(let o of this.inlineParsers)if(o){let l=o(n,r,s);if(l>=0){s=l;continue e}}s++}return n.resolveMarkers(0)}}function Un(i){return i!=null&&i.length>0}function qo(i){if(!Array.isArray(i))return i;if(i.length==0)return null;let e=qo(i[0]);if(i.length==1)return e;let t=qo(i.slice(1));if(!t||!e)return e||t;let n=(o,l)=>(o||Dn).concat(l||Dn),s=e.wrap,r=t.wrap;return{props:n(e.props,t.props),defineNodes:n(e.defineNodes,t.defineNodes),parseBlock:n(e.parseBlock,t.parseBlock),parseInline:n(e.parseInline,t.parseInline),remove:n(e.remove,t.remove),wrap:s?r?(o,l,a,c)=>s(r(o,l,a,c),l,a,c):s:r}}function cs(i,e){let t=i.indexOf(e);if(t<0)throw new RangeError(`Position specified relative to unknown parser ${e}`);return t}let Hd=[fe.none];for(let i=1,e;e=A[i];i++)Hd[i]=fe.define({id:i,name:e,props:i>=A.Escape?[]:[[N.group,i in Rd?["Block","BlockContext"]:["Block","LeafBlock"]]],top:e=="Document"});const Dn=[];class Vd{constructor(e){this.nodeSet=e,this.content=[],this.nodes=[]}write(e,t,n,s=0){return this.content.push(e,t,n,4+s*4),this}writeElements(e,t=0){for(let n of e)n.writeTo(this,t);return this}finish(e,t){return Z.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:e,length:t})}}let Ei=class{constructor(e,t,n,s=Dn){this.type=e,this.from=t,this.to=n,this.children=s}writeTo(e,t){let n=e.content.length;e.writeElements(this.children,t),e.content.push(this.type,this.from+t,this.to+t,e.content.length+4-n)}toTree(e){return new Vd(e).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}};class zd{constructor(e,t){this.tree=e,this.from=t}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return Dn}writeTo(e,t){e.nodes.push(this.tree),e.content.push(e.nodes.length-1,this.from+t,this.to+t,-1)}toTree(){return this.tree}}function X(i,e,t,n){return new Ei(i,e,t,n)}const Xd={resolve:"Emphasis",mark:"EmphasisMark"},Wd={resolve:"Emphasis",mark:"EmphasisMark"},fn={},Qo={};class Qe{constructor(e,t,n,s){this.type=e,this.from=t,this.to=n,this.side=s}}const ih="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";let Ho=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{Ho=new RegExp("[\\p{S}|\\p{P}]","u")}catch{}const Nr={Escape(i,e,t){if(e!=92||t==i.end-1)return-1;let n=i.char(t+1);for(let s=0;s<ih.length;s++)if(ih.charCodeAt(s)==n)return i.append(X(A.Escape,t,t+2));return-1},Entity(i,e,t){if(e!=38)return-1;let n=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(i.slice(t+1,t+31));return n?i.append(X(A.Entity,t,t+1+n[0].length)):-1},InlineCode(i,e,t){if(e!=96||t&&i.char(t-1)==96)return-1;let n=t+1;for(;n<i.end&&i.char(n)==96;)n++;let s=n-t,r=0;for(;n<i.end;n++)if(i.char(n)==96){if(r++,r==s&&i.char(n+1)!=96)return i.append(X(A.InlineCode,t,n+1,[X(A.CodeMark,t,t+s),X(A.CodeMark,n+1-s,n+1)]))}else r=0;return-1},HTMLTag(i,e,t){if(e!=60||t==i.end-1)return-1;let n=i.slice(t+1,i.end),s=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(n);if(s)return i.append(X(A.Autolink,t,t+1+s[0].length,[X(A.LinkMark,t,t+1),X(A.URL,t+1,t+s[0].length),X(A.LinkMark,t+s[0].length,t+1+s[0].length)]));let r=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(n);if(r)return i.append(X(A.Comment,t,t+1+r[0].length));let o=/^\?[^]*?\?>/.exec(n);if(o)return i.append(X(A.ProcessingInstruction,t,t+1+o[0].length));let l=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(n);return l?i.append(X(A.HTMLTag,t,t+1+l[0].length)):-1},Emphasis(i,e,t){if(e!=95&&e!=42)return-1;let n=t+1;for(;i.char(n)==e;)n++;let s=i.slice(t-1,t),r=i.slice(n,n+1),o=Ho.test(s),l=Ho.test(r),a=/\s|^$/.test(s),c=/\s|^$/.test(r),h=!c&&(!l||a||o),u=!a&&(!o||c||l),f=h&&(e==42||!u||o),d=u&&(e==42||!h||l);return i.append(new Qe(e==95?Xd:Wd,t,n,(f?1:0)|(d?2:0)))},HardBreak(i,e,t){if(e==92&&i.char(t+1)==10)return i.append(X(A.HardBreak,t,t+2));if(e==32){let n=t+1;for(;i.char(n)==32;)n++;if(i.char(n)==10&&n>=t+2)return i.append(X(A.HardBreak,t,n+1))}return-1},Link(i,e,t){return e==91?i.append(new Qe(fn,t,t+1,1)):-1},Image(i,e,t){return e==33&&i.char(t+1)==91?i.append(new Qe(Qo,t,t+2,1)):-1},LinkEnd(i,e,t){if(e!=93)return-1;for(let n=i.parts.length-1;n>=0;n--){let s=i.parts[n];if(s instanceof Qe&&(s.type==fn||s.type==Qo)){if(!s.side||i.skipSpace(s.to)==t&&!/[(\[]/.test(i.slice(t+1,t+2)))return i.parts[n]=null,-1;let r=i.takeContent(n),o=i.parts[n]=Zv(i,r,s.type==fn?A.Link:A.Image,s.from,t+1);if(s.type==fn)for(let l=0;l<n;l++){let a=i.parts[l];a instanceof Qe&&a.type==fn&&(a.side=0)}return o.to}}return-1}};function Zv(i,e,t,n,s){let{text:r}=i,o=i.char(s),l=s;if(e.unshift(X(A.LinkMark,n,n+(t==A.Image?2:1))),e.push(X(A.LinkMark,s-1,s)),o==40){let a=i.skipSpace(s+1),c=jd(r,a-i.offset,i.offset),h;c&&(a=i.skipSpace(c.to),a!=c.to&&(h=Yd(r,a-i.offset,i.offset),h&&(a=i.skipSpace(h.to)))),i.char(a)==41&&(e.push(X(A.LinkMark,s,s+1)),l=a+1,c&&e.push(c),h&&e.push(h),e.push(X(A.LinkMark,a,l)))}else if(o==91){let a=Ud(r,s-i.offset,i.offset,!1);a&&(e.push(a),l=a.to)}return X(t,n,l,e)}function jd(i,e,t){if(i.charCodeAt(e)==60){for(let s=e+1;s<i.length;s++){let r=i.charCodeAt(s);if(r==62)return X(A.URL,e+t,s+1+t);if(r==60||r==10)return!1}return null}else{let s=0,r=e;for(let o=!1;r<i.length;r++){let l=i.charCodeAt(r);if(et(l))break;if(o)o=!1;else if(l==40)s++;else if(l==41){if(!s)break;s--}else l==92&&(o=!0)}return r>e?X(A.URL,e+t,r+t):r==i.length?null:!1}}function Yd(i,e,t){let n=i.charCodeAt(e);if(n!=39&&n!=34&&n!=40)return!1;let s=n==40?41:n;for(let r=e+1,o=!1;r<i.length;r++){let l=i.charCodeAt(r);if(o)o=!1;else{if(l==s)return X(A.LinkTitle,e+t,r+1+t);l==92&&(o=!0)}}return null}function Ud(i,e,t,n){for(let s=!1,r=e+1,o=Math.min(i.length,r+999);r<o;r++){let l=i.charCodeAt(r);if(s)s=!1;else{if(l==93)return n?!1:X(A.LinkLabel,e+t,r+1+t);if(n&&!et(l)&&(n=!1),l==91)return!1;l==92&&(s=!0)}}return null}class Jv{constructor(e,t,n){this.parser=e,this.text=t,this.offset=n,this.parts=[]}char(e){return e>=this.end?-1:this.text.charCodeAt(e-this.offset)}get end(){return this.offset+this.text.length}slice(e,t){return this.text.slice(e-this.offset,t-this.offset)}append(e){return this.parts.push(e),e.to}addDelimiter(e,t,n,s,r){return this.append(new Qe(e,t,n,(s?1:0)|(r?2:0)))}get hasOpenLink(){for(let e=this.parts.length-1;e>=0;e--){let t=this.parts[e];if(t instanceof Qe&&(t.type==fn||t.type==Qo))return!0}return!1}addElement(e){return this.append(e)}resolveMarkers(e){for(let n=e;n<this.parts.length;n++){let s=this.parts[n];if(!(s instanceof Qe&&s.type.resolve&&s.side&2))continue;let r=s.type==Xd||s.type==Wd,o=s.to-s.from,l,a=n-1;for(;a>=e;a--){let m=this.parts[a];if(m instanceof Qe&&m.side&1&&m.type==s.type&&!(r&&(s.side&1||m.side&2)&&(m.to-m.from+o)%3==0&&((m.to-m.from)%3||o%3))){l=m;break}}if(!l)continue;let c=s.type.resolve,h=[],u=l.from,f=s.to;if(r){let m=Math.min(2,l.to-l.from,o);u=l.to-m,f=s.from+m,c=m==1?"Emphasis":"StrongEmphasis"}l.type.mark&&h.push(this.elt(l.type.mark,u,l.to));for(let m=a+1;m<n;m++)this.parts[m]instanceof Ei&&h.push(this.parts[m]),this.parts[m]=null;s.type.mark&&h.push(this.elt(s.type.mark,s.from,f));let d=this.elt(c,u,f,h);this.parts[a]=r&&l.from!=u?new Qe(l.type,l.from,u,l.side):null,(this.parts[n]=r&&s.to!=f?new Qe(s.type,f,s.to,s.side):null)?this.parts.splice(n,0,d):this.parts[n]=d}let t=[];for(let n=e;n<this.parts.length;n++){let s=this.parts[n];s instanceof Ei&&t.push(s)}return t}findOpeningDelimiter(e){for(let t=this.parts.length-1;t>=0;t--){let n=this.parts[t];if(n instanceof Qe&&n.type==e)return t}return null}takeContent(e){let t=this.resolveMarkers(e);return this.parts.length=e,t}skipSpace(e){return hi(this.text,e-this.offset)+this.offset}elt(e,t,n,s){return typeof e=="string"?X(this.parser.getNodeType(e),t,n,s):new zd(e,t)}}function Vo(i,e){if(!e.length)return i;if(!i.length)return e;let t=i.slice(),n=0;for(let s of e){for(;n<t.length&&t[n].to<s.to;)n++;if(n<t.length&&t[n].from<s.from){let r=t[n];r instanceof Ei&&(t[n]=new Ei(r.type,r.from,r.to,Vo(r.children,[s])))}else t.splice(n++,0,s)}return t}const ex=[A.CodeBlock,A.ListItem,A.OrderedList,A.BulletList];class tx{constructor(e,t){this.fragments=e,this.input=t,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,e.length&&(this.fragment=e[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(e,t){for(;this.fragment&&this.fragment.to<=e;)this.nextFragment();if(!this.fragment||this.fragment.from>(e?e-1:0))return!1;if(this.fragmentEnd<0){let r=this.fragment.to;for(;r>0&&this.input.read(r-1,r)!=`
`;)r--;this.fragmentEnd=r?r-1:0}let n=this.cursor;n||(n=this.cursor=this.fragment.tree.cursor(),n.firstChild());let s=e+this.fragment.offset;for(;n.to<=s;)if(!n.parent())return!1;for(;;){if(n.from>=s)return this.fragment.from<=t;if(!n.childAfter(s))return!1}}matches(e){let t=this.cursor.tree;return t&&t.prop(N.contextHash)==e}takeNodes(e){let t=this.cursor,n=this.fragment.offset,s=this.fragmentEnd-(this.fragment.openEnd?1:0),r=e.absoluteLineStart,o=r,l=e.block.children.length,a=o,c=l;for(;;){if(t.to-n>s){if(t.type.isAnonymous&&t.firstChild())continue;break}let h=Gd(t.from-n,e.ranges);if(t.to-n<=e.ranges[e.rangeI].to)e.addNode(t.tree,h);else{let u=new Z(e.parser.nodeSet.types[A.Paragraph],[],[],0,e.block.hashProp);e.reusePlaceholders.set(u,t.tree),e.addNode(u,h)}if(t.type.is("Block")&&(ex.indexOf(t.type.id)<0?(o=t.to-n,l=e.block.children.length):(o=a,l=c,a=t.to-n,c=e.block.children.length)),!t.nextSibling())break}for(;e.block.children.length>l;)e.block.children.pop(),e.block.positions.pop();return o-r}}function Gd(i,e){let t=i;for(let n=1;n<e.length;n++){let s=e[n-1].to,r=e[n].from;s<i&&(t-=r-s)}return t}const nx=Ri({"Blockquote/...":g.quote,HorizontalRule:g.contentSeparator,"ATXHeading1/... SetextHeading1/...":g.heading1,"ATXHeading2/... SetextHeading2/...":g.heading2,"ATXHeading3/...":g.heading3,"ATXHeading4/...":g.heading4,"ATXHeading5/...":g.heading5,"ATXHeading6/...":g.heading6,"Comment CommentBlock":g.comment,Escape:g.escape,Entity:g.character,"Emphasis/...":g.emphasis,"StrongEmphasis/...":g.strong,"Link/... Image/...":g.link,"OrderedList/... BulletList/...":g.list,"BlockQuote/...":g.quote,"InlineCode CodeText":g.monospace,"URL Autolink":g.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":g.processingInstruction,"CodeInfo LinkLabel":g.labelName,LinkTitle:g.string,Paragraph:g.content}),ix=new Dl(new Ti(Hd).extend(nx),Object.keys(as).map(i=>as[i]),Object.keys(as).map(i=>qd[i]),Object.keys(as),Uv,Rd,Object.keys(Nr).map(i=>Nr[i]),Object.keys(Nr),[]);g.strikethrough,g.processingInstruction;g.heading,g.content,g.processingInstruction;g.list,g.atom;g.special(g.content),g.processingInstruction;g.special(g.content),g.processingInstruction;g.character;function sx(i){const e=[];return i.iterate({enter:t=>{const n=t.node;if(!n.type.isError)return;const s=n.parent,r=Kd(n),o={from:n.from,to:n.to,severity:"error",type:"Syntax Error"};if(n.from!==n.to)o.message=`Unrecognized token in <${s.name}>`;else if(r)o.message=`Unrecognized token <${r.name}> in <${s.name}>`,o.to=r.to;else{const l=s.enterUnfinishedNodesBefore(n.to);o.message=`Incomplete <${(l||s).name}>`}e.push(o)}}),e}function Kd(i){return i?i.nextSibling||Kd(i.parent):null}const rx="first-item";var ox={create(i){return{enter(e){if(e.name!=="FilterExpression")return;const t=i.readContent(e.from,e.to);if(sh().test(t)){const{from:n,to:s}=e;i.report({from:n,to:s,message:"First item is accessed via [1]",severity:"warning",type:rx,actions:[{name:"fix",apply(r,o=n,l=s){i.updateContent(o,l,t.replace(sh(),"[1]"))}}]})}}}}};function sh(){return/\[\s*0\s*\]$/}const lx=[ox];function ax(i){const{readContent:e,syntaxTree:t,updateContent:n}=i,s=[],r={readContent:e,report:l=>{s.push(l)},updateContent:n},o=lx.map(l=>l.create(r));return t.iterate({enter:l=>{for(const a of o)a.enter&&a.enter(l)},leave:l=>{for(const a of o)a.leave&&a.leave(l)}}),s}function cx(i){return[...sx(i.syntaxTree),...ax(i)]}const Zd=()=>i=>{if(i.state.doc.length===0)return[];const e=de(i.state);return cx({syntaxTree:e,readContent:(n,s)=>i.state.sliceDoc(n,s),updateContent:(n,s,r)=>i.dispatch({changes:{from:n,to:s,insert:r}})}).map(n=>({...n,source:n.type}))},hx=cr(Ft.define([{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"}])),ux=T.theme({"& .cm-lintRange":{position:"relative"},"& .cm-lintRange::after":{content:'""',width:"100%",position:"absolute",left:"0px",bottom:"-2px",height:"3px",backgroundRepeat:"repeat-x"},"& .cm-lintRange.cm-lintRange-warning, & .cm-lintRange.cm-lintRange-error":{backgroundImage:"none"},"& .cm-lintPoint::after":{bottom:"-2px"}});var Jd=[ux,hx];const rh=i=>`%23${i.slice(1)}`,q={black:"#1f2b36",darkGrey:"#2f3d58",grey:"#404a5c",midGrey:"#576071",offWhite:"#d9e0f5",snowWhite:"#eaf1ff",white:"#ffffff",mossGreen:"#7ab6aa",iceBlue:"#6cbfd8",waterBlue:"#065aaa",brightBlue:"#0a56b9",deepBlue:"#355472",red:"#9f1c15",orangeBrown:"#b4502f",yellow:"#debd71",lila:"#9a4890",purple:"#5b2c83"},ue={lightBackground:q.white,darkBackground:q.snowWhite,selection:q.snowWhite,tooltipBackground:q.offWhite,error:q.red,warning:q.yellow,invalid:"#b40000"},fx=T.theme({"&":{color:q.black,backgroundColor:ue.lightBackground},".cm-content":{caretColor:q.darkGrey},".cm-cursor, .cm-dropCursor":{borderLeftColor:q.darkGrey},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:ue.selection},".cm-panels":{backgroundColor:ue.darkBackground,color:q.grey},".cm-panels.cm-panels-top":{borderBottom:`2px solid ${q.black}`},".cm-panels.cm-panels-bottom":{borderTop:`2px solid ${q.black}`},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:`1px solid ${q.midGrey}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:q.offWhite},".cm-activeLine":{backgroundColor:ue.selection},".cm-selectionMatch":{backgroundColor:q.offWhite},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${q.grey}`},"&.cm-focused .cm-matchingBracket":{backgroundColor:q.snowWhite},".cm-gutters":{backgroundColor:"#f3f7fe",color:"#52668d",border:"none",padding:"0 5px"},".cm-activeLineGutter":{backgroundColor:ue.selection},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:ue.tooltipBackground},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:ue.tooltipBackground,borderBottomColor:ue.tooltipBackground},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:ue.darkBackground,color:q.midGrey}},"& .cm-lintRange.cm-lintRange-warning::after":{backgroundImage:`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='6' height='3'><path d='m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0' stroke='${rh(ue.warning)}' fill='none' stroke-width='1.2'/></svg>")`},"& .cm-lintRange.cm-lintRange-error::after":{backgroundImage:`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='6' height='3'><path d='m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0' stroke='${rh(ue.error)}' fill='none' stroke-width='1.2'/></svg>")`},"& .cm-diagnostic-warning":{border:`1px solid ${ue.warning}`,borderLeft:`5px solid ${ue.warning}`,background:ue.lightBackground},"& .cm-diagnostic-error":{border:`1px solid ${ue.error}`,borderLeft:`5px solid ${ue.error}`,background:ue.lightBackground},"& .cm-diagnostic":{padding:"3px 8px"}},{dark:!1}),dx=cr(Ft.define([{tag:[g.macroName,g.variableName],color:q.waterBlue},{tag:[g.special(g.bracket)],color:q.waterBlue,fontWeight:"bold"},{tag:[g.color,g.name,g.definition(g.name),g.constant(g.name),g.standard(g.name),g.propertyName],color:q.deepBlue},{tag:[g.definition(g.variableName),g.function(g.variableName),g.function(g.propertyName)],color:q.brightBlue},{tag:[g.labelName],color:q.orangeBrown},{tag:[g.annotation],color:ue.invalid},{tag:[g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace,g.atom,g.bool,g.special(g.variableName)],color:q.red},{tag:[g.typeName,g.className,g.attributeName],color:q.lila},{tag:[g.operator,g.operatorKeyword,g.tagName,g.keyword],color:q.purple},{tag:[g.angleBracket,g.squareBracket,g.brace,g.separator,g.punctuation],color:q.midGrey},{tag:[g.regexp],color:q.deepBlue},{tag:[g.quote],color:q.darkGrey},{tag:[g.string,g.character,g.deleted],color:q.orangeBrown},{tag:g.link,color:q.mossGreen,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[g.url,g.escape,g.special(g.string)],color:q.red},{tag:[g.meta],color:q.iceBlue},{tag:[g.comment],color:q.midGrey,fontStyle:"italic"},{tag:g.strong,fontWeight:"bold",color:q.deepBlue},{tag:g.emphasis,fontStyle:"italic",color:q.deepBlue},{tag:g.strikethrough,textDecoration:"line-through"},{tag:g.heading,fontWeight:"bold",color:q.midGray},{tag:g.special(g.heading1),fontWeight:"bold",color:q.darkGrey},{tag:[g.heading1,g.heading2,g.heading3,g.heading4],fontWeight:"bold",color:q.midGrey},{tag:[g.heading5,g.heading6,g.processingInstruction,g.inserted],color:q.grey},{tag:[g.contentSeparator],color:q.yellow},{tag:g.invalid,color:q.midGrey,borderBottom:`1px dotted ${ue.invalid}`}]));var px=[fx,dx];const gx="#abb2bf",qr="#f07178",mx="#7d8799",bx="#ffffff",cn="#fffce1",Qr="#ec9e6f",yx="#21252b",Hr="rgba(0, 0, 0, 0.5)",vx="#292d3e",Vr="#353a42",xx="rgba(128, 203, 196, 0.2)",oh="#ffcc00",Ox="%23",lh="fff890",ah="red",kx="#281e16",wx="#281616",Sx=T.theme({"&":{color:"#ffffff",backgroundColor:vx},".cm-content":{caretColor:oh},"&.cm-focused .cm-cursor":{borderLeftColor:oh},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:xx},".cm-panels":{backgroundColor:yx,color:"#ffffff"},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:Hr},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847",outline:"1px solid #515a6b"},".cm-gutters":{background:"#292d3e",color:"#676e95",border:"none",padding:"0 5px"},".cm-activeLineGutter":{backgroundColor:Hr},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Vr},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Vr,borderBottomColor:Vr},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Hr,color:gx}},"& .cm-lintRange.cm-lintRange-warning::after":{backgroundImage:`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='6' height='3'><path d='m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0' stroke='${Ox+lh}' fill='none' stroke-width='1.2'/></svg>")`},"& .cm-lintRange.cm-lintRange-error::after":{backgroundImage:`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='6' height='3'><path d='m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0' stroke='${ah}' fill='none' stroke-width='1.2'/></svg>")`},"& .cm-diagnostic-warning":{borderLeft:`5px solid #${lh}`,background:kx},"& .cm-diagnostic-error":{borderLeft:`5px solid ${ah}`,background:wx},"& .cm-diagnostic":{borderRadius:"2px",padding:"3px 8px"}},{dark:!0}),Cx=cr(Ft.define([{tag:g.heading1,color:cn},{tag:g.heading2,color:cn},{tag:g.heading3,color:cn},{tag:g.heading4,color:cn},{tag:g.heading5,color:cn},{tag:g.heading6,color:cn},{tag:g.special(g.bracket),color:Qr,fontWeight:"bold"},{tag:g.keyword,color:"#c792ea"},{tag:g.operator,color:"#89ddff"},{tag:g.special(g.variableName),color:"#eeffff"},{tag:g.typeName,color:"#f07178"},{tag:g.atom,color:"#f78c6c"},{tag:g.number,color:"#ff5370"},{tag:g.bool,color:"#ff5370"},{tag:g.definition(g.variableName),color:"#82aaff"},{tag:g.string,color:"#c3e88d"},{tag:g.comment,color:mx},{tag:g.tagName,color:"#ff5370"},{tag:g.bracket,color:"#a2a1a4"},{tag:g.meta,color:"#ffcb6b"},{tag:g.special(g.string),color:qr},{tag:g.propertyName,color:Qr},{tag:g.variableName,color:Qr},{tag:g.attributeName,color:qr},{tag:g.className,color:qr},{tag:g.invalid,color:bx}]));var _x=[Sx,Cx];const Ax=[...Jd,...px],Px=[...Jd,..._x],Ex=1,Tx=2,Rx=3,js={"{":123,"}":125},Mx=(i,e=0)=>{const t=i.peek(e)===js["}"],n=i.peek(e+1)===js["}"];return t&&n||i.peek(e)===-1},$x=new Ln((i,e)=>{let t=0;for(;!Mx(i,t);)t++;t>0&&(i.advance(t),i.acceptToken(Tx))}),Dx=(i,e=0)=>{const t=i.peek(e)===js["{"],n=i.peek(e+1)===js["{"];return t&&n||i.peek(e)===-1},Bx=new Ln((i,e)=>{let t=0;for(;!Dx(i,t);)t++;t>0&&(i.advance(t),i.acceptToken(Rx))}),Lx=new Ln((i,e)=>{let t=0;for(;i.peek(t)!==-1;)t++;t>0&&(i.advance(t),i.acceptToken(Ex))}),Ix=Ri({ConditionalSpanner:g.special(g.bracket),ConditionalSpannerClose:g.special(g.bracket),ConditionalSpannerCloseNl:g.special(g.bracket),LoopSpanner:g.special(g.bracket),LoopSpannerClose:g.special(g.bracket),LoopSpannerCloseNl:g.special(g.bracket),EmptyInsert:g.special(g.bracket),Insert:g.special(g.bracket)}),Fx=bi.deserialize({version:14,states:"$bOQOaOOOfOXO'#CbOOO`'#Cm'#CmOqOWO'#CcOvOWO'#CfOOO`'#Cp'#CpOOO`'#Ci'#CiO{OaO'#ClO!jOSOOQOOOOOO!oOPO,58{O!tOXO,58|OOO`,58|,58|O!|OQO,58}O#ROQO,59QOOO`-E6g-E6gOOO`1G.g1G.gO#WOPO1G.gOOO`1G.h1G.hO#]OaO1G.iO#qOaO1G.lOOO`7+$R7+$RO$VOPO7+$TO$_OPO7+$WOOO`<<Go<<GoOOO`<<Gr<<Gr",stateData:"$g~ORUO_WObPOeROgSO^`P~OQYO_ZOc[O~OQ]O~OQ^O~ORUObPOeROgSO^`XW`XX`XZ`X[`X~OPXO~Oc`O~OQaOcbO~OfcO~OfdO~OceO~ORUObPOeROgSOW`PX`P~ORUObPOeROgSOZ`P[`P~OWhOXhO~OZiO[iO~O",goto:"!ZePPPPPfflPPlPPrPPz!TPP!TXQOVcdXTOVcdUVOcdR_VQXOQfcRgdXUOVcd",nodeNames:" Feel FeelBlock SimpleTextBlock Feelers Insert EmptyInsert ConditionalSpanner ConditionalSpannerClose ConditionalSpannerCloseNl LoopSpanner LoopSpannerClose LoopSpannerCloseNl",maxTerm:23,propSources:[Ix],skippedNodes:[0],repeatNodeCount:1,tokenData:"%X~RR!_!`[#o#pa#q#r$r~aO_~~dP#o#pg~lQb~str!P!Q!{~uQ#]#^{#`#a!^~!OP#Y#Z!R~!UPpq!X~!^Oe~~!aP#c#d!d~!gP#c#d!j~!mP#d#e!p~!sPpq!v~!{Og~~#OQ#]#^#U#`#a#u~#XP#Y#Z#[~#_P#q#r#b~#eP#q#r#h~#mPW~YZ#p~#uOX~~#xP#c#d#{~$OP#c#d$R~$UP#d#e$X~$[P#q#r$_~$bP#q#r$e~$jPZ~YZ$m~$rO[~R$uP#q#r$xR%PPcPfQYZ%SQ%XOfQ",tokenizers:[0,1,Lx,$x,Bx],topRules:{Feelers:[0,4]},tokenPrec:0}),Nx={ConditionalSpanner:ci,LoopSpanner:ci};function qx(i=null){const e=Fx.configure({wrap:yg(t=>t.name=="Feel"||t.name=="FeelBlock"?{parser:fu}:i&&t.name=="SimpleTextBlock"?{parser:i}:null),props:[Ff.add(Nx)]});return Ci.define({parser:e})}const Qx=i=>new $f(qx(i),[]);function Hx(i){const e=[];return i.iterate({enter:t=>{t.type.name==="EmptyInsert"&&e.push({from:t.from,to:t.to,severity:"warning",message:"this insert is empty and will be ignored",type:"emptyInsert"})}}),e}function Vx(i){return[...Hx(i)]}function zx(){const i=Zd();return e=>{const t=i(e);if(e.state.doc.length===0)return[];const n=de(e.state),s=Vx(n);return[...t,...s.map(r=>({...r,source:"feelers linter"}))]}}var Xx=Ad(zx());function dr({container:i,tooltipContainer:e,hostLanguage:t,hostLanguageParser:n,onChange:s=()=>{},onKeyDown:r=()=>{},onLint:o=()=>{},contentAttributes:l={},readOnly:a=!1,value:c="",enableGutters:h=!1,singleLine:u=!1,lineWrap:f=!1,darkMode:d=!1}){const p=T.updateListener.of(_=>{_.docChanged&&s(_.state.doc.toString())}),m=T.updateListener.of(_=>{const E=_.transactions.flatMap(I=>I.effects).filter(I=>I.is(Fi));if(!E.length)return;const F=E.flatMap(I=>I.value);o(F)}),b=T.contentAttributes.of(l),y=T.domEventHandlers({keydown:r});typeof e=="string"&&(e=document.querySelector(e));const v=e?Pf({tooltipSpace:function(){return e.getBoundingClientRect()}}):[],w=Qx(n||t&&(_=>{switch(_){case"markdown":return ix;default:return null}})(t)),k=[Hf(),p,b,Gf(),If(),y,Bi.of([...wd]),w,Xx,m,v,d?Px:Ax,...h?[Rf()]:[],...u?[W.transactionFilter.of(_=>_.newDoc.lines>1?[]:_)]:[],...f?[T.lineWrapping]:[]];return a&&k.push(T.editable.of(!1)),u&&c&&(c=c.toString().split(`
`)[0]),this._cmEditor=new T({state:W.create({doc:c,extensions:k}),parent:i}),this}dr.prototype.setValue=function(i){this._cmEditor.dispatch({changes:{from:0,to:this._cmEditor.state.doc.length,insert:i}})};dr.prototype.focus=function(i){const e=this._cmEditor;if(e.contentDOM.focus(),e.focus(),typeof i=="number"){const t=e.state.doc.length;e.dispatch({selection:{anchor:i<=t?i:t}})}};dr.prototype.getSelection=function(){return this._cmEditor.state.selection};const ep=[Vt("function(${params}) ${body}",{label:"function",detail:"definition",type:"keyword"}),Vt("for ${var} in ${collection} return ${value}",{label:"for",detail:"expression",type:"keyword"}),Vt("every ${var} in ${collection} satisfies ${condition}",{label:"every",detail:"quantified expression",type:"keyword"}),Vt("some ${var} in ${collection} satisfies ${condition}",{label:"some",detail:"quantified expression",type:"keyword"}),Vt("if ${condition} then ${value} else ${other value}",{label:"if",detail:"block",type:"keyword"}),Vt("{ ${key}: ${value} }",{label:"context",detail:"block",type:"keyword"})];function zo(){return zo=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},zo.apply(this,arguments)}function Gn(i){const{context:e,after:t,before:n,keyword:s}=i;return Ux({nodes:e,before:n,after:t,keyword:s},vl([{label:s,type:"keyword",boost:10}]))}const tp=[Gn({context:"InExpression",keyword:"in"}),Gn({context:"IfExpression",keyword:"then",after:"if",before:"else"}),Gn({context:"IfExpression",keyword:"else",after:"then"}),Gn({context:"QuantifiedExpression",keyword:"satisfies"}),Gn({context:"ForExpression",after:"InExpressions",keyword:"return"})],Wx=["StringLiteral","Identifier","LineComment","BlockComment","PathExpression"];function np(i){return q1(Wx,vl(i.map(e=>zo({},e,{type:"text"}))))}function ch(i,e,t){return ip(i,e,t,-1)}function jx(i,e,t){return ip(i,e,t,1)}function ip(i,e,t,n){let s=i[n>0?"childAfter":"childBefore"](e);for(;s;){if(t.includes(s.name))return s;if(s.type.isError&&s.firstChild&&t.includes(s.firstChild.name))return s.firstChild;s=s[n>0?"nextSibling":"prevSibling"]}return null}function Yx(i,e){for(Array.isArray(e)||(e=[e]);i;i=i.parent){if(e.includes(i.name))return i;if(i.type.isTop)break}return null}function Ux(i,e){const{nodes:t,before:n,after:s,keyword:r}=i;return o=>{const{state:l,pos:a}=o,c=Yx(de(l).resolveInner(a,-1),t);return!c||ch(c,a,[r,n])||jx(c,a,[r,s])||s&&!ch(c,a,[s])?null:e(o)}}const sp=Ci.define({parser:fu.configure({props:[Df.add({Context:Tc({closing:"}"}),"List FilterExpression":Tc({closing:"]"}),"ParenthesizedExpression FunctionInvocation":$r({except:/^\s*\)/}),"ForExpression QuantifiedExpression IfExpression":$r({except:/^\s*(then|else|return|satisfies)\b/}),FunctionDefinition:$r({except:/^\s*(\(|\))/})}),Ff.add({Context:ci,List:ci,ParenthesizedExpression:ci,FunctionDefinition(i){const e=i.getChild(")");return e?{from:e.to,to:i.to}:null}})]}),languageData:{indentOnInput:/^\s*(\)|\}|\]|then|else|return|satisfies)$/,commentTokens:{line:"//",block:{open:"/*",close:"*/"}}}}),Gx=sp.configure({top:"UnaryTests"},"FEEL unary tests"),Kx=sp.configure({top:"Expression"},"FEEL expression");function Zx(i={}){const e=i.dialect==="unaryTests"?Gx:Kx,t=i.parserDialect,n=uu(i.context),s=e.configure({contextTracker:n,dialect:t}),r=i.completions||[np(ep),tp].flat();return new $f(s,[...r.map(o=>s.data.of({autocomplete:o}))])}var Jx=[Ad(Zd())];const eO=T.theme({"& .cm-content":{padding:"0px"},"& .cm-line":{padding:"0px"},"&.cm-editor.cm-focused":{outline:"none"},"& .cm-completionInfo":{whiteSpace:"pre-wrap",overflow:"hidden",textOverflow:"ellipsis"},"&.cm-editor":{height:"100%"},"& .cm-completionInfo > *":{whiteSpace:"normal"},"& .cm-completionInfo ul":{margin:0,paddingLeft:"15px"},"& .cm-completionInfo pre":{marginBottom:0,whiteSpace:"pre-wrap"},"& .cm-completionInfo p":{marginTop:0},"& .cm-completionInfo p:not(:last-of-type)":{marginBottom:0}}),tO=T.baseTheme({"& .variableName":{color:"#10f"},"& .number":{color:"#164"},"& .string":{color:"#a11"},"& .bool":{color:"#219"},"& .function":{color:"#aa3731",fontWeight:"bold"},"& .control":{color:"#708"}}),nO=cr(Ft.define([{tag:g.variableName,class:"variableName"},{tag:g.name,class:"variableName"},{tag:g.number,class:"number"},{tag:g.string,class:"string"},{tag:g.bool,class:"bool"},{tag:g.function(g.variableName),class:"function"},{tag:g.function(g.special(g.variableName)),class:"function"},{tag:g.controlKeyword,class:"control"},{tag:g.operatorKeyword,class:"control"}]));var iO=[eO,tO,nO];function hh(i){return i&&i.from===i.to}function sO(i,e){const t=i.nextSibling;return hh(i)||t&&t.from===e&&hh(t)}function rO(i){return i&&i.parent&&i.parent.name==="VariableName"}function Bl(i){return i?i.name==="PathExpression"?!0:Bl(i.parent):!1}function oO({variables:i}){return e=>{const t=de(e.state).resolve(e.pos,-1);if(!Bl(t))return;const n=lO(t),s=t===n?e.pos:t.from,r=Ll(n,e);let o=i;for(var l=0;l<r.length-1;l++){var a=o.find(h=>h.name===r[l].name);if(!a)return null;if(a.isList!=="optional"&&!!a.isList!==r[l].isList)return;o=a.entries}return o?(o=o.map(h=>({label:h.name,type:"variable",info:h.info,detail:h.detail})),{from:s,options:o}):void 0}}function lO(i){for(;i;){if(i.name==="PathExpression")return i;i=i.parent}}function Ll(i,e){let t=[];for(let n=i.firstChild;n;n=n.nextSibling)n.name==="PathExpression"?t.push(...Ll(n,e)):n.name==="FilterExpression"?t.push(...aO(n,e)):t.push({name:rp(n,e),isList:!1});return t}function aO(i,e){const t=i.firstChild;if(t.name==="PathExpression"){const n=Ll(t,e),s=n[n.length-1];return s.isList=!0,n}return[{name:rp(t,e),isList:!0}]}function rp(i,e){return e.state.sliceDoc(i.from,i.to)}function cO({variables:i=[],builtins:e=[]}){const t=hO(i,e);return t.length?n=>{const{pos:s,state:r}=n,o=de(r).resolve(s,-1);return sO(o,s)?n.explicit?{from:s,options:t}:null:!rO(o)||Bl(o)?null:{from:o.from,options:t}}:n=>null}function hO(i,e){return[].concat(i.map(t=>uh(t)),e.map(t=>uh(t)))}function uh(i,e){return i.type==="function"?uO(i,e):{label:i.name,type:"variable",info:i.info,detail:i.detail,boost:e}}function uO(i,e){const{name:t,info:n,detail:s,params:r=[]}=i,o=r.map(({name:h,type:u},f)=>({name:h||`param ${f+1}`,type:u})),l=`${t}(${o.map(h=>"${"+h.name+"}").join(", ")})`,a=o.map(({name:h,type:u})=>u?`${h}: ${u}`:h).join(", "),c=`${t}(${a})`;return Vt(l,{label:c,type:"function",info:n,detail:s,boost:e})}function fO({variables:i=[],builtins:e=[]}){return[oO({variables:i}),cO({variables:i,builtins:e}),np(ep.map(t=>({...t,boost:-1}))),...tp]}function dO(i){return Zx(i)}function pO(i,e){return i.slice().reverse().reduce((t,n)=>(t[n.name]=()=>{},t),{})}const op=D.define(),lp=D.define(),ap=D.define();function cp({dialect:i="expression",variables:e=[],builtins:t=[],completions:n=fO({builtins:t,variables:e})}){const s=pO([...e,...t]);return[ap.of(i),op.of(t),lp.of(e),dO({dialect:i,context:s,completions:n})]}function gO(i){const e=i.facet(op)[0],t=i.facet(lp)[0],n=i.facet(ap)[0];return{builtins:e,variables:t,dialect:n}}var mO=[{name:"not(negand)",description:`<p>Returns the logical negation of the given value.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">not(negand: boolean): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">not(true)
// false

not(null)
// null
</code></pre>
`},{name:"is defined(value)",description:`<p><em>Camunda Extension</em></p>
<p>Checks if a given value is not <code>null</code>. If the value is <code>null</code> then the function returns <code>false</code>.
Otherwise, the function returns <code>true</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">is defined(value: Any): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">is defined(1)
// true

is defined(null)
// false

is defined(x)
// false - if no variable &quot;x&quot; exists

is defined(x.y)
// false - if no variable &quot;x&quot; exists or it doesn&#39;t have a property &quot;y&quot;
</code></pre>
<p>:::caution Breaking change</p>
<p>This function worked differently in previous versions. It returned <code>true</code> if the value was <code>null</code>.
Since this version, the function returns <code>false</code> if the value is <code>null</code>.</p>
<p>:::</p>
`},{name:"get or else(value, default)",description:`<p><em>Camunda Extension</em></p>
<p>Return the provided value parameter if not <code>null</code>, otherwise return the default parameter</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">get or else(value: Any, default: Any): Any
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">get or else(&quot;this&quot;, &quot;default&quot;)
// &quot;this&quot;

get or else(null, &quot;default&quot;)
// &quot;default&quot;

get or else(null, null)
// null
</code></pre>
`},{name:"assert(value, condition)",description:`<p><em>Camunda Extension</em></p>
<p>Verify that the given condition is met. If the condition is <code>true</code>, the function returns the value.
Otherwise, the evaluation fails with an error.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">assert(value: Any, condition: Any)
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">assert(x, x != null)
// &quot;value&quot; - if x is &quot;value&quot;
// error - if x is null or doesn&#39;t exist

assert(x, x &gt;= 0)
// 4 - if x is 4
// error - if x is less than zero
</code></pre>
`},{name:"assert(value, condition, cause)",description:`<p><em>Camunda Extension</em></p>
<p>Verify that the given condition is met. If the condition is <code>true</code>, the function returns the value.
Otherwise, the evaluation fails with an error containing the given message.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">assert(value: Any, condition: Any, cause: String)
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">assert(x, x != null, &quot;&#39;x&#39; should not be null&quot;)
// &quot;value&quot; - if x is &quot;value&quot;
// error(&#39;x&#39; should not be null) - if x is null or doesn&#39;t exist

assert(x, x &gt;= 0, &quot;&#39;x&#39; should be positive&quot;)
// 4 - if x is 4
// error(&#39;x&#39; should be positive) - if x is less than zero
</code></pre>
`},{name:"get value(context, key)",description:`<p>Returns the value of the context entry with the given key.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">get value(context: context, key: string): Any
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">get value({foo: 123}, &quot;foo&quot;)
// 123

get value({a: 1}, &quot;b&quot;)
// null
</code></pre>
`},{name:"get value(context, keys)",description:`<p><em>Camunda Extension</em></p>
<p>Returns the value of the context entry for a context path defined by the given keys.</p>
<p>If <code>keys</code> contains the keys <code>[k1, k2]</code> then it returns the value at the nested entry <code>k1.k2</code> of the context.</p>
<p>If <code>keys</code> are empty or the nested entry defined by the keys doesn&#39;t exist in the context, it returns <code>null</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">get value(context: context, keys: list&lt;string&gt;): Any
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">get value({x:1, y: {z:0}}, [&quot;y&quot;, &quot;z&quot;])
// 0

get value({x: {y: {z:0}}}, [&quot;x&quot;, &quot;y&quot;])
// {z:0}

get value({a: {b: 3}}, [&quot;b&quot;])
// null
</code></pre>
`},{name:"get entries(context)",description:`<p>Returns the entries of the context as a list of key-value-pairs.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">get entries(context: context): list&lt;context&gt;
</code></pre>
<p>The return value is a list of contexts. Each context contains two entries for &quot;key&quot; and &quot;value&quot;.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">get entries({foo: 123})
// [{key: &quot;foo&quot;, value: 123}]
</code></pre>
`},{name:"context put(context, key, value)",description:`<p>Adds a new entry with the given key and value to the context. Returns a new context that includes the entry.</p>
<p>If an entry for the same key already exists in the context, it overrides the value.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">context put(context: context, key: string, value: Any): context
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">context put({x:1}, &quot;y&quot;, 2)
// {x:1, y:2}
</code></pre>
<p>:::info
The function <code>context put()</code> replaced the previous function <code>put()</code> (Camunda Extension). The
previous function is deprecated and should not be used anymore.
:::</p>
`},{name:"context put(context, keys, value)",description:`<p>Adds a new entry with the given value to the context. The path of the entry is defined by the keys. Returns a new context that includes the entry.</p>
<p>If <code>keys</code> contains the keys <code>[k1, k2]</code> then it adds the nested entry <code>k1.k2 = value</code> to the context.</p>
<p>If an entry for the same keys already exists in the context, it overrides the value.</p>
<p>If <code>keys</code> are empty, it returns <code>null</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">context put(context: context, keys: list&lt;string&gt;, value: Any): context
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">context put({x:1}, [&quot;y&quot;], 2)
// {x:1, y:2}

context put({x:1, y: {z:0}}, [&quot;y&quot;, &quot;z&quot;], 2)
// {x:1, y: {z:2}}

context put({x:1}, [&quot;y&quot;, &quot;z&quot;], 2)
// {x:1, y: {z:2}}
</code></pre>
`},{name:"context merge(contexts)",description:`<p>Union the given contexts. Returns a new context that includes all entries of the given contexts.</p>
<p>If an entry for the same key already exists in a context, it overrides the value. The entries are overridden in the same order as in the list of contexts.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">context merge(contexts: list&lt;context&gt;): context
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">context merge([{x:1}, {y:2}])
// {x:1, y:2}

context merge([{x:1, y: 0}, {y:2}])
// {x:1, y:2}
</code></pre>
<p>:::info
The function <code>context merge()</code> replaced the previous function <code>put all()</code> (Camunda Extension). The
previous function is deprecated and should not be used anymore.
:::</p>
`},{name:"string(from)",description:`<p>Returns the given value as a string representation.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">string(from: Any): string
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">string(1.1)
// &quot;1.1&quot;

string(date(&quot;2012-12-25&quot;))
// &quot;2012-12-25&quot;
</code></pre>
`},{name:"number(from)",description:`<p>Parses the given string to a number.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">number(from: string): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">number(&quot;1500.5&quot;)
// 1500.5
</code></pre>
`},{name:"context(entries)",description:`<p>Constructs a context of the given list of key-value pairs. It is the reverse function to <a href="feel-built-in-functions-context.md#get-entriescontext">get entries()</a>.</p>
<p>Each key-value pair must be a context with two entries: <code>key</code> and <code>value</code>. The entry with name <code>key</code> must have a value of the type <code>string</code>.</p>
<p>It might override context entries if the keys are equal. The entries are overridden in the same order as the contexts in the given list.</p>
<p>Returns <code>null</code> if one of the entries is not a context or if a context doesn&#39;t contain the required entries.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">context(entries: list&lt;context&gt;): context
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">context([{&quot;key&quot;:&quot;a&quot;, &quot;value&quot;:1}, {&quot;key&quot;:&quot;b&quot;, &quot;value&quot;:2}])
// {a:1, b:2}
</code></pre>
`},{name:"date(from)",description:`<p>Returns a date from the given value.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">date(from: string): date
</code></pre>
<p>Parses the given string into a date.</p>
<pre><code class="language-feel">date(from: date and time): date
</code></pre>
<p>Extracts the date component from the given date and time.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">date(&quot;2018-04-29&quot;)
// date(&quot;2018-04-29&quot;)

date(date and time(&quot;2012-12-25T11:00:00&quot;))
// date(&quot;2012-12-25&quot;)
</code></pre>
`},{name:"date(year, month, day)",description:`<p>Returns a date from the given components.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">date(year: number, month: number, day: number): date
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">date(2012, 12, 25)
// date(&quot;2012-12-25&quot;)
</code></pre>
`},{name:"time(from)",description:`<p>Returns a time from the given value.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">time(from: string): time
</code></pre>
<p>Parses the given string into a time.</p>
<pre><code class="language-feel">time(from: date and time): time
</code></pre>
<p>Extracts the time component from the given date and time.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">time(&quot;12:00:00&quot;)
// time(&quot;12:00:00&quot;)

time(date and time(&quot;2012-12-25T11:00:00&quot;))
// time(&quot;11:00:00&quot;)
</code></pre>
`},{name:"time(hour, minute, second)",description:`<p>Returns a time from the given components.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">time(hour: number, minute: number, second: number): time
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">time(23, 59, 0)
// time(&quot;23:59:00&quot;)
</code></pre>
`},{name:"time(hour, minute, second, offset)",description:`<p>Returns a time from the given components, including a timezone offset.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">time(hour: number, minute: number, second: number, offset: days and time duration): time
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">time(14, 30, 0, duration(&quot;PT1H&quot;))
// time(&quot;14:30:00+01:00&quot;)
</code></pre>
`},{name:"date and time(from)",description:`<p>Parses the given string into a date and time.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">date and time(from: string): date and time
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">date and time(&quot;2018-04-29T09:30:00&quot;)
// date and time(&quot;2018-04-29T09:30:00&quot;)
</code></pre>
`},{name:"date and time(date, time)",description:`<p>Returns a date and time from the given components.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">date and time(date: date, time: time): date and time
</code></pre>
<pre><code class="language-feel">date and time(date: date and time, time: time): date and time
</code></pre>
<p>Returns a date and time value that consists of the date component of <code>date</code> combined with <code>time</code>.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">date and time(date(&quot;2012-12-24&quot;),time(&quot;T23:59:00&quot;))
// date and time(&quot;2012-12-24T23:59:00&quot;)

date and time(date and time(&quot;2012-12-25T11:00:00&quot;),time(&quot;T23:59:00&quot;))
// date and time(&quot;2012-12-25T23:59:00&quot;)
</code></pre>
`},{name:"date and time(date, timezone)",description:`<p><em>Camunda Extension</em></p>
<p>Returns the given date and time value at the given timezone.</p>
<p>If <code>date</code> has a different timezone than <code>timezone</code> then it adjusts the time to match the local time of <code>timezone</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">date and time(date: date and time, timezone: string): date and time
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">date and time(@&quot;2020-07-31T14:27:30@Europe/Berlin&quot;, &quot;America/Los_Angeles&quot;)
// date and time(&quot;2020-07-31T05:27:30@America/Los_Angeles&quot;)

date and time(@&quot;2020-07-31T14:27:30&quot;, &quot;Z&quot;)
// date and time(&quot;2020-07-31T12:27:30Z&quot;)
</code></pre>
`},{name:"duration(from)",description:`<p>Parses the given string into a duration. The duration is either a days and time duration or a years and months duration.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">duration(from: string): days and time duration
</code></pre>
<pre><code class="language-feel">duration(from: string): years and months duration
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">duration(&quot;P5D&quot;)
// duration(&quot;P5D&quot;)

duration(&quot;P32Y&quot;)
// duration(&quot;P32Y&quot;)
</code></pre>
`},{name:"years and months duration(from, to)",description:`<p>Returns the years and months duration between <code>from</code> and <code>to</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">years and months duration(from: date, to: date): years and months duration
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">years and months duration(date(&quot;2011-12-22&quot;), date(&quot;2013-08-24&quot;))
// duration(&quot;P1Y8M&quot;)
</code></pre>
`},{name:"list contains(list, element)",description:`<p>Returns <code>true</code> if the given list contains the element. Otherwise, returns <code>false</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">list contains(list: list, element: Any): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">list contains([1,2,3], 2)
// true
</code></pre>
`},{name:"count(list)",description:`<p>Returns the number of elements of the given list.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">count(list: list): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">count([1,2,3])
// 3
</code></pre>
`},{name:"min(list)",description:`<p>Returns the minimum of the given list.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">min(list: list): Any
</code></pre>
<p>All elements in <code>list</code> should have the same type and be comparable.</p>
<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">min([1,2,3])
// 1

min(1,2,3)
// 1
</code></pre>
`},{name:"max(list)",description:`<p>Returns the maximum of the given list.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">max(list: list): Any
</code></pre>
<p>All elements in <code>list</code> should have the same type and be comparable.</p>
<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">max([1,2,3])
// 3

max(1,2,3)
// 3
</code></pre>
`},{name:"sum(list)",description:`<p>Returns the sum of the given list of numbers.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">sum(list: list&lt;number&gt;): number
</code></pre>
<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">sum([1,2,3])
// 6

sum(1,2,3)
// 6
</code></pre>
`},{name:"product(list)",description:`<p>Returns the product of the given list of numbers.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">product(list: list&lt;number&gt;): number
</code></pre>
<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">product([2, 3, 4])
// 24

product(2, 3, 4)
// 24
</code></pre>
`},{name:"mean(list)",description:`<p>Returns the arithmetic mean (i.e. average) of the given list of numbers.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">mean(list: list&lt;number&gt;): number
</code></pre>
<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">mean([1,2,3])
// 2

mean(1,2,3)
// 2
</code></pre>
`},{name:"median(list)",description:`<p>Returns the median element of the given list of numbers.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">median(list: list&lt;number&gt;): number
</code></pre>
<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">median(8, 2, 5, 3, 4)
// 4

median([6, 1, 2, 3])
// 2.5
</code></pre>
`},{name:"stddev(list)",description:`<p>Returns the standard deviation of the given list of numbers.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">stddev(list: list&lt;number&gt;): number
</code></pre>
<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">stddev(2, 4, 7, 5)
// 2.0816659994661326

stddev([2, 4, 7, 5])
// 2.0816659994661326
</code></pre>
`},{name:"mode(list)",description:`<p>Returns the mode of the given list of numbers.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">mode(list: list&lt;number&gt;): number
</code></pre>
<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">mode(6, 3, 9, 6, 6)
// [6]

mode([6, 1, 9, 6, 1])
// [1, 6]
</code></pre>
`},{name:"all(list)",description:`<p>Returns <code>false</code> if any element of the given list is <code>false</code>. Otherwise, returns <code>true</code>.</p>
<p>If the given list is empty, it returns <code>true</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">all(list: list&lt;boolean&gt;): boolean
</code></pre>
<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">all([true,false])
// false

all(false,null,true)
// false
</code></pre>
<p>:::info
The function <code>all()</code> replaced the previous function <code>and()</code>. The previous function is deprecated and
should not be used anymore.
:::</p>
`},{name:"any(list)",description:`<p>Returns <code>true</code> if any element of the given list is <code>true</code>. Otherwise, returns <code>false</code>.</p>
<p>If the given list is empty, it returns <code>false</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">any(list: list&lt;boolean&gt;): boolean
</code></pre>
<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">any([false,true])
// true

any(false,null,true)
// true
</code></pre>
<p>:::info
The function <code>any()</code> replaced the previous function <code>or()</code>. The previous function is deprecated and
should not be used anymore.
:::</p>
`},{name:"sublist(list, start position)",description:`<p>Returns a partial list of the given value starting at <code>start position</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">sublist(list: list, start position: number): list
</code></pre>
<p>The <code>start position</code> starts at the index <code>1</code>. The last position is <code>-1</code>.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">sublist([1,2,3], 2)
// [2,3]
</code></pre>
`},{name:"sublist(list, start position, length)",description:`<p>Returns a partial list of the given value starting at <code>start position</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">sublist(list: list, start position: number, length: number): list
</code></pre>
<p>The <code>start position</code> starts at the index <code>1</code>. The last position is <code>-1</code>.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">sublist([1,2,3], 1, 2)
// [1,2]
</code></pre>
`},{name:"append(list, items)",description:`<p>Returns the given list with all <code>items</code> appended.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">append(list: list, items: Any): list
</code></pre>
<p>The parameter <code>items</code> can be a single element or a sequence of elements.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">append([1], 2, 3)
// [1,2,3]
</code></pre>
`},{name:"concatenate(lists)",description:`<p>Returns a list that includes all elements of the given lists.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">concatenate(lists: list): list
</code></pre>
<p>The parameter <code>lists</code> is a sequence of lists.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">concatenate([1,2],[3])
// [1,2,3]

concatenate([1],[2],[3])
// [1,2,3]
</code></pre>
`},{name:"insert before(list, position, newItem)",description:`<p>Returns the given list with <code>newItem</code> inserted at <code>position</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">insert before(list: list, position: number, newItem: Any): list
</code></pre>
<p>The <code>position</code> starts at the index <code>1</code>. The last position is <code>-1</code>.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">insert before([1,3],1,2)
// [2,1,3]
</code></pre>
`},{name:"remove(list, position)",description:`<p>Returns the given list without the element at <code>position</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">remove(list: list, position: number): list
</code></pre>
<p>The <code>position</code> starts at the index <code>1</code>. The last position is <code>-1</code>.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">remove([1,2,3], 2)
// [1,3]
</code></pre>
`},{name:"reverse(list)",description:`<p>Returns the given list in revered order.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">reverse(list: list): list
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">reverse([1,2,3])
// [3,2,1]
</code></pre>
`},{name:"index of(list, match)",description:`<p>Returns an ascending list of positions containing <code>match</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">index of(list: list, match: Any): list&lt;number&gt;
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">index of([1,2,3,2],2)
// [2,4]
</code></pre>
`},{name:"union(list)",description:`<p>Returns a list that includes all elements of the given lists without duplicates.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">union(list: list): list
</code></pre>
<p>The parameter <code>list</code> is a sequence of lists.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">union([1,2],[2,3])
// [1,2,3]
</code></pre>
`},{name:"distinct values(list)",description:`<p>Returns the given list without duplicates.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">distinct values(list: list): list
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">distinct values([1,2,3,2,1])
// [1,2,3]
</code></pre>
`},{name:"duplicate values(list)",description:`<p><em>Camunda Extension</em></p>
<p>Returns all duplicate values of the given list.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">duplicate values(list: list): list
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">duplicate values([1,2,3,2,1])
// [1,2]
</code></pre>
`},{name:"flatten(list)",description:`<p>Returns a list that includes all elements of the given list without nested lists.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">flatten(list: list): list
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">flatten([[1,2],[[3]], 4])
// [1,2,3,4]
</code></pre>
`},{name:"sort(list, precedes)",description:`<p>Returns the given list sorted by the <code>precedes</code> function.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">sort(list: list, precedes: function&lt;(Any, Any) -&gt; boolean&gt;): list
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">sort(list: [3,1,4,5,2], precedes: function(x,y) x &lt; y)
// [1,2,3,4,5]
</code></pre>
`},{name:"string join(list)",description:`<p>Joins a list of strings into a single string. This is similar to
Java&#39;s <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/stream/Collectors.html#joining(java.lang.CharSequence,java.lang.CharSequence,java.lang.CharSequence)">joining</a>
function.</p>
<p>If an item of the list is <code>null</code>, the item is ignored for the result string. If an item is
neither a string nor <code>null</code>, the function returns <code>null</code> instead of a string.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">string join(list: list&lt;string&gt;): string
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">string join([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;])
// &quot;abc&quot;

string join([&quot;a&quot;,null,&quot;c&quot;])
// &quot;ac&quot;

string join([])
// &quot;&quot;
</code></pre>
`},{name:"string join(list, delimiter)",description:`<p>Joins a list of strings into a single string. This is similar to
Java&#39;s <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/stream/Collectors.html#joining(java.lang.CharSequence,java.lang.CharSequence,java.lang.CharSequence)">joining</a>
function.</p>
<p>If an item of the list is <code>null</code>, the item is ignored for the result string. If an item is
neither a string nor <code>null</code>, the function returns <code>null</code> instead of a string.</p>
<p>The resulting string contains a <code>delimiter</code> between each element.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">string join(list: list&lt;string&gt;, delimiter: string): string
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">string join([&quot;a&quot;], &quot;X&quot;)
// &quot;a&quot;

string join([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;], &quot;, &quot;)
// &quot;a, b, c&quot;
</code></pre>
`},{name:"string join(list, delimiter, prefix, suffix)",description:`<p><em>Camunda Extension</em></p>
<p>Joins a list of strings into a single string. This is similar to
Java&#39;s <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/stream/Collectors.html#joining(java.lang.CharSequence,java.lang.CharSequence,java.lang.CharSequence)">joining</a>
function.</p>
<p>If an item of the list is <code>null</code>, the item is ignored for the result string. If an item is
neither a string nor <code>null</code>, the function returns <code>null</code> instead of a string.</p>
<p>The resulting string starts with <code>prefix</code>, contains a <code>delimiter</code> between each element, and ends
with <code>suffix</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">string join(list: list&lt;string&gt;, delimiter: string, prefix: string, suffix: string): string
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">string join([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;], &quot;, &quot;, &quot;[&quot;, &quot;]&quot;)
// &quot;[a, b, c]&quot;
</code></pre>
`},{name:"decimal(n, scale)",description:`<p>Rounds the given value at the given scale.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">decimal(n: number, scale: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">decimal(1/3, 2)
// .33

decimal(1.5, 0)
// 2
</code></pre>
`},{name:"floor(n)",description:`<p>Rounds the given value with rounding mode flooring.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">floor(n: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">floor(1.5)
// 1

floor(-1.5)
// -2
</code></pre>
`},{name:"floor(n, scale)",description:`<p>Rounds the given value with rounding mode flooring at the given scale.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">floor(n: number, scale: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">floor(-1.56, 1)
// -1.6
</code></pre>
`},{name:"ceiling(n)",description:`<p>Rounds the given value with rounding mode ceiling.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">ceiling(n: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">ceiling(1.5)
// 2

ceiling(-1.5)
// -1
</code></pre>
`},{name:"ceiling(n, scale)",description:`<p>Rounds the given value with rounding mode ceiling at the given scale.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">ceiling(n: number, scale: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">ceiling(-1.56, 1)
// -1.5
</code></pre>
`},{name:"round up(n, scale)",description:`<p>Rounds the given value with the rounding mode round-up at the given scale.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">round up(n: number, scale: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">round up(5.5)
// 6

round up(-5.5)
// -6

round up(1.121, 2)
// 1.13

round up(-1.126, 2)
// -1.13
</code></pre>
`},{name:"round down(n, scale)",description:`<p>Rounds the given value with the rounding mode round-down at the given scale.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">round down(n: number, scale: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">round down(5.5, 0)
// 5

round down (-5.5, 0)
// -5

round down (1.121, 2)
// 1.12

round down (-1.126, 2)
// -1.12
</code></pre>
`},{name:"round half up(n, scale)",description:`<p>Rounds the given value with the rounding mode round-half-up at the given scale.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">round half up(n: number, scale: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">round half up(5.5, 0)
// 6

round half up(-5.5, 0)
// -6

round half up(1.121, 2)
// 1.12

round half up(-1.126, 2)
// -1.13
</code></pre>
`},{name:"round half down(n, scale)",description:`<p>Rounds the given value with the rounding mode round-half-down at the given scale.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">round half down(n: number, scale: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">round half down (5.5, 0)
// 5

round half down (-5.5, 0)
// -5

round half down (1.121, 2)
// 1.12

round half down (-1.126, 2)
// -1.13
</code></pre>
`},{name:"abs(number)",description:`<p>Returns the absolute value of the given numeric value.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">abs(number: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">abs(10)
// 10

abs(-10)
// 10
</code></pre>
`},{name:"modulo(dividend, divisor)",description:`<p>Returns the remainder of the division of dividend by divisor.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">modulo(dividend: number, divisor: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">modulo(12, 5)
// 2
</code></pre>
`},{name:"sqrt(number)",description:`<p>Returns the square root of the given value.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">sqrt(number: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">sqrt(16)
// 4
</code></pre>
`},{name:"log(number)",description:`<p>Returns the natural logarithm (base e) of the given value.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">log(number: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">log(10)
// 2.302585092994046
</code></pre>
`},{name:"exp(number)",description:`<p>Returns the Eulers number e raised to the power of the given number .</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">exp(number: number): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">exp(5)
// 148.4131591025766
</code></pre>
`},{name:"odd(number)",description:`<p>Returns <code>true</code> if the given value is odd. Otherwise, returns <code>false</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">odd(number: number): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">odd(5)
// true

odd(2)
// false
</code></pre>
`},{name:"even(number)",description:`<p>Returns <code>true</code> if the given is even. Otherwise, returns <code>false</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">even(number: number): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">even(5)
// false

even(2)
// true
</code></pre>
`},{name:"random number()",description:`<p><em>Camunda Extension</em></p>
<p>Returns a random number between <code>0</code> and <code>1</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">random number(): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">random number()
// 0.9701618132579795
</code></pre>
`},{name:"before(point1, point2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">before(point1: Any, point2: Any): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">before(1, 10)
// true

before(10, 1)
// false
</code></pre>
`},{name:"before(range, point)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">before(range: range, point: Any): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">before([1..5], 10)
// true
</code></pre>
`},{name:"before(point, range)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">before(point: Any, range: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">before(1, [2..5])
// true
</code></pre>
`},{name:"before(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">before(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">before([1..5], [6..10])
// true

before([1..5),[5..10])
// true
</code></pre>
`},{name:"after(point1, point2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">after(point1: Any, point2: Any): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">after(10, 1)
// true

after(1, 10)
// false
</code></pre>
`},{name:"after(range, point)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">after(range: range, point: Any): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">after([1..5], 10)
// false
</code></pre>
`},{name:"after(point, range)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">after(point: Any, range: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">after(12, [2..5])
// true
</code></pre>
`},{name:"after(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">after(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">after([6..10], [1..5])
// true

after([5..10], [1..5))
// true
</code></pre>
`},{name:"meets(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">meets(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">meets([1..5], [5..10])
// true

meets([1..3], [4..6])
// false

meets([1..3], [3..5])
// true

meets([1..5], (5..8])
// false
</code></pre>
`},{name:"met by(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">met by(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">met by([5..10], [1..5])
// true

met by([3..4], [1..2])
// false

met by([3..5], [1..3])
// true

met by((5..8], [1..5))
// false

met by([5..10], [1..5))
// false
</code></pre>
`},{name:"overlaps(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">overlaps(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">overlaps([5..10], [1..6])
// true

overlaps((3..7], [1..4])
// true

overlaps([1..3], (3..6])
// false

overlaps((5..8], [1..5))
// false

overlaps([4..10], [1..5))
// true
</code></pre>
`},{name:"overlaps before(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">overlaps before(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">overlaps before([1..5], [4..10])
// true

overlaps before([3..4], [1..2])
// false

overlaps before([1..3], (3..5])
// false

overlaps before([1..5), (3..8])
// true

overlaps before([1..5), [5..10])
// false
</code></pre>
`},{name:"overlaps after(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">overlaps after(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">overlaps after([4..10], [1..5])
// true

overlaps after([3..4], [1..2])
// false

overlaps after([3..5], [1..3))
// false

overlaps after((5..8], [1..5))
// false

overlaps after([4..10], [1..5))
// true
</code></pre>
`},{name:"finishes(point, range)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">finishes(point: Any, range: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">finishes(5, [1..5])
// true

finishes(10, [1..7])
// false
</code></pre>
`},{name:"finishes(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">finishes(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">finishes([3..5], [1..5])
// true

finishes((1..5], [1..5))
// false

finishes([5..10], [1..10))
// false
</code></pre>
`},{name:"finished by(range, point)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">finished by(range: range, point: Any): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">finished by([5..10], 10)
// true

finished by([3..4], 2)
// false
</code></pre>
`},{name:"finished by(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">finished by(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">finished by([1..5], [3..5])
// true

finished by((5..8], [1..5))
// false

finished by([5..10], (1..10))
// false
</code></pre>
`},{name:"includes(range, point)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">includes(range: range, point: Any): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">includes([5..10], 6)
// true

includes([3..4], 5)
// false
</code></pre>
`},{name:"includes(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">includes(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">includes([1..10], [4..6])
// true

includes((5..8], [1..5))
// false

includes([1..10], [1..5))
// true
</code></pre>
`},{name:"during(point, range)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">during(point: Any, range: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">during(5, [1..10])
// true

during(12, [1..10])
// false

during(1, (1..10])
// false
</code></pre>
`},{name:"during(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">during(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">during([4..6], [1..10))
// true

during((1..5], (1..10])
// true
</code></pre>
`},{name:"starts(point, range)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">starts(point: Any, range: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">starts(1, [1..5])
// true

starts(1, (1..8])
// false
</code></pre>
`},{name:"starts(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">starts(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">starts((1..5], [1..5])
// false

starts([1..10], [1..5])
// false

starts((1..5), (1..10))
// true
</code></pre>
`},{name:"started by(range, point)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">started by(range: range, point: Any): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">started by([1..10], 1)
// true

started by((1..10], 1)
// false
</code></pre>
`},{name:"started by(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">started by(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">started by([1..10], [1..5])
// true

started by((1..10], [1..5))
// false

started by([1..10], [1..10))
// true
</code></pre>
`},{name:"coincides(point1, point2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">coincides(point1: Any, point2: Any): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">coincides(5, 5)
// true

coincides(3, 4)
// false
</code></pre>
`},{name:"coincides(range1, range2)",description:`<p><strong>Function signature</strong></p>
<pre><code class="language-feel">coincides(range1: range, range2: range): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">coincides([1..5], [1..5])
// true

coincides((1..5], [1..5))
// false

coincides([1..5], [2..6])
// false
</code></pre>
`},{name:"substring(string, start position)",description:`<p>Returns a substring of the given value starting at <code>start position</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">substring(string: string, start position: number): string
</code></pre>
<p>The <code>start position</code> starts at the index <code>1</code>. The last position is <code>-1</code>.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">substring(&quot;foobar&quot;, 3)
// &quot;obar&quot;
</code></pre>
`},{name:"substring(string, start position, length)",description:`<p>Returns a substring of the given value starting at <code>start position</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">substring(string: string, start position: number, length: number): string
</code></pre>
<p>The <code>start position</code> starts at the index <code>1</code>. The last position is <code>-1</code>.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">substring(&quot;foobar&quot;, 3, 3)
// &quot;oba&quot;
</code></pre>
`},{name:"string length(string)",description:`<p>Returns the number of characters in the given value.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">string length(string: string): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">string length(&quot;foo&quot;)
// 3
</code></pre>
`},{name:"upper case(string)",description:`<p>Returns the given value with all characters are uppercase.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">upper case(string: string): string
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">upper case(&quot;aBc4&quot;)
// &quot;ABC4&quot;
</code></pre>
`},{name:"lower case(string)",description:`<p>Returns the given value with all characters are lowercase.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">lower case(string: string): string
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">lower case(&quot;aBc4&quot;)
// &quot;abc4&quot;
</code></pre>
`},{name:"substring before(string, match)",description:`<p>Returns a substring of the given value that contains all characters before <code>match</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">substring before(string: string, match: string): string
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">substring before(&quot;foobar&quot;, &quot;bar&quot;)
// &quot;foo&quot;
</code></pre>
`},{name:"substring after(string, match)",description:`<p>Returns a substring of the given value that contains all characters after <code>match</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">substring after(string: string, match: string): string
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">substring after(&quot;foobar&quot;, &quot;ob&quot;)
// &quot;ar&quot;
</code></pre>
`},{name:"contains(string, match)",description:`<p>Returns <code>true</code> if the given value contains the substring <code>match</code>. Otherwise, returns <code>false</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">contains(string: string, match: string): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">contains(&quot;foobar&quot;, &quot;of&quot;)
// false
</code></pre>
`},{name:"starts with(string, match)",description:`<p>Returns <code>true</code> if the given value starts with the substring <code>match</code>. Otherwise, returns <code>false</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">starts with(string: string, match: string): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">starts with(&quot;foobar&quot;, &quot;fo&quot;)
// true
</code></pre>
`},{name:"ends with(string, match)",description:`<p>Returns <code>true</code> if the given value ends with the substring <code>match</code>. Otherwise, returns <code>false</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">ends with(string: string, match: string): boolean
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">ends with(&quot;foobar&quot;, &quot;r&quot;)
// true
</code></pre>
`},{name:"matches(input, pattern)",description:`<p>Returns <code>true</code> if the given value matches the <code>pattern</code>. Otherwise, returns <code>false</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">matches(input: string, pattern: string): boolean
</code></pre>
<p>The <code>pattern</code> is a string that contains a regular expression.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">matches(&quot;foobar&quot;, &quot;^fo*bar&quot;)
// true
</code></pre>
`},{name:"matches(input, pattern, flags)",description:`<p>Returns <code>true</code> if the given value matches the <code>pattern</code>. Otherwise, returns <code>false</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">matches(input: string, pattern: string, flags: string): boolean
</code></pre>
<p>The <code>pattern</code> is a string that contains a regular expression.</p>
<p>The <code>flags</code> can contain one or more of the following characters:</p>
<ul>
<li><code>s</code> (dot-all)</li>
<li><code>m</code> (multi-line)</li>
<li><code>i</code> (case insensitive)</li>
<li><code>x</code> (comments)</li>
</ul>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">matches(&quot;FooBar&quot;, &quot;foo&quot;, &quot;i&quot;)
// true
</code></pre>
`},{name:"replace(input, pattern, replacement)",description:`<p>Returns the resulting string after replacing all occurrences of <code>pattern</code> with <code>replacement</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">replace(input: string, pattern: string, replacement: string): string
</code></pre>
<p>The <code>pattern</code> is a string that contains a regular expression.</p>
<p>The <code>replacement</code> can access the match groups by using <code>$</code> and the number of the group, for example,
<code>$1</code> to access the first group.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">replace(&quot;abcd&quot;, &quot;(ab)|(a)&quot;, &quot;[1=$1][2=$2]&quot;)
// &quot;[1=ab][2=]cd&quot;

replace(&quot;0123456789&quot;, &quot;(\\d{3})(\\d{3})(\\d{4})&quot;, &quot;($1) $2-$3&quot;)
// &quot;(012) 345-6789&quot;
</code></pre>
`},{name:"replace(input, pattern, replacement, flags)",description:`<p>Returns the resulting string after replacing all occurrences of <code>pattern</code> with <code>replacement</code>.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">replace(input: string, pattern: string, replacement: string, flags: string): string
</code></pre>
<p>The <code>pattern</code> is a string that contains a regular expression.</p>
<p>The <code>replacement</code> can access the match groups by using <code>$</code> and the number of the group, for example,
<code>$1</code> to access the first group.</p>
<p>The <code>flags</code> can contain one or more of the following characters:</p>
<ul>
<li><code>s</code> (dot-all)</li>
<li><code>m</code> (multi-line)</li>
<li><code>i</code> (case insensitive)</li>
<li><code>x</code> (comments)</li>
</ul>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">replace(&quot;How do you feel?&quot;, &quot;Feel&quot;, &quot;FEEL&quot;, &quot;i&quot;)
// &quot;How do you FEEL?&quot;
</code></pre>
`},{name:"split(string, delimiter)",description:`<p>Splits the given value into a list of substrings, breaking at each occurrence of the <code>delimiter</code> pattern.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">split(string: string, delimiter: string): list&lt;string&gt;
</code></pre>
<p>The <code>delimiter</code> is a string that contains a regular expression.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">split(&quot;John Doe&quot;, &quot;\\s&quot; )
// [&quot;John&quot;, &quot;Doe&quot;]

split(&quot;a;b;c;;&quot;, &quot;;&quot;)
// [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;&quot;, &quot;&quot;]
</code></pre>
`},{name:"extract(string, pattern)",description:`<p><em>Camunda Extension</em></p>
<p>Returns all matches of the pattern in the given string. Returns an empty list if the pattern doesn&#39;t
match.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">extract(string: string, pattern: string): list&lt;string&gt;
</code></pre>
<p>The <code>pattern</code> is a string that contains a regular expression.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">extract(&quot;references are 1234, 1256, 1378&quot;, &quot;12[0-9]*&quot;)
// [&quot;1234&quot;,&quot;1256&quot;]
</code></pre>
`},{name:"now()",description:`<p>Returns the current date and time including the timezone.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">now(): date and time
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">now()
// date and time(&quot;2020-07-31T14:27:30@Europe/Berlin&quot;)
</code></pre>
`},{name:"today()",description:`<p>Returns the current date.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">today(): date
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">today()
// date(&quot;2020-07-31&quot;)
</code></pre>
`},{name:"day of week(date)",description:`<p>Returns the day of the week according to the Gregorian calendar. Note that it always returns the English name of the day.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">day of week(date: date): string
</code></pre>
<pre><code class="language-feel">day of week(date: date and time): string
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">day of week(date(&quot;2019-09-17&quot;))
// &quot;Tuesday&quot;

day of week(date and time(&quot;2019-09-17T12:00:00&quot;))
// &quot;Tuesday&quot;
</code></pre>
`},{name:"day of year(date)",description:`<p>Returns the Gregorian number of the day within the year.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">day of year(date: date): number
</code></pre>
<pre><code class="language-feel">day of year(date: date and time): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">day of year(date(&quot;2019-09-17&quot;))
// 260

day of year(date and time(&quot;2019-09-17T12:00:00&quot;))
// 260
</code></pre>
`},{name:"week of year(date)",description:`<p>Returns the Gregorian number of the week within the year, according to ISO 8601.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">week of year(date: date): number
</code></pre>
<pre><code class="language-feel">week of year(date: date and time): number
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">week of year(date(&quot;2019-09-17&quot;))
// 38

week of year(date and time(&quot;2019-09-17T12:00:00&quot;))
// 38
</code></pre>
`},{name:"month of year(date)",description:`<p>Returns the month of the year according to the Gregorian calendar. Note that it always returns the English name of the month.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">month of year(date: date): string
</code></pre>
<pre><code class="language-feel">month of year(date: date and time): string
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">month of year(date(&quot;2019-09-17&quot;))
// &quot;September&quot;

month of year(date and time(&quot;2019-09-17T12:00:00&quot;))
// &quot;September&quot;
</code></pre>
`},{name:"abs(n)",description:`<p>Returns the absolute value of a given duration.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">abs(n: days and time duration): days and time duration
</code></pre>
<pre><code class="language-feel">abs(n: years and months duration): years and months duration
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">abs(duration(&quot;-PT5H&quot;))
// &quot;duration(&quot;PT5H&quot;)&quot;

abs(duration(&quot;PT5H&quot;))
// &quot;duration(&quot;PT5H&quot;)&quot;

abs(duration(&quot;-P2M&quot;))
// duration(&quot;P2M&quot;)
</code></pre>
`},{name:"last day of month(date)",description:`<p><em>Camunda Extension</em></p>
<p>Takes the month of the given date or date-time value and returns the last day of this month.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">last day of month(date: date): date
</code></pre>
<pre><code class="language-feel">last day of month(date: date and time): date
</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">last day of month(date(&quot;2022-10-01&quot;))
// date(&quot;2022-10-31&quot;))

last day of month(date and time(&quot;2022-10-16T12:00:00&quot;))
// date(&quot;2022-10-31&quot;))
</code></pre>
`},{name:"is empty(list)",description:`<p><em>Camunda Extension</em></p>
<p>Returns true if the given list is empty. Otherwise, returns false.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">is empty(list: list): boolean</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">is empty([])
// true

is empty([1,2,3])
// false
</code></pre>`},{name:"trim(string)",description:`<p><em>Camunda Extension</em></p>
<p>Returns the given string without leading and trailing spaces.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">trim(string: string): string</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">trim("  hello world  ")
// "hello world"

trim("hello   world ")
// "hello   world"
</code></pre>`},{name:"uuid()",description:`<p><em>Camunda Extension</em></p>
<p>Returns a UUID (Universally Unique Identifier) with 36 characters.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">uuid(): string</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">uuid()
// "7793aab1-d761-4d38-916b-b7270e309894"
</code></pre>`},{name:"to base64(string)",description:`<p><em>Camunda Extension</em></p>
<p>Returns the given string encoded in Base64 format.</p>
<p><strong>Function signature</strong></p>
<pre><code class="language-feel">to base64(value: string): string</code></pre>
<p><strong>Examples</strong></p>
<pre><code class="language-feel">to base64("FEEL")
// "RkVFTA=="
</code></pre>`}];function bO(i){return i.map(yO)}function yO(i){const{name:e,description:t}=i,n=e.match(/^([\w\s]+)\((.*)\)$/),s=n[1],r=n[2],o=r?r.split(", ").map(l=>({name:l})):[];return{name:s,type:"function",params:o,info:()=>Eh(`<div class="description">${t}<div>`),boost:0}}const vO=bO(mO),hp=new Fn,up=new Fn;function Hn({extensions:i=[],dialect:e="expression",container:t,contentAttributes:n={},tooltipContainer:s,onChange:r=()=>{},onKeyDown:o=()=>{},onLint:l=()=>{},placeholder:a="",readOnly:c=!1,value:h="",builtins:u=vO,variables:f=[]}){const d=T.updateListener.of(v=>{v.docChanged&&r(v.state.doc.toString())}),p=T.updateListener.of(v=>{const x=v.transactions.flatMap(k=>k.effects).filter(k=>k.is(Fi));if(!x.length)return;const w=x.flatMap(k=>k.value);l(w)}),m=T.domEventHandlers({keydown:o});typeof s=="string"&&(s=document.querySelector(s));const b=s?Pf({tooltipSpace:function(){return s.getBoundingClientRect()}}):[],y=[Ry(),hp.of(cp({dialect:e,builtins:u,variables:f})),Hf(),If(),Gf(),T.contentAttributes.of(n),d,m,Bi.of([...wd]),Jx,p,b,up.of(_f(a)),iO,...i];return c&&y.push(T.editable.of(!1)),this._cmEditor=new T({state:W.create({doc:h,extensions:y}),parent:t}),this}Hn.prototype.setValue=function(i){this._cmEditor.dispatch({changes:{from:0,to:this._cmEditor.state.doc.length,insert:i}})};Hn.prototype.focus=function(i){const e=this._cmEditor;if(e.contentDOM.focus(),e.focus(),typeof i=="number"){const t=e.state.doc.length;e.dispatch({selection:{anchor:i<=t?i:t}})}};Hn.prototype.getSelection=function(){return this._cmEditor.state.selection};Hn.prototype.setVariables=function(i){const{dialect:e,builtins:t}=gO(this._cmEditor.state);this._cmEditor.dispatch({effects:[hp.reconfigure(cp({dialect:e,builtins:t,variables:i}))]})};Hn.prototype.setPlaceholder=function(i){this._cmEditor.dispatch({effects:up.reconfigure(_f(i))})};/*!
* tabbable 6.2.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var fp=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],Ys=fp.join(","),dp=typeof Element>"u",sn=dp?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Us=!dp&&Element.prototype.getRootNode?function(i){var e;return i==null||(e=i.getRootNode)===null||e===void 0?void 0:e.call(i)}:function(i){return i==null?void 0:i.ownerDocument},Gs=function i(e,t){var n;t===void 0&&(t=!0);var s=e==null||(n=e.getAttribute)===null||n===void 0?void 0:n.call(e,"inert"),r=s===""||s==="true",o=r||t&&e&&i(e.parentNode);return o},xO=function(e){var t,n=e==null||(t=e.getAttribute)===null||t===void 0?void 0:t.call(e,"contenteditable");return n===""||n==="true"},pp=function(e,t,n){if(Gs(e))return[];var s=Array.prototype.slice.apply(e.querySelectorAll(Ys));return t&&sn.call(e,Ys)&&s.unshift(e),s=s.filter(n),s},gp=function i(e,t,n){for(var s=[],r=Array.from(e);r.length;){var o=r.shift();if(!Gs(o,!1))if(o.tagName==="SLOT"){var l=o.assignedElements(),a=l.length?l:o.children,c=i(a,!0,n);n.flatten?s.push.apply(s,c):s.push({scopeParent:o,candidates:c})}else{var h=sn.call(o,Ys);h&&n.filter(o)&&(t||!e.includes(o))&&s.push(o);var u=o.shadowRoot||typeof n.getShadowRoot=="function"&&n.getShadowRoot(o),f=!Gs(u,!1)&&(!n.shadowRootFilter||n.shadowRootFilter(o));if(u&&f){var d=i(u===!0?o.children:u.children,!0,n);n.flatten?s.push.apply(s,d):s.push({scopeParent:o,candidates:d})}else r.unshift.apply(r,o.children)}}return s},mp=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},jt=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||xO(e))&&!mp(e)?0:e.tabIndex},OO=function(e,t){var n=jt(e);return n<0&&t&&!mp(e)?0:n},kO=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},bp=function(e){return e.tagName==="INPUT"},wO=function(e){return bp(e)&&e.type==="hidden"},SO=function(e){var t=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(n){return n.tagName==="SUMMARY"});return t},CO=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]},_O=function(e){if(!e.name)return!0;var t=e.form||Us(e),n=function(l){return t.querySelectorAll('input[type="radio"][name="'+l+'"]')},s;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")s=n(window.CSS.escape(e.name));else try{s=n(e.name)}catch(o){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",o.message),!1}var r=CO(s,e.form);return!r||r===e},AO=function(e){return bp(e)&&e.type==="radio"},PO=function(e){return AO(e)&&!_O(e)},EO=function(e){var t,n=e&&Us(e),s=(t=n)===null||t===void 0?void 0:t.host,r=!1;if(n&&n!==e){var o,l,a;for(r=!!((o=s)!==null&&o!==void 0&&(l=o.ownerDocument)!==null&&l!==void 0&&l.contains(s)||e!=null&&(a=e.ownerDocument)!==null&&a!==void 0&&a.contains(e));!r&&s;){var c,h,u;n=Us(s),s=(c=n)===null||c===void 0?void 0:c.host,r=!!((h=s)!==null&&h!==void 0&&(u=h.ownerDocument)!==null&&u!==void 0&&u.contains(s))}}return r},fh=function(e){var t=e.getBoundingClientRect(),n=t.width,s=t.height;return n===0&&s===0},TO=function(e,t){var n=t.displayCheck,s=t.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var r=sn.call(e,"details>summary:first-of-type"),o=r?e.parentElement:e;if(sn.call(o,"details:not([open]) *"))return!0;if(!n||n==="full"||n==="legacy-full"){if(typeof s=="function"){for(var l=e;e;){var a=e.parentElement,c=Us(e);if(a&&!a.shadowRoot&&s(a)===!0)return fh(e);e.assignedSlot?e=e.assignedSlot:!a&&c!==e.ownerDocument?e=c.host:e=a}e=l}if(EO(e))return!e.getClientRects().length;if(n!=="legacy-full")return!0}else if(n==="non-zero-area")return fh(e);return!1},RO=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if(t.tagName==="FIELDSET"&&t.disabled){for(var n=0;n<t.children.length;n++){var s=t.children.item(n);if(s.tagName==="LEGEND")return sn.call(t,"fieldset[disabled] *")?!0:!s.contains(e)}return!0}t=t.parentElement}return!1},Ks=function(e,t){return!(t.disabled||Gs(t)||wO(t)||TO(t,e)||SO(t)||RO(t))},Xo=function(e,t){return!(PO(t)||jt(t)<0||!Ks(e,t))},MO=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(t)||t>=0)},$O=function i(e){var t=[],n=[];return e.forEach(function(s,r){var o=!!s.scopeParent,l=o?s.scopeParent:s,a=OO(l,o),c=o?i(s.candidates):l;a===0?o?t.push.apply(t,c):t.push(l):n.push({documentOrder:r,tabIndex:a,item:s,isScope:o,content:c})}),n.sort(kO).reduce(function(s,r){return r.isScope?s.push.apply(s,r.content):s.push(r.content),s},[]).concat(t)},DO=function(e,t){t=t||{};var n;return t.getShadowRoot?n=gp([e],t.includeContainer,{filter:Xo.bind(null,t),flatten:!1,getShadowRoot:t.getShadowRoot,shadowRootFilter:MO}):n=pp(e,t.includeContainer,Xo.bind(null,t)),$O(n)},BO=function(e,t){t=t||{};var n;return t.getShadowRoot?n=gp([e],t.includeContainer,{filter:Ks.bind(null,t),flatten:!0,getShadowRoot:t.getShadowRoot}):n=pp(e,t.includeContainer,Ks.bind(null,t)),n},hn=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return sn.call(e,Ys)===!1?!1:Xo(t,e)},LO=fp.concat("iframe").join(","),zr=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return sn.call(e,LO)===!1?!1:Ks(t,e)};/*!
* focus-trap 7.6.2
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function Wo(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function IO(i){if(Array.isArray(i))return Wo(i)}function FO(i,e,t){return(e=VO(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function NO(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function qO(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dh(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,n)}return t}function ph(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?dh(Object(t),!0).forEach(function(n){FO(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):dh(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function QO(i){return IO(i)||NO(i)||zO(i)||qO()}function HO(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function VO(i){var e=HO(i,"string");return typeof e=="symbol"?e:e+""}function zO(i,e){if(i){if(typeof i=="string")return Wo(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Wo(i,e):void 0}}var gh={activateTrap:function(e,t){if(e.length>0){var n=e[e.length-1];n!==t&&n.pause()}var s=e.indexOf(t);s===-1||e.splice(s,1),e.push(t)},deactivateTrap:function(e,t){var n=e.indexOf(t);n!==-1&&e.splice(n,1),e.length>0&&e[e.length-1].unpause()}},XO=function(e){return e.tagName&&e.tagName.toLowerCase()==="input"&&typeof e.select=="function"},WO=function(e){return(e==null?void 0:e.key)==="Escape"||(e==null?void 0:e.key)==="Esc"||(e==null?void 0:e.keyCode)===27},ui=function(e){return(e==null?void 0:e.key)==="Tab"||(e==null?void 0:e.keyCode)===9},jO=function(e){return ui(e)&&!e.shiftKey},YO=function(e){return ui(e)&&e.shiftKey},mh=function(e){return setTimeout(e,0)},Kn=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return typeof e=="function"?e.apply(void 0,n):e},hs=function(e){return e.target.shadowRoot&&typeof e.composedPath=="function"?e.composedPath()[0]:e.target},UO=[],GO=function(e,t){var n=(t==null?void 0:t.document)||document,s=(t==null?void 0:t.trapStack)||UO,r=ph({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:jO,isKeyBackward:YO},t),o={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},l,a=function(O,S,R){return O&&O[S]!==void 0?O[S]:r[R||S]},c=function(O,S){var R=typeof(S==null?void 0:S.composedPath)=="function"?S.composedPath():void 0;return o.containerGroups.findIndex(function(z){var G=z.container,ne=z.tabbableNodes;return G.contains(O)||(R==null?void 0:R.includes(G))||ne.find(function(H){return H===O})})},h=function(O){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=S.hasFallback,z=R===void 0?!1:R,G=S.params,ne=G===void 0?[]:G,H=r[O];if(typeof H=="function"&&(H=H.apply(void 0,QO(ne))),H===!0&&(H=void 0),!H){if(H===void 0||H===!1)return H;throw new Error("`".concat(O,"` was specified but was not a node, or did not return a node"))}var oe=H;if(typeof H=="string"){try{oe=n.querySelector(H)}catch(J){throw new Error("`".concat(O,'` appears to be an invalid selector; error="').concat(J.message,'"'))}if(!oe&&!z)throw new Error("`".concat(O,"` as selector refers to no known node"))}return oe},u=function(){var O=h("initialFocus",{hasFallback:!0});if(O===!1)return!1;if(O===void 0||O&&!zr(O,r.tabbableOptions))if(c(n.activeElement)>=0)O=n.activeElement;else{var S=o.tabbableGroups[0],R=S&&S.firstTabbableNode;O=R||h("fallbackFocus")}else O===null&&(O=h("fallbackFocus"));if(!O)throw new Error("Your focus-trap needs to have at least one focusable element");return O},f=function(){if(o.containerGroups=o.containers.map(function(O){var S=DO(O,r.tabbableOptions),R=BO(O,r.tabbableOptions),z=S.length>0?S[0]:void 0,G=S.length>0?S[S.length-1]:void 0,ne=R.find(function(J){return hn(J)}),H=R.slice().reverse().find(function(J){return hn(J)}),oe=!!S.find(function(J){return jt(J)>0});return{container:O,tabbableNodes:S,focusableNodes:R,posTabIndexesFound:oe,firstTabbableNode:z,lastTabbableNode:G,firstDomTabbableNode:ne,lastDomTabbableNode:H,nextTabbableNode:function(ce){var xe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,Oe=S.indexOf(ce);return Oe<0?xe?R.slice(R.indexOf(ce)+1).find(function(Ne){return hn(Ne)}):R.slice(0,R.indexOf(ce)).reverse().find(function(Ne){return hn(Ne)}):S[Oe+(xe?1:-1)]}}}),o.tabbableGroups=o.containerGroups.filter(function(O){return O.tabbableNodes.length>0}),o.tabbableGroups.length<=0&&!h("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(o.containerGroups.find(function(O){return O.posTabIndexesFound})&&o.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},d=function(O){var S=O.activeElement;if(S)return S.shadowRoot&&S.shadowRoot.activeElement!==null?d(S.shadowRoot):S},p=function(O){if(O!==!1&&O!==d(document)){if(!O||!O.focus){p(u());return}O.focus({preventScroll:!!r.preventScroll}),o.mostRecentlyFocusedNode=O,XO(O)&&O.select()}},m=function(O){var S=h("setReturnFocus",{params:[O]});return S||(S===!1?!1:O)},b=function(O){var S=O.target,R=O.event,z=O.isBackward,G=z===void 0?!1:z;S=S||hs(R),f();var ne=null;if(o.tabbableGroups.length>0){var H=c(S,R),oe=H>=0?o.containerGroups[H]:void 0;if(H<0)G?ne=o.tabbableGroups[o.tabbableGroups.length-1].lastTabbableNode:ne=o.tabbableGroups[0].firstTabbableNode;else if(G){var J=o.tabbableGroups.findIndex(function(ln){var pr=ln.firstTabbableNode;return S===pr});if(J<0&&(oe.container===S||zr(S,r.tabbableOptions)&&!hn(S,r.tabbableOptions)&&!oe.nextTabbableNode(S,!1))&&(J=H),J>=0){var ce=J===0?o.tabbableGroups.length-1:J-1,xe=o.tabbableGroups[ce];ne=jt(S)>=0?xe.lastTabbableNode:xe.lastDomTabbableNode}else ui(R)||(ne=oe.nextTabbableNode(S,!1))}else{var Oe=o.tabbableGroups.findIndex(function(ln){var pr=ln.lastTabbableNode;return S===pr});if(Oe<0&&(oe.container===S||zr(S,r.tabbableOptions)&&!hn(S,r.tabbableOptions)&&!oe.nextTabbableNode(S))&&(Oe=H),Oe>=0){var Ne=Oe===o.tabbableGroups.length-1?0:Oe+1,qt=o.tabbableGroups[Ne];ne=jt(S)>=0?qt.firstTabbableNode:qt.firstDomTabbableNode}else ui(R)||(ne=oe.nextTabbableNode(S))}}else ne=h("fallbackFocus");return ne},y=function(O){var S=hs(O);if(!(c(S,O)>=0)){if(Kn(r.clickOutsideDeactivates,O)){l.deactivate({returnFocus:r.returnFocusOnDeactivate});return}Kn(r.allowOutsideClick,O)||O.preventDefault()}},v=function(O){var S=hs(O),R=c(S,O)>=0;if(R||S instanceof Document)R&&(o.mostRecentlyFocusedNode=S);else{O.stopImmediatePropagation();var z,G=!0;if(o.mostRecentlyFocusedNode)if(jt(o.mostRecentlyFocusedNode)>0){var ne=c(o.mostRecentlyFocusedNode),H=o.containerGroups[ne].tabbableNodes;if(H.length>0){var oe=H.findIndex(function(J){return J===o.mostRecentlyFocusedNode});oe>=0&&(r.isKeyForward(o.recentNavEvent)?oe+1<H.length&&(z=H[oe+1],G=!1):oe-1>=0&&(z=H[oe-1],G=!1))}}else o.containerGroups.some(function(J){return J.tabbableNodes.some(function(ce){return jt(ce)>0})})||(G=!1);else G=!1;G&&(z=b({target:o.mostRecentlyFocusedNode,isBackward:r.isKeyBackward(o.recentNavEvent)})),p(z||o.mostRecentlyFocusedNode||u())}o.recentNavEvent=void 0},x=function(O){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;o.recentNavEvent=O;var R=b({event:O,isBackward:S});R&&(ui(O)&&O.preventDefault(),p(R))},w=function(O){(r.isKeyForward(O)||r.isKeyBackward(O))&&x(O,r.isKeyBackward(O))},k=function(O){WO(O)&&Kn(r.escapeDeactivates,O)!==!1&&(O.preventDefault(),l.deactivate())},_=function(O){var S=hs(O);c(S,O)>=0||Kn(r.clickOutsideDeactivates,O)||Kn(r.allowOutsideClick,O)||(O.preventDefault(),O.stopImmediatePropagation())},E=function(){if(o.active)return gh.activateTrap(s,l),o.delayInitialFocusTimer=r.delayInitialFocus?mh(function(){p(u())}):p(u()),n.addEventListener("focusin",v,!0),n.addEventListener("mousedown",y,{capture:!0,passive:!1}),n.addEventListener("touchstart",y,{capture:!0,passive:!1}),n.addEventListener("click",_,{capture:!0,passive:!1}),n.addEventListener("keydown",w,{capture:!0,passive:!1}),n.addEventListener("keydown",k),l},F=function(){if(o.active)return n.removeEventListener("focusin",v,!0),n.removeEventListener("mousedown",y,!0),n.removeEventListener("touchstart",y,!0),n.removeEventListener("click",_,!0),n.removeEventListener("keydown",w,!0),n.removeEventListener("keydown",k),l},I=function(O){var S=O.some(function(R){var z=Array.from(R.removedNodes);return z.some(function(G){return G===o.mostRecentlyFocusedNode})});S&&p(u())},U=typeof window<"u"&&"MutationObserver"in window?new MutationObserver(I):void 0,Q=function(){U&&(U.disconnect(),o.active&&!o.paused&&o.containers.map(function(O){U.observe(O,{subtree:!0,childList:!0})}))};return l={get active(){return o.active},get paused(){return o.paused},activate:function(O){if(o.active)return this;var S=a(O,"onActivate"),R=a(O,"onPostActivate"),z=a(O,"checkCanFocusTrap");z||f(),o.active=!0,o.paused=!1,o.nodeFocusedBeforeActivation=n.activeElement,S==null||S();var G=function(){z&&f(),E(),Q(),R==null||R()};return z?(z(o.containers.concat()).then(G,G),this):(G(),this)},deactivate:function(O){if(!o.active)return this;var S=ph({onDeactivate:r.onDeactivate,onPostDeactivate:r.onPostDeactivate,checkCanReturnFocus:r.checkCanReturnFocus},O);clearTimeout(o.delayInitialFocusTimer),o.delayInitialFocusTimer=void 0,F(),o.active=!1,o.paused=!1,Q(),gh.deactivateTrap(s,l);var R=a(S,"onDeactivate"),z=a(S,"onPostDeactivate"),G=a(S,"checkCanReturnFocus"),ne=a(S,"returnFocus","returnFocusOnDeactivate");R==null||R();var H=function(){mh(function(){ne&&p(m(o.nodeFocusedBeforeActivation)),z==null||z()})};return ne&&G?(G(m(o.nodeFocusedBeforeActivation)).then(H,H),this):(H(),this)},pause:function(O){if(o.paused||!o.active)return this;var S=a(O,"onPause"),R=a(O,"onPostPause");return o.paused=!0,S==null||S(),F(),Q(),R==null||R(),this},unpause:function(O){if(!o.paused||!o.active)return this;var S=a(O,"onUnpause"),R=a(O,"onPostUnpause");return o.paused=!1,S==null||S(),f(),E(),Q(),R==null||R(),this},updateContainerElements:function(O){var S=[].concat(O).filter(Boolean);return o.containers=S.map(function(R){return typeof R=="string"?n.querySelector(R):R}),o.active&&f(),Q(),this}},l.updateContainerElements(e),l},yp=function(e){return L("svg",{...e,children:L("path",{fillRule:"evenodd",d:"m12 4.7-.7-.7L8 7.3 4.7 4l-.7.7L7.3 8 4 11.3l.7.7L8 8.7l3.3 3.3.7-.7L8.7 8 12 4.7Z",fill:"currentColor"})})};yp.defaultProps={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"};var vp=function(e){return L("svg",{...e,children:[L("path",{fill:"#fff",style:{mixBlendMode:"multiply"},d:"M0 0h16v16H0z"}),L("path",{fill:"#fff",style:{mixBlendMode:"multiply"},d:"M0 0h16v16H0z"}),L("path",{d:"M7 3H5v2h2V3zm4 0H9v2h2V3zM7 7H5v2h2V7zm4 0H9v2h2V7zm-4 4H5v2h2v-2zm4 0H9v2h2v-2z",fill:"#161616"})]})};vp.defaultProps={width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};var Il=function(e){return L("svg",{...e,children:[L("path",{fill:"currentColor",d:"M28 4H10a2.006 2.006 0 0 0-2 2v14a2.006 2.006 0 0 0 2 2h18a2.006 2.006 0 0 0 2-2V6a2.006 2.006 0 0 0-2-2Zm0 16H10V6h18Z"}),L("path",{fill:"currentColor",d:"M18 26H4V16h2v-2H4a2.006 2.006 0 0 0-2 2v10a2.006 2.006 0 0 0 2 2h14a2.006 2.006 0 0 0 2-2v-2h-2Z"})]})};Il.defaultProps={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 32 32"};rn({description:{},getDescriptionForId:()=>{}});rn({errors:{}});const KO=rn({eventBus:null});rn({layout:{},setLayout:()=>{},getLayoutForKey:()=>{},setLayoutForKey:()=>{}});const ZO=rn({tooltip:{},getTooltipForId:()=>{}});function JO(i,e){const{getTooltipForId:t}=qh(ZO);return t(i,e)}function ek(i){const{forId:e,element:t}=i,n=JO(e,t),s=i.value||n;return s?L(tk,{...i,value:s,forId:sk(e)}):i.children}function tk(i){const{forId:e,value:t,parent:n,direction:s="right",position:r}=i,[o,l]=ut(!1),[a,c]=ut(!1);let h=null;const u=Se(null),f=Se(null),d=async v=>{const x=()=>l(!0);!o&&!h&&(v instanceof MouseEvent?h=setTimeout(x,200):(x(),c(!0)))},p=()=>{l(!1),c(!1)},m=v=>{v.code==="Escape"&&p()},b=({x:v,y:x})=>{const w=f.current,k=u.current;return w&&(bh(v,x,k.getBoundingClientRect())||bh(v,x,w.getBoundingClientRect()))};Re(()=>{const{current:v}=u;if(!v)return;const x=k=>{const _=document.activeElement===u.current||document.activeElement.closest(".bio-properties-panel-tooltip");o&&!b({x:k.x,y:k.y})&&!(_&&a)&&p()},w=k=>{const{relatedTarget:_}=k,E=F=>!!F.closest(".bio-properties-panel-tooltip");o&&!ik(u.current)&&_&&!E(_)&&p()};return document.addEventListener("wheel",x),document.addEventListener("focusout",w),document.addEventListener("mousemove",x),()=>{document.removeEventListener("wheel",x),document.removeEventListener("mousemove",x),document.removeEventListener("focusout",w)}},[u.current,o,a]);const y=()=>L("div",{class:`bio-properties-panel-tooltip ${s}`,role:"tooltip",id:"bio-properties-panel-tooltip","aria-labelledby":e,style:r||nk(u.current),ref:f,onClick:v=>v.stopPropagation(),children:[L("div",{class:"bio-properties-panel-tooltip-content",children:t}),L("div",{class:"bio-properties-panel-tooltip-arrow"})]});return L("div",{class:"bio-properties-panel-tooltip-wrapper",tabIndex:"0",ref:u,onMouseEnter:d,onMouseLeave:()=>{clearTimeout(h),h=null},onFocus:d,onKeyDown:m,children:[i.children,o?n?jh(y(),n.current):y():null]})}function bh(i,e,t){const{top:n,right:s,bottom:r,left:o}=t;return i>=o&&i<=s&&e>=n&&e<=r}function nk(i){const e=i.getBoundingClientRect(),t=`calc(100% - ${e.x}px)`,n=`${e.top-10}px`;return`right: ${t}; top: ${n};`}function ik(i){return i.matches(":hover")}function sk(i){return`bio-properties-panel-${i}`}function rk(i,e,t){const n=qh(KO);t||({eventBus:t}=n);const s=Se(!1);t&&!s.current&&t.on(i,e),Re(()=>(t&&s.current&&t.on(i,e),s.current=!0,()=>{t&&t.off(i,e)}),[e,i,t])}function xp(i){const e=Se(i);return e.current=i,Wp((...t)=>e.current(...t),[])}const yh=()=>{},ok=function(i,e){const[t,n]=ut(void 0);e.current=Bn(()=>({focus:s=>{i?i.focus(s):(typeof s>"u"&&(s=1/0),n(s))}}),[i]),Re(()=>{typeof t<"u"&&i&&(i.focus(t),n(!1))},[i,t])};It((i,e)=>{const{onInput:t,disabled:n,tooltipContainer:s,enableGutters:r,value:o,onLint:l=yh,onPopupOpen:a=yh,popupOpen:c,contentAttributes:h={},hostLanguage:u=null,singleLine:f=!1}=i,d=Se(),[p,m]=ut(),[b,y]=ut(o||"");ok(p,e);const v=xp(w=>{t(w),y(w)});Re(()=>{let w;return w=new dr({container:d.current,onChange:v,value:b,onLint:l,contentAttributes:h,tooltipContainer:s,enableGutters:r,hostLanguage:u,singleLine:f,lineWrap:!0}),m(w),()=>{l([]),d.current.innerHTML="",m(null)}},[]),Re(()=>{p&&o!==b&&(p.setValue(o),y(o))},[o]);const x=()=>{e.current.focus()};return L("div",{class:Ot("bio-properties-panel-feelers-editor-container",c?"popupOpen":null),children:[L("div",{class:"bio-properties-panel-feelers-editor__open-popup-placeholder",children:"Opened in editor"}),L("div",{name:i.name,class:Ot("bio-properties-panel-feelers-editor bio-properties-panel-input",b?"edited":null,n?"disabled":null),ref:d,onClick:x}),L("button",{type:"button",title:"Open pop-up editor",class:"bio-properties-panel-open-feel-popup",onClick:()=>a("feelers"),children:L(Il,{})})]})});const Xr=()=>{},lk=function(i,e){const[t,n]=ut(void 0);e.current=Bn(()=>({focus:s=>{i?i.focus(s):(typeof s>"u"&&(s=1/0),n(s))}}),[i]),Re(()=>{typeof t<"u"&&i&&(i.focus(t),n(!1))},[i,t])};It((i,e)=>{const{contentAttributes:t,enableGutters:n,value:s,onInput:r,onFeelToggle:o=Xr,onLint:l=Xr,onPopupOpen:a=Xr,placeholder:c,popupOpen:h,disabled:u,tooltipContainer:f,variables:d}=i,p=Se(),[m,b]=ut(),[y,v]=ut(s||"");lk(m,e);const x=xp(k=>{r(k),v(k)});Re(()=>{let k;const _=E=>{if(E.key!=="Backspace"||!k)return;const F=k.getSelection(),I=F.ranges[F.mainIndex];I.from===0&&I.to===0&&o()};return k=new Hn({container:p.current,onChange:x,onKeyDown:_,onLint:l,placeholder:c,tooltipContainer:f,value:y,variables:d,extensions:[...n?[Rf()]:[],T.lineWrapping],contentAttributes:t}),b(k),()=>{l([]),p.current.innerHTML="",b(null)}},[]),Re(()=>{m&&s!==y&&(m.setValue(s),v(s))},[s]),Re(()=>{m&&m.setVariables(d)},[d]),Re(()=>{m&&m.setPlaceholder(c)},[c]);const w=()=>{e.current.focus()};return L("div",{class:Ot("bio-properties-panel-feel-editor-container",u?"disabled":null,h?"popupOpen":null),children:[L("div",{class:"bio-properties-panel-feel-editor__open-popup-placeholder",children:"Opened in editor"}),L("div",{name:i.name,class:Ot("bio-properties-panel-input",y?"edited":null),ref:p,onClick:w}),L("button",{type:"button",title:"Open pop-up editor",class:"bio-properties-panel-open-feel-popup",onClick:()=>a(),children:L(Il,{})})]})});rn({open:()=>{},close:()=>{},source:null});function ak(i,e){let t,n,s;function r(a){t=this,n=a.clientX,s=a.clientY,a.dataTransfer&&a.dataTransfer.setDragImage(e||ck(),0,0),document.addEventListener("dragover",o,!0),document.addEventListener("dragenter",us,!0),document.addEventListener("dragend",l),document.addEventListener("drop",us)}function o(a){const c={x:a.clientX-n,y:a.clientY-s};return i.call(t,a,c)}function l(){document.removeEventListener("dragover",o,!0),document.removeEventListener("dragenter",us,!0),document.removeEventListener("dragend",l),document.removeEventListener("drop",us)}return r}function us(i){i.preventDefault(),i.stopPropagation()}function ck(){return Eh('<canvas width="0" height="0" />')}const vh=()=>{};function hk(i,e){const{container:t,className:n,delayInitialFocus:s,position:r,width:o,height:l,onClose:a,onPostActivate:c=vh,onPostDeactivate:h=vh,returnFocus:u=!0,closeOnEscape:f=!0,title:d}=i,p=Se(null),m=Se(null),b=e||m,y=Bn(()=>gk(t),[t]),v=k=>{k.stopPropagation(),f&&k.key==="Escape"&&a()},x=()=>{p.current&&p.current.activate()};let w={};return r&&(w={...w,top:r.top+"px",left:r.left+"px"}),o&&(w.width=o+"px"),l&&(w.height=l+"px"),Re(()=>(b.current&&b.current.addEventListener("focusin",x),()=>{b.current.removeEventListener("focusin",x)}),[b]),Re(()=>(b.current&&(p.current=GO(b.current,{clickOutsideDeactivates:!0,delayInitialFocus:s,fallbackFocus:b.current,onPostActivate:c,onPostDeactivate:h,returnFocusOnDeactivate:u}),p.current.activate()),()=>p.current&&p.current.deactivate()),[b]),rk("propertiesPanel.detach",a),jh(L("div",{"aria-label":d,tabIndex:-1,ref:b,onKeyDown:v,role:"dialog",class:Ot("bio-properties-panel-popup",n),style:w,children:i.children}),y||document.body)}const Fl=It(hk);Fl.Title=uk;Fl.Body=fk;Fl.Footer=dk;function uk(i){const{children:e,className:t,draggable:n,emit:s=()=>{},title:r,showCloseButton:o=!1,closeButtonTooltip:l="Close popup",onClose:a,...c}=i,h=Se({startPosition:null,newPosition:null}),u=Se(),f=Se(),d=(b,y)=>{pk(b);const{x:v,y:x}=y,w={x:h.current.startPosition.x+v,y:h.current.startPosition.y+x},k=xh(f.current);k.style.top=w.y+"px",k.style.left=w.x+"px",s("dragover",{newPosition:w,delta:y})},p=b=>{ak(d,u.current)(b),b.stopPropagation();const x=xh(f.current).getBoundingClientRect();h.current.startPosition={x:x.left,y:x.top},s("dragstart")},m=()=>{h.current.newPosition=null,s("dragend")};return L("div",{class:Ot("bio-properties-panel-popup__header",n&&"draggable",t),ref:f,draggable:n,onDragStart:p,onDragEnd:m,...c,children:[n&&L(Kt,{children:[L("div",{ref:u,class:"bio-properties-panel-popup__drag-preview"}),L("div",{class:"bio-properties-panel-popup__drag-handle",children:L(vp,{})})]}),L("div",{class:"bio-properties-panel-popup__title",children:r}),e,o&&L("button",{title:l,class:"bio-properties-panel-popup__close",onClick:a,children:L(yp,{})})]})}function fk(i){const{children:e,className:t,...n}=i;return L("div",{class:Ot("bio-properties-panel-popup__body",t),...n,children:e})}function dk(i){const{children:e,className:t,...n}=i;return L("div",{class:Ot("bio-properties-panel-popup__footer",t),...n,children:i.children})}function xh(i){return i.closest(".bio-properties-panel-popup")}function pk(i){i.preventDefault(),i.stopPropagation()}function gk(i){return typeof i=="string"?$p(i):i}function mk(i){const{id:e,label:t,onInput:n,value:s,switcherLabel:r,inline:o,onFocus:l,onBlur:a,inputRef:c,tooltip:h}=i,[u,f]=ut(s),d=async()=>{n(!s)},p=m=>{d(),f(m.target.value)};return Re(()=>{s!==u&&f(s)},[s]),L("div",{class:Ot("bio-properties-panel-toggle-switch",{inline:o}),children:[L("label",{class:"bio-properties-panel-label",for:Oh(e),children:L(ek,{value:h,forId:e,element:i.element,children:t})}),L("div",{class:"bio-properties-panel-field-wrapper",children:[L("label",{class:"bio-properties-panel-toggle-switch__switcher",children:[L("input",{ref:c,id:Oh(e),class:"bio-properties-panel-input",type:"checkbox",onFocus:l,onBlur:a,name:e,onInput:p,checked:!!u}),L("span",{class:"bio-properties-panel-toggle-switch__slider"})]}),r&&L("p",{class:"bio-properties-panel-toggle-switch__label",children:r})]})]})}function Oh(i){return`bio-properties-panel-${i}`}function bk(i){const{debounce:e,disabled:t,displayLabel:n=!0,id:s,inputRef:r,label:o,max:l,min:a,onInput:c,step:h,value:u="",onFocus:f,onBlur:d}=i,[p,m]=ut(u),b=Bn(()=>e(v=>{v.validity.valid&&c(v.value?parseFloat(v.value):void 0)}),[c,e]),y=v=>{b(v.target),m(v.target.value)};return Re(()=>{u!==p&&m(u)},[u]),L("div",{class:"bio-properties-panel-numberfield",children:[n&&L("label",{for:kh(s),class:"bio-properties-panel-label",children:o}),L("input",{id:kh(s),ref:r,type:"number",name:s,spellCheck:"false",autoComplete:"off",disabled:t,class:"bio-properties-panel-input",max:l,min:a,onInput:y,onFocus:f,onBlur:d,step:h,value:p})]})}function kh(i){return`bio-properties-panel-${i}`}It((i,e)=>{const{id:t,disabled:n,onInput:s,value:r,onFocus:o,onBlur:l,placeholder:a}=i,c=Se();return e.current={focus:h=>{const u=c.current;u&&(u.focus(),typeof h=="number"&&(h>r.length&&(h=r.length),u.setSelectionRange(h,h)))}},L("input",{id:Nl(t),type:"text",ref:c,name:t,spellCheck:"false",autoComplete:"off",disabled:n,class:"bio-properties-panel-input",onInput:h=>s(h.target.value),onFocus:o,onBlur:l,placeholder:a,value:r||""})});It((i,e)=>{const{id:t,debounce:n,disabled:s,onInput:r,value:o,min:l,max:a,step:c,onFocus:h,onBlur:u}=i,f=Se();return e.current={focus:d=>{const p=f.current;p&&(p.focus(),typeof d=="number"&&d!==1/0&&(d>o.length&&(d=o.length),p.setSelectionRange(d,d)))}},L(bk,{id:t,debounce:n,disabled:s,displayLabel:!1,inputRef:f,max:a,min:l,onInput:r,step:c,value:o,onFocus:h,onBlur:u})});It((i,e)=>{const{id:t,disabled:n,onInput:s,value:r,onFocus:o,onBlur:l,placeholder:a}=i,c=Se();return e.current={focus:()=>{const h=c.current;h&&(h.focus(),h.setSelectionRange(0,0))}},L("textarea",{id:Nl(t),type:"text",ref:c,name:t,spellCheck:"false",autoComplete:"off",disabled:n,class:"bio-properties-panel-input",onInput:h=>s(h.target.value),onFocus:o,onBlur:l,placeholder:a,value:r||"","data-gramm":"false"})});It((i,e)=>{const{id:t,onInput:n,value:s,onFocus:r,onBlur:o,switcherLabel:l}=i,a=Se();return e.current={focus:()=>{const c=a.current;c&&c.focus()}},L(mk,{id:t,value:s,inputRef:a,onInput:n,onFocus:r,onBlur:o,switcherLabel:l})});It((i,e)=>{const{id:t,disabled:n,onInput:s,value:r,onFocus:o,onBlur:l}=i,a=Se(),c=({target:h})=>{s(h.checked)};return e.current={focus:()=>{const h=a.current;h&&h.focus()}},L("input",{ref:a,id:Nl(t),name:t,onFocus:o,onBlur:l,type:"checkbox",class:"bio-properties-panel-input",onChange:c,checked:r,disabled:n})});function Nl(i){return`bio-properties-panel-${i}`}rn({selectedElement:null,injector:null,getService(){return null}});const yk={class:"card-header"},vk={__name:"MyPanel",props:{name:String,direction:{type:String,default:""},modeler:Object,key:String},setup(i){const e=ni(!1),t=ni([]),n=Op(()=>t.value[0]),s=kp({name:"",description:""});wh(()=>{r()});const r=()=>{i.modeler.on("selection.changed",c=>{t.value=c.newSelection,o()}),i.modeler.on("element.changed",c=>{const{element:h}=c;n&&h.id===n.id&&(n.value=h)}),e.value=!0},o=()=>{if(!n.value){console.log(i.modeler);return}const{businessObject:c}=n.value;console.log(c),s.key=c.id||"",s.name=c.name||"",s.description=c.documentation||""},l=c=>{i.modeler.get("modeling").updateProperties(n.value,c)},a=(c,h)=>{if(!n.value)return;let u={};u[h]=c,n.value[h]=c,l(u)};return(c,h)=>{const u=Np,f=Ip,d=Ph,p=Fp,m=Dp;return qe(e)?(Wr(),Sh(m,{key:0,class:"panelCard"},{header:wt(()=>[ii("div",yk,[ii("span",null,wp(i.name),1)])]),default:wt(()=>[gt(p,{model:qe(s),"label-width":"auto"},{default:wt(()=>[gt(f,{label:""},{default:wt(()=>[gt(u,{modelValue:qe(s).key,"onUpdate:modelValue":h[0]||(h[0]=b=>qe(s).key=b),placeholder:"",onChange:h[1]||(h[1]=b=>a(b,"id"))},null,8,["modelValue"])]),_:1}),gt(f,{label:""},{default:wt(()=>[gt(u,{modelValue:qe(s).name,"onUpdate:modelValue":h[2]||(h[2]=b=>qe(s).name=b),placeholder:"",onChange:h[3]||(h[3]=b=>a(b,"name"))},null,8,["modelValue"])]),_:1}),gt(f,{label:""},{default:wt(()=>[gt(u,{modelValue:qe(s).description,"onUpdate:modelValue":h[4]||(h[4]=b=>qe(s).description=b),placeholder:""},null,8,["modelValue"])]),_:1}),gt(d,{type:"primary",onClick:c.saveXml},{default:wt(()=>h[5]||(h[5]=[Ch("")])),_:1},8,["onClick"])]),_:1},8,["model"])]),_:1})):_h("",!0)}}},xk=Ah(vk,[["__scopeId","data-v-3890b4fd"]]),Ok={class:"btn"},kk={__name:"flow",setup(i){const t=Sp().query.id;wh(()=>{r()});const n=ni(null);let s=ni(null);const r=async()=>{s.value=new Bp({container:n.value}),l()},o=ni(""),l=async()=>{let h;if(!t)h=`<?xml version="1.0" encoding="UTF-8"?>
                <definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:flowable="http://flowable.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.flowable.org/processdef" exporter="Flowable Open Source Modeler" exporterVersion="6.7.2">
                <process id="a1" name="1" isExecutable="true">
                    <documentation>1</documentation>
                    <startEvent id="startEvent1" flowable:formFieldValidation="true"></startEvent>
                </process>
                <bpmndi:BPMNDiagram id="BPMNDiagram_a1">
                    <bpmndi:BPMNPlane bpmnElement="a1" id="BPMNPlane_a1">
                    <bpmndi:BPMNShape bpmnElement="startEvent1" id="BPMNShape_startEvent1">
                        <omgdc:Bounds height="30.0" width="30.0" x="100.0" y="163.0"></omgdc:Bounds>
                    </bpmndi:BPMNShape>
                    </bpmndi:BPMNPlane>
                </bpmndi:BPMNDiagram>
                </definitions>`;else{const{data:u}=await Pp({processDefinitionKey:t});h=u.xml,o.value=u.name}await s.value.importXML(h)},a=Cp(),c=async()=>{const{xml:h}=await s.value.saveXML({format:!0}),u={key:t,xml:window.btoa(unescape(encodeURIComponent(h)))};t?await Ep(u):await Tp(u),a.back()};return(h,u)=>{const f=Ph;return Wr(),_p(Ap,null,[ii("div",{class:"container",ref_key:"canvasRef",ref:n},null,512),u[2]||(u[2]=ii("div",{id:"js-properties-panel"},null,-1)),qe(s)?(Wr(),Sh(xk,{name:qe(o),modeler:qe(s),onUpdate:u[0]||(u[0]=()=>{}),key:qe(t)},null,8,["name","modeler"])):_h("",!0),ii("div",Ok,[gt(f,{type:"primary",onClick:c},{default:wt(()=>u[1]||(u[1]=[Ch("")])),_:1})])],64)}}},Lk=Ah(kk,[["__scopeId","data-v-d394c8cb"]]);export{Lk as default};
