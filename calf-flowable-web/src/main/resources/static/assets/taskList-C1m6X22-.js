import{r as d,o as z,u as M,a as A,b as r,c,d as S,e as a,w as o,f as i,g as s,h as G,F as v,i as b,j as _,k as I,l as L,t as H}from"./index-B-OkF-Vi.js";import{E as K}from"./el-dialog-CIdYYP2D.js";import{E as Q,a as W}from"./el-table-column-BMB4Txwf.js";import{E as X,a as Y}from"./el-form-item-DkIAkhZe.js";import{E as Z,a as ee}from"./el-select-BMIGA4sq.js";import{E as te}from"./el-input-kTMZ2gCf.js";import{E as le}from"./el-text-Zmud3bxF.js";import{_ as oe,g as ae,E as se,a as re,m as ne,s as de}from"./_plugin-vue_export-helper--f4TL7q-.js";const ue={class:"mb-4 btn"},ie={class:"dialog-footer"},me={class:"stepItem"},pe={__name:"taskList",setup(fe){const k=d([]),m=d("0"),N=d({}),g=async()=>{k.value=[];const{data:f}=await ae({orderType:m.value}),e={1:"待审批",2:"待处理",3:"已归档",4:"待修改",5:"已作废",6:"已撤单"};f.forEach(l=>{k.value.push({...JSON.parse(l.orderSummary),id:l.id,orderId:l.orderId,updateTime:l.updateTime,statusName:e[l.orderStatus],orderStatus:l.orderStatus,...JSON.parse(l.formData)})}),N.value=f[0].fieldInfo},F=M();z(()=>{m.value=F.query.type,g()});const p=d(!1),w=d({}),u=A({}),E=d(""),T=async(f={})=>{const{data:e}=await re({orderType:m.value});e.forEach(l=>{u[l.fieldName]=f[l.fieldName]??"",l.otherInfo&&(l.otherInfo=JSON.parse(l.otherInfo))}),E.value=f.orderId??"",w.value=e,p.value=!0},U=async()=>{E.value?await ne({formJson:u,orderId:E.value,userId:"0",orderType:m.value}):await de({formJson:u,orderType:m.value,userId:"0"}),p.value=!1,g()},V=d(!1),B=d([]),J=d(""),C=G(),O=()=>{C.push({path:"/applyList",query:{type:m.value}})};return(f,e)=>{const l=se,h=le,y=Q,D=W,R=te,$=ee,q=Z,P=Y,j=X,x=K;return r(),c(v,null,[S("div",ue,[a(l,{onClick:e[0]||(e[0]=t=>s(C).back())},{default:o(()=>e[4]||(e[4]=[i("返回")])),_:1}),a(h,{style:{"margin-right":"30px"}},{default:o(()=>e[5]||(e[5]=[i("任务列表")])),_:1}),a(l,{type:"primary",onClick:T},{default:o(()=>e[6]||(e[6]=[i("新增任务")])),_:1}),a(l,{type:"primary",onClick:O},{default:o(()=>e[7]||(e[7]=[i("查看审批")])),_:1})]),a(D,{data:s(k),style:{width:"100%"},border:"",class:"table"},{default:o(()=>[a(y,{prop:"title",label:"流程名称",width:"200"}),a(y,{prop:"updateTime",label:"提交时间",width:"200"}),(r(!0),c(v,null,b(s(N),(t,n)=>(r(),_(y,{prop:n,label:t,width:"200"},null,8,["prop","label"]))),256)),a(y,{prop:"statusName",label:"状态",width:"200"}),a(y,{fixed:"right",label:"操作","min-width":"120"},{default:o(({row:t})=>[t.orderStatus==="4"?(r(),_(l,{key:0,link:"",type:"primary",size:"small",onClick:n=>T(t)},{default:o(()=>e[8]||(e[8]=[i("修改")])),_:2},1032,["onClick"])):I("",!0)]),_:1})]),_:1},8,["data"]),a(x,{modelValue:s(p),"onUpdate:modelValue":e[2]||(e[2]=t=>L(p)?p.value=t:null),title:"请假单",width:"500"},{footer:o(()=>[S("div",ie,[a(l,{onClick:e[1]||(e[1]=t=>p.value=!1)},{default:o(()=>e[9]||(e[9]=[i("取消")])),_:1}),a(l,{type:"primary",onClick:U},{default:o(()=>e[10]||(e[10]=[i(" 确定 ")])),_:1})])]),default:o(()=>[a(j,{model:s(u)},{default:o(()=>[(r(!0),c(v,null,b(s(w),t=>(r(),_(P,{key:t.id,label:t.fieldCname},{default:o(()=>[t.fieldType==="text"?(r(),_(R,{key:0,modelValue:s(u)[t.fieldName],"onUpdate:modelValue":n=>s(u)[t.fieldName]=n,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue"])):I("",!0),t.fieldType==="select"?(r(),_(q,{key:1,modelValue:s(u)[t.fieldName],"onUpdate:modelValue":n=>s(u)[t.fieldName]=n},{default:o(()=>[(r(!0),c(v,null,b(t.otherInfo,n=>(r(),_($,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):I("",!0)]),_:2},1032,["label"]))),128))]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(x,{modelValue:s(V),"onUpdate:modelValue":e[3]||(e[3]=t=>L(V)?V.value=t:null),title:s(J),width:"500"},{default:o(()=>[(r(!0),c(v,null,b(s(B),t=>(r(),c("div",me,H(t.remark),1))),256))]),_:1},8,["modelValue","title"])],64)}}},Ie=oe(pe,[["__scopeId","data-v-0eedf701"]]);export{Ie as default};
